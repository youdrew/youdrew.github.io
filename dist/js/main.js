class y{constructor(){this.header=document.querySelector("header"),this.menuIcon=document.getElementById("menu_icon"),this.navTriggerZone=50,this.showNavTimeout=null,this.init()}init(){this.header&&(this.handleResize(),window.addEventListener("resize",()=>{this.handleResize()}))}handleResize(){window.matchMedia("(min-width: 1099px)").matches?this.initDesktopBehavior():this.initMobileBehavior()}initDesktopBehavior(){this.menuIcon&&(this.menuIcon.replaceWith(this.menuIcon.cloneNode(!0)),this.menuIcon=document.getElementById("menu_icon")),document.addEventListener("mousemove",e=>{e.pageX<=this.navTriggerZone?(clearTimeout(this.showNavTimeout),this.header.classList.add("show_menu")):this.showNavTimeout=setTimeout(()=>{const s=this.header.getBoundingClientRect(),t=e.clientX,o=e.clientY;t>=s.left&&t<=s.right&&o>=s.top&&o<=s.bottom||this.header.classList.remove("show_menu")},300)}),this.header.addEventListener("mouseenter",()=>{clearTimeout(this.showNavTimeout)}),this.header.addEventListener("mouseleave",()=>{this.showNavTimeout=setTimeout(()=>{this.header.classList.remove("show_menu")},300)})}initMobileBehavior(){this.menuIcon&&this.menuIcon.addEventListener("click",e=>{e.preventDefault();const s=this.header.querySelector("nav ul");return s&&s.classList.toggle("show_menu"),this.menuIcon.classList.toggle("close_menu"),!1})}}class f{constructor(){this.init()}init(){document.addEventListener("mouseover",e=>{e.target.tagName==="A"&&this.showTooltip(e.target)}),document.addEventListener("mouseout",e=>{e.target.tagName==="A"&&this.hideTooltip()})}showTooltip(e){const s=e.getAttribute("data-title");if(!s||s==="")return;const t=document.createElement("span");t.className="tooltip",t.textContent=s,e.parentNode.insertBefore(t,e.nextSibling);const o=t.offsetWidth,i=e.offsetWidth,r=e.offsetHeight+3+4;let l=o;o<i&&(l=i,t.style.width=l+"px");const n=-(l-i)/2;t.style.left=n+"px",t.style.bottom=r+"px",setTimeout(()=>{t.style.opacity="1"},10)}hideTooltip(){document.querySelectorAll(".tooltip").forEach(s=>{s.remove()})}}class g{constructor(){this.mapElement=document.getElementById("map"),this.init()}init(){this.mapElement&&(this.adjustMapLayout(),window.addEventListener("resize",()=>{this.adjustMapLayout()}))}adjustMapLayout(){const e=document.querySelector("header"),s=window.innerHeight,t=window.innerWidth;if(!e)return;const o=e.offsetWidth+50,i=this.mapElement.offsetWidth;this.mapElement.style.maxWidth=i+"px",this.mapElement.style.height=s+"px",t>1100?this.mapElement.style.marginLeft=o+"px":this.mapElement.style.marginLeft="0"}}class x{init(){console.log("TOC module loaded (using legacy toc-collapse.js)")}}class v{constructor(){this.overlay=null,this.zoomImg=null,this.hint=null,this.scale=1,this.minScale=.2,this.maxScale=6,this.lastPos={x:0,y:0},this.origin={x:0,y:0},this.dragging=!1,this.wheelTimeout=null,this.init()}init(){this.bindImages(),new MutationObserver(s=>{for(let t=0;t<s.length;t++)if(s[t].addedNodes.length){this.bindImages();break}}).observe(document.documentElement||document.body,{childList:!0,subtree:!0})}buildOverlay(){this.overlay=document.createElement("div"),this.overlay.id="image-zoom-overlay",this.overlay.className="fade-in",this.overlay.innerHTML=`
      <div class="image-zoom-content">
        <img class="image-zoom-img" alt="Zoomed Image" draggable="false" />
        <div class="image-zoom-hint">ÊªöËΩÆÁº©ÊîæÔºåÊãñÂä®Êü•ÁúãÔºåÂèåÂáªÂÖ≥Èó≠</div>
      </div>
    `,document.body.appendChild(this.overlay),this.zoomImg=this.overlay.querySelector(".image-zoom-img"),this.hint=this.overlay.querySelector(".image-zoom-hint"),this.bindOverlayEvents()}openOverlay(e){this.overlay||this.buildOverlay(),this.overlay.style.display="flex",this.zoomImg.src=e,this.scale=1,this.lastPos.x=0,this.lastPos.y=0,this.applyTransform(),this.hint&&(this.hint.style.opacity="1",this.hint.style.transition="opacity .5s",clearTimeout(this.hint._hideTimer),this.hint._hideTimer=setTimeout(()=>{this.hint.style.opacity="0"},3e3))}closeOverlay(){this.overlay&&(this.overlay.style.display="none",this.zoomImg.src="")}applyTransform(){this.zoomImg.style.transform=`translate(${this.lastPos.x}px, ${this.lastPos.y}px) scale(${this.scale})`}onWheel(e){e.preventDefault();const s=this.zoomImg.getBoundingClientRect(),t=e.clientX-s.left-s.width/2,o=e.clientY-s.top-s.height/2,i=e.deltaY>0?-.12:.12,r=Math.max(this.minScale,Math.min(this.maxScale,this.scale+i)),l=r/this.scale;this.lastPos.x=(this.lastPos.x+t)*l-t,this.lastPos.y=(this.lastPos.y+o)*l-o,this.scale=r,this.applyTransform(),this.hint&&(this.hint.style.opacity="0.3",clearTimeout(this.wheelTimeout),this.wheelTimeout=setTimeout(()=>{this.hint.style.opacity="1"},400))}onMouseDown(e){e.button===0&&(this.dragging=!0,this.origin.x=e.clientX,this.origin.y=e.clientY,this.overlay.style.cursor="grabbing")}onMouseMove(e){if(!this.dragging)return;const s=e.clientX-this.origin.x,t=e.clientY-this.origin.y;this.origin.x=e.clientX,this.origin.y=e.clientY,this.lastPos.x+=s,this.lastPos.y+=t,this.applyTransform()}onMouseUp(){this.dragging=!1,this.overlay&&(this.overlay.style.cursor="default")}onDblClick(){this.closeOverlay()}onKey(e){e.key==="Escape"&&this.overlay&&this.overlay.style.display==="flex"&&this.closeOverlay()}bindOverlayEvents(){this.zoomImg.addEventListener("wheel",e=>this.onWheel(e),{passive:!1}),this.zoomImg.addEventListener("mousedown",e=>this.onMouseDown(e)),this.zoomImg.addEventListener("dblclick",()=>this.onDblClick()),window.addEventListener("mousemove",e=>this.onMouseMove(e)),window.addEventListener("mouseup",()=>this.onMouseUp()),window.addEventListener("keydown",e=>this.onKey(e)),this.overlay.addEventListener("click",e=>{e.target===this.overlay&&this.closeOverlay()})}bindImages(){const e="article img, .markdown-body img, .post img, .entry-content img, .content img, .main-content img, .page img";document.querySelectorAll(e).forEach(t=>{t.classList.contains("image-zoomable")||(t.classList.add("image-zoomable"),t.style.cursor="zoom-in",t.addEventListener("click",()=>{this.openOverlay(t.getAttribute("data-origin")||t.src)}))})}}class b{constructor(){this.initializeEmbeds()}initializeEmbeds(){this.processTextNodes(document.body),this.processCodeBlocks(),this.processMarkdownSyntax()}processTextNodes(e){["SCRIPT","STYLE","NOSCRIPT","IFRAME","CANVAS"].includes(e.tagName)||(e.nodeType===Node.TEXT_NODE?this.processTextNode(e):Array.from(e.childNodes).forEach(s=>{this.processTextNodes(s)}))}processTextNode(e){const s=e.textContent,t=/https?:\/\/(?:www\.)?shadertoy\.com\/view\/(\w+)(?:\?[^\s]*)?/g;let o;const i=[];for(;(o=t.exec(s))!==null;)i.push({fullMatch:o[0],shaderID:o[1],index:o.index});i.length>0&&this.replaceWithIframes(e,i)}processCodeBlocks(){document.querySelectorAll("code, pre").forEach(s=>{const t=s.textContent,o=/https?:\/\/(?:www\.)?shadertoy\.com\/view\/(\w+)(?:\?[^\s]*)?/g;let i;for(;(i=o.exec(t))!==null;){const r=t.trim();if(r===i[0]||r===i[0].replace(/\?.*$/,"")){this.replaceElementWithIframe(s,i[1]);break}}})}replaceWithIframes(e,s){const t=e.parentNode;if(!t)return;let o=e.textContent;const i=[];let r=0;s.sort((n,a)=>a.index-n.index),s.reverse().forEach(n=>{n.index>r&&i.unshift({type:"text",content:o.substring(r,n.index)}),i.unshift({type:"iframe",shaderID:n.shaderID,originalURL:n.fullMatch}),r=n.index+n.fullMatch.length}),r<o.length&&i.unshift({type:"text",content:o.substring(r)});const l=[];i.forEach(n=>{if(n.type==="text"&&n.content.trim())l.push(document.createTextNode(n.content));else if(n.type==="iframe"){const a=this.createShaderToyEmbed(n.shaderID,n.originalURL);l.push(a)}}),l.forEach(n=>{t.insertBefore(n,e)}),t.removeChild(e)}replaceElementWithIframe(e,s){const t=this.createShaderToyEmbed(s);e.parentNode.replaceChild(t,e)}createShaderToyEmbed(e,s=null){const t=document.createElement("div");t.className="shadertoy-embed-container",t.style.cssText=`
            margin: 25px auto;
            max-width: 800px;
            padding: 15px;
            border: 2px solid #444;
            border-radius: 12px;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        `,t.addEventListener("mouseenter",()=>{t.style.transform="translateY(-3px)",t.style.boxShadow="0 12px 35px rgba(0,0,0,0.4)"}),t.addEventListener("mouseleave",()=>{t.style.transform="translateY(0)",t.style.boxShadow="0 8px 25px rgba(0,0,0,0.3)"});const o=document.createElement("div");o.className="shadertoy-embed-header",o.style.cssText=`
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #555;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        `;const i=document.createElement("div");i.style.cssText=`
            display: flex;
            align-items: center;
            gap: 10px;
        `;const r=document.createElement("span");r.innerHTML="üé®",r.style.cssText=`
            font-size: 20px;
            filter: drop-shadow(0 0 5px rgba(255,215,0,0.5));
        `;const l=document.createElement("span");l.textContent=`ShaderToy: ${e}`,l.style.cssText=`
            color: #ffd700;
            font-weight: bold;
            font-size: 16px;
            text-shadow: 0 0 10px rgba(255,215,0,0.3);
        `,i.appendChild(r),i.appendChild(l);const n=document.createElement("div");n.style.cssText=`
            display: flex;
            gap: 8px;
        `;const a=document.createElement("a");a.href=s||`https://www.shadertoy.com/view/${e}`,a.target="_blank",a.innerHTML="üîó Open in ShaderToy",a.style.cssText=`
            color: #66b3ff;
            text-decoration: none;
            font-size: 13px;
            padding: 6px 12px;
            border: 1px solid #66b3ff;
            border-radius: 6px;
            background: rgba(102,179,255,0.1);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 4px;
        `,a.addEventListener("mouseenter",()=>{a.style.background="#66b3ff",a.style.color="#000",a.style.transform="translateY(-1px)"}),a.addEventListener("mouseleave",()=>{a.style.background="rgba(102,179,255,0.1)",a.style.color="#66b3ff",a.style.transform="translateY(0)"}),n.appendChild(a),o.appendChild(i),o.appendChild(n);const c=document.createElement("div");c.style.cssText=`
            position: relative;
            width: 100%;
            height: 0;
            padding-bottom: 50%; /* 2:1 aspect ratio */
            border-radius: 8px;
            overflow: hidden;
            background: #000;
        `;const h=document.createElement("iframe");h.src=`https://www.shadertoy.com/embed/${e}?gui=true&t=10&paused=false&muted=false`,h.style.cssText=`
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        `,h.allowFullscreen=!0,h.loading="lazy";const d=document.createElement("div");d.innerHTML=`
            <div style="text-align: center;">
                <div style="display: inline-block; width: 40px; height: 40px; border: 3px solid #333; border-top: 3px solid #ffd700; border-radius: 50%; animation: spin 1s linear infinite; margin-bottom: 10px;"></div>
                <div style="color: #999; font-size: 14px;">Loading ShaderToy...</div>
            </div>
        `,d.style.cssText=`
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1;
        `;const p=document.createElement("style");return p.textContent=`
            @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }
        `,document.head.appendChild(p),h.addEventListener("load",()=>{d.style.display="none"}),c.appendChild(h),c.appendChild(d),t.appendChild(o),t.appendChild(c),t}processMarkdownSyntax(){const e=document.createTreeWalker(document.body,NodeFilter.SHOW_TEXT,{acceptNode:function(o){var r;const i=(r=o.parentElement)==null?void 0:r.tagName;return["SCRIPT","STYLE","NOSCRIPT","IFRAME","CANVAS"].includes(i)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}}),s=[];let t;for(;t=e.nextNode();)s.push(t);s.forEach(o=>{const i=o.textContent,r=/\[(shader|shadertoy):(\w+)\]/g;let l;const n=[];for(;(l=r.exec(i))!==null;)n.push({fullMatch:l[0],shaderID:l[2],index:l.index});n.length>0&&this.replaceMarkdownSyntax(o,n)})}replaceMarkdownSyntax(e,s){const t=e.parentNode;if(!t)return;let o=e.textContent;const i=[];let r=0;s.sort((n,a)=>a.index-n.index),s.reverse().forEach(n=>{n.index>r&&i.unshift({type:"text",content:o.substring(r,n.index)}),i.unshift({type:"iframe",shaderID:n.shaderID,originalURL:null}),r=n.index+n.fullMatch.length}),r<o.length&&i.unshift({type:"text",content:o.substring(r)});const l=[];i.forEach(n=>{if(n.type==="text"&&n.content.trim())l.push(document.createTextNode(n.content));else if(n.type==="iframe"){const a=this.createShaderToyEmbed(n.shaderID,n.originalURL);l.push(a)}}),l.forEach(n=>{t.insertBefore(n,e)}),t.removeChild(e)}}class w{constructor(){this.init()}init(){const e=document.querySelector(".content");if(!e)return;e.querySelectorAll("h1, h2, h3, h4, h5, h6").forEach(t=>{const o=document.createElement("span");o.className="collapse-button",t.insertBefore(o,t.firstChild),o.addEventListener("click",i=>{i.stopPropagation(),this.toggleCollapse(t)})})}toggleCollapse(e){const s=parseInt(e.tagName[1]);let t=e.nextElementSibling;e.classList.toggle("collapsed");const o=e.classList.contains("collapsed");for(;t&&!(t.tagName&&t.tagName.match(/^H[1-6]$/)&&parseInt(t.tagName[1])<=s);)t.style.display=o?"none":"",t=t.nextElementSibling}}class E{constructor(){this.init()}init(){this.initCodeBlockExpansion(),new MutationObserver(s=>{let t=!1;s.forEach(o=>{o.addedNodes.length>0&&o.addedNodes.forEach(i=>{i.nodeType===1&&(i.matches("figure.highlight")||i.querySelector("figure.highlight"))&&(t=!0)})}),t&&setTimeout(()=>this.initCodeBlockExpansion(),100)}).observe(document.body,{childList:!0,subtree:!0})}initCodeBlockExpansion(){document.querySelectorAll("figure.highlight").forEach(s=>{if(s.closest(".code-block-container"))return;const t=s.querySelector("table");if(t){const a=t.querySelector("td.code");if(a){const c=document.createElement("pre");c.className="code",c.innerHTML=a.innerHTML,s.innerHTML="",s.appendChild(c)}}const o=s.querySelector("pre.code");if(!o)return;const i=o.scrollHeight,r=400,l=document.createElement("div");l.className="code-buttons";const n=document.createElement("button");if(n.className="copy-code-button",n.textContent="Â§çÂà∂‰ª£Á†Å",n.addEventListener("click",a=>{a.preventDefault(),a.stopPropagation(),this.copyCodeToClipboard(o,n)}),l.appendChild(n),i>r){const a=document.createElement("div");a.className="code-block-container collapsed",s.parentNode.insertBefore(a,s),a.appendChild(s);const c=document.createElement("button");c.className="expand-button",c.textContent="Â±ïÂºÄ‰ª£Á†Å",l.appendChild(c),a.appendChild(l),c.addEventListener("click",()=>{a.classList.contains("collapsed")&&this.showFullscreenCode(s)})}else{const a=document.createElement("div");a.className="code-block-container",s.parentNode.insertBefore(a,s),a.appendChild(s),a.appendChild(l)}})}showFullscreenCode(e){const s=document.createElement("div");s.className="code-fullscreen-modal active";const t=document.createElement("div");t.className="code-fullscreen-content";const i=(e.closest(".code-block-container")||e).cloneNode(!0);i.querySelectorAll(".code-buttons, .copy-code-button, .expand-button").forEach(d=>{d.parentNode&&d.parentNode.removeChild(d)});const l=i.classList.contains("code-block-container")?i:i.querySelector(".code-block-container");l&&(l.classList.remove("collapsed"),l.style.margin="0");const n=(l||i).querySelector("pre.code");n&&(n.scrollTop=0),t.appendChild(i);const a=document.createElement("button");a.className="close-fullscreen",a.textContent="ÂÖ≥Èó≠",t.appendChild(a),s.appendChild(t),document.body.appendChild(s),document.body.style.overflow="hidden";const c=()=>{document.body.removeChild(s),document.body.style.overflow=""};a.addEventListener("click",c),s.addEventListener("click",d=>{d.target===s&&c()});const h=d=>{d.key==="Escape"&&(c(),document.removeEventListener("keydown",h))};document.addEventListener("keydown",h)}copyCodeToClipboard(e,s){const t=e.textContent||e.innerText;navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(t).then(()=>{this.showCopySuccess(s)}).catch(o=>{console.error("Â§çÂà∂Â§±Ë¥•:",o),this.fallbackCopy(t,s)}):this.fallbackCopy(t,s)}fallbackCopy(e,s){const t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="2em",t.style.height="2em",t.style.padding="0",t.style.border="none",t.style.outline="none",t.style.boxShadow="none",t.style.background="transparent",document.body.appendChild(t),t.focus(),t.select();try{document.execCommand("copy")&&this.showCopySuccess(s)}catch(o){console.error("Â§çÂà∂Â§±Ë¥•:",o)}document.body.removeChild(t)}showCopySuccess(e){const s=e.textContent;e.classList.add("copied"),e.textContent="Â∑≤Â§çÂà∂ ‚úì",setTimeout(()=>{e.classList.remove("copied"),e.textContent=s},2e3)}}function u(){new y,new f,document.getElementById("map")&&new g,new x().init(),new v,setTimeout(()=>{new b},500),new w,new E}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",u):u();
