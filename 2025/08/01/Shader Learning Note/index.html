<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0" />

    <!--Description-->
    
        <meta name="description" content="This is a space where I can share my thoughts and works with freely.">
    

    <!--Author-->
    
        <meta name="author" content="Eugene Hsuan">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="Shader Learning Notes"/>
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="Eugene&#39;s Page"/>

    <!--Page Cover-->
    
        <meta property="og:image" content=""/>
    

    <!-- Title -->
    
    <title>Shader Learning Notes - Eugene&#39;s Page</title>

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/reset.css">

    
<link rel="stylesheet" href="/css/main.css">

    
<link rel="stylesheet" href="/css/table.css">

    
<link rel="stylesheet" href="/css/image-zoom.css">


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdn.rawgit.com/noelboss/featherlight/1.3.5/release/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Mermaid Support -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@9.4.3/dist/mermaid.min.js"></script>

    <!-- Google Analytics -->
    


    <!--Favicon-->
    
        <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/img/favicon.ico" type="image/x-icon">
    

<meta name="generator" content="Hexo 7.3.0"></head>

<body>

<!-- Menu -->
<!-- Navigation -->
<header>
    <div class="logo">
        <a href="/">Eugene's Page</a>
        <div class="subtitle">Filmmaker / Developer</div>
        <div class="description">This is a space where I can share my thoughts and works with freely.</div>
    </div><!-- end logo -->

    <div id="menu_icon"></div>
    <nav>
        <ul>
            
            <li>
                <a href="/">Home</a>
            </li>
            
            <li>
                <a href="/archives">Archives</a>
            </li>
            
        </ul>
    </nav><!-- end navigation menu -->

    <div class="footer clearfix">
        <ul class="social clearfix">
            
                <li><a href="https://space.bilibili.com/29291963" class="behance" target="_blank" data-title="Bilibili"></a></li>
            
            
                <li><a href="https://www.instagram.com/yu_chinghsuan?igsh=Mm54ajloc3c1NW5m&utm_source=qr" class="instagram" target="_blank" data-title="Instagram"></a></li>
            
            
                <li><a href="https://www.douban.com/people/Youdrew_Xuan/" class="dribble" target="_blank" data-title="Douban"></a></li>
            
            
                <li><a href="mailto:youdrewxuan@icloud.com" class="google" target="_blank" data-title="Email"></a></li>
            
            
                <li><a href="/atom.xml" class="rss" target="_blank" data-title="RSS"></a></li>
            
        </ul><!-- end social -->

        <div class="rights">
            <p>Copyright Â© 2025 Eugene Hsuan</p>
            <p>Powered by <a href="https://hexo.io/" target="_blank">Hexo</a></p>
            <p>Modified based on <a href="https://github.com/klugjo/hexo-theme-magnetic" target="_blank">Magnetic</a> theme</p>
        </div><!-- end rights -->
    </div ><!-- end footer -->
</header><!-- end header -->


<!-- Main Content -->
<section class="main clearfix">

    <section class="top" style="background: url('https://s2.loli.net/2025/09/13/vlTKo196wnDypC2.png');">
        <div class="wrapper content_header clearfix">
            

<div class="work_nav">

    <ul class="btn clearfix">
        
        <li><a href="/2025/09/13/Aximmetry/" class="previous" data-title="Aximmetry Learning Notes"></a></li>
        
        <li><a href="/" class="grid" data-title="Portfolio"></a></li>
        
        <li><a class="next disabled"></a></li>
        
    </ul>

</div><!-- end work_nav -->
            <h1 class="title">Shader Learning Notes</h1>
        </div>
    </section><!-- end top -->

    <section class="wrapper">
        <div class="content">

            <!-- Gallery -->
            

            <!-- Content -->
            <h1 id="Unreal-Shaderå­¦ä¹ "><a href="#Unreal-Shaderå­¦ä¹ " class="headerlink" title="Unreal Shaderå­¦ä¹ "></a>Unreal Shaderå­¦ä¹ </h1><h2 id="å®‰è£…åŠåŸºç¡€æ¦‚å¿µ"><a href="#å®‰è£…åŠåŸºç¡€æ¦‚å¿µ" class="headerlink" title="å®‰è£…åŠåŸºç¡€æ¦‚å¿µ"></a>å®‰è£…åŠåŸºç¡€æ¦‚å¿µ</h2><p><a target="_blank" rel="noopener" href="https://juejin.cn/post/7164635658084941837">çŸ¥ä¹ ã€ŠShaderä»å…¥é—¨åˆ°æ”¾å¼ƒã€‹ åœ¨VSä¸­å¯ä»¥å®‰è£…ShaderToyæ¥è§‚æµ‹GLSL</a><br>ğŸ‘†è¿™ä¸ªæ–‡å­—æ•™ç¨‹ä¹Ÿæ˜¯å¾ˆä¸é”™çš„</p>
<p><a target="_blank" rel="noopener" href="https://juejin.cn/post/7089771936271564807">Unreal 5.0 æè´¨ä¸­æ·»åŠ è‡ªå®šä¹‰ Shader ä»£ç </a>  åœ¨UEä¸­éœ€è¦è®¾ç½®Shderæ–‡ä»¶çš„ä½ç½®</p>
<p>&lt;img src&#x3D;â€<a target="_blank" rel="noopener" href="https://s2.loli.net/2025/09/13/CxzRNf1Witu69IU.png">https://s2.loli.net/2025/09/13/CxzRNf1Witu69IU.png</a>â€œ alt&#x3D;â€Unreal ShaåŸæœ¬çš„3Dæµç¨‹åº”è¯¥æ˜¯ï¼šâ€åŸç”»å¸ˆç»˜åˆ¶åœºæ™¯å›¾ï¼ˆå°†3Dåœºæ™¯ç”»ä¸‹æ¥ï¼‰ -&gt; å»ºæ¨¡å¸ˆæ ¹æ®åŸç”»æ„å»ºåœºæ™¯æ¨¡å‹ï¼ˆäº§å‡º3Dæ¨¡å‹ï¼‰-&gt; ç¨‹åºæ¸²æŸ“ï¼ˆå°†3Dæ¨¡å‹å¯¼å…¥åˆ°å¼•æ“ä¸­ï¼Œæˆ–è€…å…¶ä»–3Dæ¸²æŸ“åº“ï¼‰ï¼Œç„¶åæ¸²æŸ“æˆç”»é¢â€ã€‚</p>
<p><img src="https://s2.loli.net/2025/09/13/bGh2JSUj4oK1WVI.png" alt="img" style="width: 30%;">å­¦ä¹ â€ style&#x3D;â€width: 30%;â€&gt;</p>
<p>ä¸»è¦æ˜¯ä¸¤ç§ç€è‰²å™¨ï¼š</p>
<ol>
<li><p><strong>Fragment Shader</strong>ï¼ˆç‰‡å…ƒshaderï¼‰ï¼šè¾“å…¥æ’å€¼åçš„é¡¶ç‚¹æ•°æ®ï¼Œè¾“å‡ºæœ€ç»ˆåƒç´ é¢œè‰²ï¼ˆ<code>fragColor</code>ï¼‰ã€‚</p>
</li>
<li><p><strong>Vertex Shader</strong>ï¼ˆé¡¶ç‚¹Shaderï¼‰ï¼šè¾“å…¥å•ä¸ªé¡¶ç‚¹æ•°æ®ï¼ˆä½ç½®&#x2F;æ³•çº¿ç­‰ï¼‰ï¼Œè¾“å‡ºå¤„ç†åçš„é¡¶ç‚¹ä½ç½®ï¼ˆ<code>gl_Position</code>ï¼‰å’Œå…¶ä»–æ’å€¼æ•°æ®ã€‚</p>
</li>
<li><p>compute shader è®¡ç®—ç€è‰²å™¨</p>
</li>
<li><p>geometry shader å‡ ä½•ç€è‰²å™¨</p>
</li>
<li><p>â€¦.</p>
</li>
</ol>
<h1 id="HLSL"><a href="#HLSL" class="headerlink" title="HLSL"></a>HLSL</h1><h2 id="åŸºç¡€çš„è¯­æ³•"><a href="#åŸºç¡€çš„è¯­æ³•" class="headerlink" title="åŸºç¡€çš„è¯­æ³•"></a>åŸºç¡€çš„è¯­æ³•</h2><table>
<thead>
<tr>
<th>min max<br/></th>
<th>æœ€å¤§æœ€å°<br/></th>
</tr>
</thead>
<tbody><tr>
<td>abs<br/></td>
<td>ç»å¯¹å€¼<br/></td>
</tr>
<tr>
<td>fmod<br/></td>
<td>å–ä½™æ“ä½œ<br/></td>
</tr>
<tr>
<td>round<br/></td>
<td>å››èˆäº”å…¥<br/></td>
</tr>
<tr>
<td>pow<br/></td>
<td>æŒ‡æ•°<br/></td>
</tr>
<tr>
<td>sqrt rsqrt<br/></td>
<td>å¹³æ–¹æ ¹ å’Œ å€’æ•°å¹³æ–¹æ ¹<br/></td>
</tr>
<tr>
<td>degreesï¼ˆxï¼‰ redians<br/></td>
<td>å¼§åº¦è½¬è§’åº¦ è§’åº¦è½¬å¼§åº¦<br/></td>
</tr>
<tr>
<td>length<br/></td>
<td>å‘é‡åˆ°åŸç‚¹çš„è·ç¦»<br/></td>
</tr>
<tr>
<td>frac(sin(dot(uv, float2(12.9898, 78.233))) * 43758.5453);<br/></td>
<td>å™ªå£°ç®—æ³•<br/></td>
</tr>
<tr>
<td>sin cos tan<br/></td>
<td>ä¸‰è§’å‡½æ•°<br/></td>
</tr>
<tr>
<td>asin acos atan<br/></td>
<td>ä»–ä»¬çš„åå‡½æ•°<br/></td>
</tr>
<tr>
<td>sinh cosh tanh<br/></td>
<td>åŒæ›²çº¿å‡½æ•°<br/></td>
</tr>
<tr>
<td>ceil<br/></td>
<td>æ•°å€¼èŒƒå›´å‡½æ•°<br/></td>
</tr>
</tbody></table>
<img src="https://s2.loli.net/2025/09/13/Db5ArJdyQv7E9YG.png" alt="Unreal Shaderå­¦ä¹ -1" style="width: 30%;">

<h2 id="UVåæ ‡ç³»è¯´æ˜"><a href="#UVåæ ‡ç³»è¯´æ˜" class="headerlink" title="UVåæ ‡ç³»è¯´æ˜:"></a><strong>UVåæ ‡ç³»è¯´æ˜:</strong></h2><ul>
<li>åŸç‚¹ <strong>(0,0)</strong> ä½äºå·¦ä¸‹è§’</li>
<li>(0,1) å·¦ä¸Šè§’ï¼Œ(1,1) å³ä¸Šè§’ï¼Œ(1,0) å³ä¸‹è§’</li>
</ul>
<h1 id="GLSL"><a href="#GLSL" class="headerlink" title="GLSL"></a>GLSL</h1><h2 id="åŸºç¡€è¯­æ³•"><a href="#åŸºç¡€è¯­æ³•" class="headerlink" title="åŸºç¡€è¯­æ³•"></a>åŸºç¡€è¯­æ³•</h2><h3 id="step"><a href="#step" class="headerlink" title="step"></a>step</h3><blockquote>
<p>å¦‚æœx å°äºæŸä¸ªå€¼ï¼Œåˆ™è¿”å› 0ï¼Œå¦‚æœå¤§äºç­‰äºè¿™ä¸ªå€¼ï¼Œåˆ™è¿”å›1ã€‚</p>
</blockquote>
<p>æ‰€ä»¥ä¸Šé¢çš„ä»£ç å¯ä»¥ç®€åŒ–æˆï¼š</p>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// if(abs(uv.x) &lt;= 2. * fwidth(uv.x)) &#123;</span></span><br><span class="line"><span class="comment">//     color = vec3(0.0, 1.0, 0.0);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// ===&gt;</span></span><br><span class="line"></span><br><span class="line">color = <span class="built_in">step</span>(<span class="built_in">abs</span>(uv.x), <span class="number">2.0</span> * <span class="built_in">fwidth</span>(uv.x)) * <span class="type">vec3</span>(<span class="number">0.0</span>, <span class="number">1.0</span>, <span class="number">0.0</span>);</span><br></pre></td></tr></table></figure>

<h3 id="mix"><a href="#mix" class="headerlink" title="mix"></a>mix</h3><blockquote>
<p>è¯¥å‡½æ•°çš„å®é™…ä¸Šæ‰§è¡Œçš„å°±æ˜¯ä¸€ä¸ªç®€å•çš„ <em><strong>çº¿æ€§å·®å€¼</strong></em>ã€‚ ç®€å•çš„è¯´å°±æ˜¯ï¼šå½“a &#x3D; 1æ—¶ï¼Œè¿”å›çš„å€¼ä¸ºy, ä½†a &#x3D; 0æ—¶ï¼Œè¿”å›xçš„å€¼ï¼Œå¦‚æœè¿”å›çš„å€¼ä¸º0.5ï¼Œåˆ™è¿”å› <code>0.5x + 0.5y</code>çš„å€¼ï¼ŒåŒç†ï¼Œå¦‚æœa &#x3D; 0.2, è¿”å› <code>0.8 * a + 0.2 * y</code>ã€‚</p>
</blockquote>
<p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªå‡½æ•°æ¥åšé¢œè‰²å åŠ ï¼Œé¢œè‰²å åŠ çš„å…¬å¼å¯ä»¥å†™ä¸ºï¼š<br>$$<br>Color&#x3D;Src.colorâˆ—(1âˆ’Dst.a)+Dst.colorâˆ—Dst.a<br>$$</p>
<h3 id="smoothstep"><a href="#smoothstep" class="headerlink" title="smoothstep"></a>smoothstep</h3><img src="https://s2.loli.net/2025/09/13/serIA7TCWUdJnBY.png" alt="ShaderSmoothstep" style="width: 30%;">

<p>æˆ‘ä»¬å¯ä»¥ç›´è§‚çš„çœ‹å‡ºï¼šå½“x &lt; 0æ—¶ï¼Œè¿”å›0ï¼Œå½“ x &gt; 1æ—¶ï¼Œè¿”å›1ï¼Œå¦‚æœ x å¤„äº0~1ä¹‹é—´æ—¶ï¼Œåˆ™æœ‰ä¸€ä¸ªç±»ä¼¼äºçº¿æ€§æ’å€¼çš„è¿‡æ¸¡ï¼Œä½†æ˜¯è¯·æ³¨æ„ï¼Œè¿™é‡Œå¹¶ä¸æ˜¯çº¿æ€§æ’å€¼ï¼Œå› ä¸ºåœ¨æ¥è¿‘ä¸¤ç«¯çš„å€¼çš„æ—¶å€™ï¼Œè¯¥å‡½æ•°æœ‰ä¸€ä¸ªå¹³æ»‘çš„è¿‡æ¸¡ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸€ç‚¹æ¥å¯¹ <code>step</code> å‡½æ•°è¿›è¡Œæ›¿æ¢ä»¥è§£å†³é”¯é½¿çš„é—®é¢˜ã€‚</p>
<h3 id="floor"><a href="#floor" class="headerlink" title="floor"></a>floor</h3><p> ä½œç”¨æ˜¯<strong>å‘ä¸‹å–æ•´</strong>ï¼Œå®ƒä¼šè¿”å›ä¸å¤§äºè¾“å…¥å€¼çš„æœ€å¤§æ•´æ•°ã€‚ä¾‹å¦‚ï¼šå¯¹ <code>uv</code> å‘é‡çš„æ¯ä¸ªåˆ†é‡ï¼ˆxå’Œyï¼‰åˆ†åˆ«æ‰§è¡Œå‘ä¸‹å–æ•´</p>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">floor</span>(<span class="number">3.7</span>)` â†’ `<span class="number">3.0</span></span><br><span class="line"><span class="built_in">floor</span>(<span class="number">-1.2</span>)` â†’ `<span class="number">-2.0</span></span><br></pre></td></tr></table></figure>

<h2 id="æ ¸å¿ƒæ­¥éª¤ï¼ˆæ¸²æŸ“ç®¡çº¿ï¼‰"><a href="#æ ¸å¿ƒæ­¥éª¤ï¼ˆæ¸²æŸ“ç®¡çº¿ï¼‰" class="headerlink" title="æ ¸å¿ƒæ­¥éª¤ï¼ˆæ¸²æŸ“ç®¡çº¿ï¼‰"></a>æ ¸å¿ƒæ­¥éª¤ï¼ˆæ¸²æŸ“ç®¡çº¿ï¼‰</h2><ol>
<li>é¡¶ç‚¹å˜æ¢çš„è¿‡ç¨‹ï¼ˆé¡¶ç‚¹ç€è‰²å™¨ï¼‰</li>
<li>å›¾å…ƒè£…é…ï¼ˆæŒ‰å“ªç§æ–¹å¼è£…é…å›¾å…ƒï¼Œè£…é…ä¸ºç‚¹ï¼Œçº¿è¿˜æ˜¯ä¸‰è§’å½¢ï¼‰</li>
<li>å…‰æ …åŒ–ï¼ˆå°†ä¸Šè¿°çš„å›¾å…ƒä»çŸ¢é‡å›¾å½¢è½¬æ¢ä¸ºåƒç´ ç»„æˆçš„å›¾å½¢ï¼‰</li>
<li>ç€è‰²ï¼ˆç‰‡æ®µç€è‰²å™¨ï¼‰</li>
<li>æµ‹è¯•ï¼ˆAlphaæµ‹è¯•ï¼Œæ·±åº¦æµ‹è¯•ï¼Œæ¨¡æ¿æµ‹è¯•ç­‰ï¼‰&amp; æ··åˆ</li>
</ol>
<img src="https://s2.loli.net/2025/09/13/oXpMmr2g5wUtbyP.png" alt="WXWorkCapture_17531696303010" style="width: 30%;">

<h2 id="åæ ‡ç³»"><a href="#åæ ‡ç³»" class="headerlink" title="åæ ‡ç³»"></a>åæ ‡ç³»</h2><div style="display: flex; gap: 20px; align-items: flex-start;">
<img src="https://s2.loli.net/2025/09/13/d1zabnP8quoMp3F.png" alt="image-20250722154307710" style="width: 30%;">
<img src="https://s2.loli.net/2025/09/13/hxSrfLa5FeM7UnD.png" alt="image-20250722154418915" style="width: 30%;">
</div>

<p>è¿™æ˜¯å·¦æ‰‹åæ ‡ç³» åä¹‹æ˜¯å³æ‰‹åæ ‡ç³»</p>
<p>OpenGLæ˜¯å³æ‰‹åæ ‡ç³»</p>
<h2 id="å®ç°ä»£ç "><a href="#å®ç°ä»£ç " class="headerlink" title="å®ç°ä»£ç "></a>å®ç°ä»£ç </h2><h3 id="1-æœ€åˆå§‹çš„å®ä¾‹ä»£ç -ï¼ˆå®ç°ä¸€ä¸ªåæ ‡è½´ï¼‰"><a href="#1-æœ€åˆå§‹çš„å®ä¾‹ä»£ç -ï¼ˆå®ç°ä¸€ä¸ªåæ ‡è½´ï¼‰" class="headerlink" title="1. æœ€åˆå§‹çš„å®ä¾‹ä»£ç   ï¼ˆå®ç°ä¸€ä¸ªåæ ‡è½´ï¼‰:"></a>1. æœ€åˆå§‹çš„å®ä¾‹ä»£ç   ï¼ˆå®ç°ä¸€ä¸ªåæ ‡è½´ï¼‰:</h3><figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å½’ä¸€åŒ–uvåæ ‡åˆ°[-1,1]èŒƒå›´ï¼Œä¿æŒå®½é«˜æ¯”</span></span><br><span class="line"><span class="type">vec2</span> fixUV(<span class="type">vec2</span> coord) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2.0</span> * (coord - <span class="number">0.5</span> * iResolution.xy) / <span class="built_in">min</span>(iResolution.x, iResolution.y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»˜åˆ¶ç½‘æ ¼çº¿</span></span><br><span class="line"><span class="type">bool</span> drawGrid(<span class="type">vec2</span> uv, <span class="type">float</span> scale) &#123;</span><br><span class="line">    <span class="comment">// fract(uv * scale)ï¼šå°†åæ ‡æŒ‰æ¯”ä¾‹ç¼©æ”¾åå–å°æ•°éƒ¨åˆ†ï¼Œå¾—åˆ°æ¯ä¸ªç½‘æ ¼å†…çš„ç›¸å¯¹åæ ‡</span></span><br><span class="line">    <span class="comment">// fwidth(f_uv.x)ï¼šè®¡ç®—ç‰‡æ®µç€è‰²å™¨ä¸­ç›¸é‚»åƒç´ çš„æ¢¯åº¦ï¼Œå³å½“å‰åƒç´ åˆ°ä¸‹ä¸€åƒç´ çš„å˜åŒ–ç‡</span></span><br><span class="line">    <span class="type">vec2</span> f_uv = <span class="built_in">fract</span>(uv * scale);</span><br><span class="line">    <span class="comment">// abs(f_uv.x) &lt; fwidth(f_uv.x)ï¼šå½“ç›¸å¯¹åæ ‡æ¥è¿‘ 0 æ—¶ï¼ˆå³ç½‘æ ¼çº¿ä½ç½®ï¼‰ï¼Œè¿”å› true</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">abs</span>(f_uv.x) &lt; <span class="built_in">fwidth</span>(f_uv.x) || <span class="built_in">abs</span>(f_uv.y) &lt; <span class="built_in">fwidth</span>(f_uv.y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»˜åˆ¶åæ ‡è½´</span></span><br><span class="line"><span class="type">vec3</span> drawAxis(<span class="type">vec2</span> uv) &#123;</span><br><span class="line">    <span class="type">vec3</span> color = <span class="type">vec3</span>(<span class="number">0.0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">abs</span>(uv.x) &lt; <span class="built_in">fwidth</span>(uv.x)) &#123;</span><br><span class="line">        color = <span class="type">vec3</span>(<span class="number">0.0</span>, <span class="number">1.0</span>, <span class="number">0.0</span>); <span class="comment">// xè½´ä¸ºç»¿è‰²</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">abs</span>(uv.y) &lt; <span class="built_in">fwidth</span>(uv.y)) &#123;</span><br><span class="line">        color = <span class="type">vec3</span>(<span class="number">1.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>); <span class="comment">// yè½´ä¸ºçº¢è‰²</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> color;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸»å‡½æ•°</span></span><br><span class="line"><span class="type">void</span> mainImage(<span class="keyword">out</span> <span class="type">vec4</span> fragColor, <span class="keyword">in</span> <span class="type">vec2</span> fragCoord) &#123;</span><br><span class="line">    <span class="comment">// å½’ä¸€åŒ–åæ ‡</span></span><br><span class="line">    <span class="type">vec2</span> uv = fixUV(fragCoord);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åŸºç¡€èƒŒæ™¯è‰²</span></span><br><span class="line">    <span class="type">vec3</span> color = <span class="type">vec3</span>(<span class="number">0.0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç»˜åˆ¶ç½‘æ ¼</span></span><br><span class="line">    <span class="keyword">if</span>(drawGrid(uv, <span class="number">3.0</span>)) &#123;</span><br><span class="line">        color = <span class="type">vec3</span>(<span class="number">1.0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç»˜åˆ¶åæ ‡è½´ï¼ˆä¼šè¦†ç›–ç½‘æ ¼çº¿ï¼‰</span></span><br><span class="line">    <span class="type">vec3</span> axisColor = drawAxis(uv);</span><br><span class="line">    <span class="keyword">if</span>(axisColor != <span class="type">vec3</span>(<span class="number">0.0</span>)) &#123;</span><br><span class="line">        color = axisColor;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    fragColor = <span class="type">vec4</span>(color, <span class="number">1.0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://www.shadertoy.com/view/Wf2fRw">https://www.shadertoy.com/view/Wf2fRw</a><br>è¿™ä¸ªshaderåˆ›å»ºäº†ä¸€ä¸ªåæ ‡ç³»ç»Ÿï¼ŒåŒ…å«ç½‘æ ¼çº¿å’Œå½©è‰²åæ ‡è½´ã€‚</p>
<h3 id="2-å®ç°å‡½æ•°çš„y-kxçš„ç»˜åˆ¶"><a href="#2-å®ç°å‡½æ•°çš„y-kxçš„ç»˜åˆ¶" class="headerlink" title="2. å®ç°å‡½æ•°çš„y&#x3D;kxçš„ç»˜åˆ¶"></a>2. å®ç°å‡½æ•°çš„y&#x3D;kxçš„ç»˜åˆ¶</h3><figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å½’ä¸€åŒ–uvåæ ‡åˆ°[-1,1]èŒƒå›´ï¼Œä¿æŒå®½é«˜æ¯”</span></span><br><span class="line"><span class="type">vec2</span> fixUV(<span class="type">vec2</span> coord) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2.0</span> * (coord - <span class="number">0.5</span> * iResolution.xy) / <span class="built_in">min</span>(iResolution.x, iResolution.y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»˜åˆ¶ç½‘æ ¼çº¿</span></span><br><span class="line"><span class="type">bool</span> drawGrid(<span class="type">vec2</span> uv, <span class="type">float</span> scale) &#123;</span><br><span class="line">    <span class="type">vec2</span> f_uv = <span class="built_in">fract</span>(uv * scale);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">abs</span>(f_uv.x) &lt; <span class="built_in">fwidth</span>(f_uv.x) || <span class="built_in">abs</span>(f_uv.y) &lt; <span class="built_in">fwidth</span>(f_uv.y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»˜åˆ¶åæ ‡è½´</span></span><br><span class="line"><span class="type">vec3</span> drawAxis(<span class="type">vec2</span> uv) &#123;</span><br><span class="line">    <span class="type">vec3</span> color = <span class="type">vec3</span>(<span class="number">0.0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">abs</span>(uv.x) &lt; <span class="built_in">fwidth</span>(uv.x)) &#123;</span><br><span class="line">        color = <span class="type">vec3</span>(<span class="number">0.0</span>, <span class="number">1.0</span>, <span class="number">0.0</span>); <span class="comment">// xè½´ä¸ºç»¿è‰²</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">abs</span>(uv.y) &lt; <span class="built_in">fwidth</span>(uv.y)) &#123;</span><br><span class="line">        color = <span class="type">vec3</span>(<span class="number">1.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>); <span class="comment">// yè½´ä¸ºçº¢è‰²</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> color;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¡ç®—ç‚¹åˆ°ç›´çº¿è·ç¦»çš„å‘é‡å®ç°</span></span><br><span class="line"><span class="comment">// è¿™ä¸ªå‡½æ•°è®¡ç®—ç‚¹påˆ°çº¿æ®µabçš„æœ€çŸ­è·ç¦»</span></span><br><span class="line"><span class="comment">// aã€bæ˜¯çº¿æ®µçš„ä¸¤ä¸ªç«¯ç‚¹</span></span><br><span class="line"><span class="type">float</span> distLine(<span class="type">vec2</span> p, <span class="type">vec2</span> a, <span class="type">vec2</span> b) &#123;</span><br><span class="line">    <span class="type">vec2</span> ab = b - a;</span><br><span class="line">    <span class="type">vec2</span> ap = p - a;</span><br><span class="line">    <span class="type">vec2</span> ad = <span class="built_in">dot</span>(ab, ap) / <span class="built_in">dot</span>(ab, ab) * ab;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">length</span>(ap - ad);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸»å‡½æ•°</span></span><br><span class="line"><span class="type">void</span> mainImage(<span class="keyword">out</span> <span class="type">vec4</span> fragColor, <span class="keyword">in</span> <span class="type">vec2</span> fragCoord) &#123;</span><br><span class="line">    <span class="comment">// æ—§çš„éƒ¨åˆ†</span></span><br><span class="line">    <span class="type">vec2</span> uv = fixUV(fragCoord);</span><br><span class="line">    <span class="type">vec3</span> color = <span class="type">vec3</span>(<span class="number">0.0</span>);</span><br><span class="line">    <span class="keyword">if</span>(drawGrid(uv, <span class="number">10.0</span>)) &#123;</span><br><span class="line">        color = <span class="type">vec3</span>(<span class="number">1.0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">vec3</span> axisColor = drawAxis(uv);</span><br><span class="line">    <span class="keyword">if</span>(axisColor != <span class="type">vec3</span>(<span class="number">0.0</span>)) &#123;</span><br><span class="line">        color = axisColor;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="type">float</span> d = distLine(uv, <span class="type">vec2</span>(<span class="number">0.0</span>), <span class="type">vec2</span>(<span class="number">1.0</span>));</span><br><span class="line">    color = <span class="built_in">mix</span>(color, <span class="type">vec3</span>(<span class="number">0.0</span>,<span class="number">0.0</span>,<span class="number">1.0</span>), <span class="built_in">smoothstep</span>(<span class="number">0.002</span>, <span class="number">0.001</span>, d));</span><br><span class="line">    fragColor = <span class="type">vec4</span>(color, <span class="number">1.0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://www.shadertoy.com/view/3c2fzw">https://www.shadertoy.com/view/3c2fzw</a></p>
<h3 id="3-å®ç°ä¸€æ®µå¤æ‚å‡½æ•°çš„ç»˜åˆ¶ï¼ˆåˆ†æ®µç»˜åˆ¶ï¼‰"><a href="#3-å®ç°ä¸€æ®µå¤æ‚å‡½æ•°çš„ç»˜åˆ¶ï¼ˆåˆ†æ®µç»˜åˆ¶ï¼‰" class="headerlink" title="3. å®ç°ä¸€æ®µå¤æ‚å‡½æ•°çš„ç»˜åˆ¶ï¼ˆåˆ†æ®µç»˜åˆ¶ï¼‰"></a>3. å®ç°ä¸€æ®µå¤æ‚å‡½æ•°çš„ç»˜åˆ¶ï¼ˆåˆ†æ®µç»˜åˆ¶ï¼‰</h3><figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#define PI 3.1415926</span></span><br><span class="line"><span class="meta">#define STEP 1.0</span></span><br><span class="line"></span><br><span class="line"><span class="type">vec2</span> fixUV(<span class="type">vec2</span> coord) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">3.0</span> * (<span class="number">2.</span> * (coord.xy - <span class="number">0.5</span> * iResolution.xy) / <span class="built_in">min</span>(iResolution.x, iResolution.y));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">vec3</span> grid(<span class="type">vec2</span> uv) &#123;</span><br><span class="line">    <span class="type">vec3</span> color = <span class="type">vec3</span>(<span class="number">0.95</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">vec2</span> cell = <span class="number">1.0</span> - <span class="number">2.0</span> * <span class="built_in">abs</span>(<span class="built_in">fract</span>(uv) - <span class="number">0.5</span>);</span><br><span class="line">    color = <span class="built_in">mix</span>(color, <span class="type">vec3</span>(<span class="number">0.7</span>), <span class="built_in">step</span>(cell.x, <span class="number">4.0</span> * <span class="built_in">fwidth</span>(uv.x)));</span><br><span class="line">    color = <span class="built_in">mix</span>(color, <span class="type">vec3</span>(<span class="number">0.7</span>), <span class="built_in">smoothstep</span>(<span class="number">4.0</span> * <span class="built_in">fwidth</span>(uv.y), <span class="number">3.9</span> * <span class="built_in">fwidth</span>(uv.y), cell.y));</span><br><span class="line">    color = <span class="built_in">mix</span>(color, <span class="type">vec3</span>(<span class="number">0.3</span>, <span class="number">0.7</span>, <span class="number">0.8</span>), <span class="built_in">smoothstep</span>(<span class="number">2.0</span> * <span class="built_in">fwidth</span>(uv.x), <span class="number">1.9</span> * <span class="built_in">fwidth</span>(uv.x), <span class="built_in">abs</span>(uv.x)));</span><br><span class="line">    color = <span class="built_in">mix</span>(color, <span class="type">vec3</span>(<span class="number">1.0</span>, <span class="number">0.5</span>, <span class="number">0.0</span>), <span class="built_in">smoothstep</span>(<span class="number">2.0</span> * <span class="built_in">fwidth</span>(uv.x), <span class="number">1.9</span> * <span class="built_in">fwidth</span>(uv.y), <span class="built_in">abs</span>(uv.y)));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> color;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> func(<span class="keyword">in</span> <span class="type">float</span> x) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sin</span>(x + <span class="built_in">sin</span>(x + <span class="built_in">sin</span>(x) * <span class="number">0.8</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> distLine(<span class="type">vec2</span> p, <span class="type">vec2</span> a, <span class="type">vec2</span> b) &#123;</span><br><span class="line">    <span class="type">vec2</span> ab = b - a;</span><br><span class="line">    <span class="type">vec2</span> ap = p - a;</span><br><span class="line">    <span class="type">vec2</span> ad = <span class="built_in">clamp</span>(<span class="built_in">dot</span>(ab, ap) / <span class="built_in">dot</span>(ab, ab), <span class="number">0.0</span>, <span class="number">1.0</span>) * ab;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">length</span>(ap - ad);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®ƒæ˜¯ä¸€ä¸ªæ•°å­¦è®¡ç®—å‡½æ•°ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªè¡¨ç¤º&quot;çº¿æ®µå½±å“å€¼&quot;çš„æµ®ç‚¹æ•°ã€‚</span></span><br><span class="line"><span class="comment">// è¿”å›çš„ float å€¼è¡¨ç¤ºå½“å‰åƒç´ (uv)ä¸çº¿æ®µçš„æ¥è¿‘ç¨‹åº¦</span></span><br><span class="line"><span class="comment">// å€¼èŒƒå›´åœ¨ 0.0 åˆ° 1.0 ä¹‹é—´ï¼š</span></span><br><span class="line"><span class="comment">// 0.0 è¡¨ç¤ºåƒç´ å®Œå…¨åœ¨çº¿æ®µä¹‹å¤–</span></span><br><span class="line"><span class="comment">// 1.0 è¡¨ç¤ºåƒç´ æ­£å¥½åœ¨çº¿æ®µä¸Š</span></span><br><span class="line"><span class="comment">// ä¸­é—´å€¼è¡¨ç¤ºåƒç´ åœ¨çº¿æ®µé™„è¿‘(æœ‰æŠ—é”¯é½¿æ•ˆæœ)</span></span><br><span class="line"><span class="type">float</span> segment(<span class="type">vec2</span> p, <span class="type">vec2</span> a, <span class="type">vec2</span> b, <span class="type">float</span> w) &#123;</span><br><span class="line">    <span class="type">float</span> f = <span class="number">0.0</span>;</span><br><span class="line">    <span class="type">vec2</span> ab = b - a;</span><br><span class="line">    <span class="type">vec2</span> ap = p - a;</span><br><span class="line">    <span class="type">float</span> proj = <span class="built_in">clamp</span>(<span class="built_in">dot</span>(ab, ap) / <span class="built_in">dot</span>(ab, ab), <span class="number">0.0</span>, <span class="number">1.0</span>);</span><br><span class="line">    <span class="type">float</span> d = <span class="built_in">length</span>(ap - proj * ab);</span><br><span class="line">    f = <span class="built_in">smoothstep</span>(w, w * <span class="number">0.2</span>, d);</span><br><span class="line">    <span class="keyword">return</span> f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> plotFunc(<span class="keyword">in</span> <span class="type">vec2</span> uv) &#123;</span><br><span class="line">    <span class="type">float</span> f = <span class="number">0.0</span>;</span><br><span class="line">    <span class="comment">// è¿™æ˜¯ä¸€ä¸ªä» 0 åˆ°å±å¹•å®½åº¦(iResolution.x)çš„å¾ªç¯</span></span><br><span class="line">    <span class="comment">// STEP æ˜¯æ­¥é•¿(å·²å®šä¹‰ä¸º 1.0)ï¼Œæ§åˆ¶é‡‡æ ·ç‚¹çš„å¯†åº¦</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">float</span> x = <span class="number">0.0</span>; x &lt;= iResolution.x; x += STEP) &#123;</span><br><span class="line">        <span class="comment">// ä¸Šä¸€ä¸ªç‚¹çš„åæ ‡</span></span><br><span class="line">        <span class="type">float</span> fx = fixUV(<span class="type">vec2</span>(x, <span class="number">0.0</span>)).x;</span><br><span class="line">        <span class="comment">// ä¸‹ä¸€ä¸ªç‚¹çš„åæ ‡</span></span><br><span class="line">        <span class="type">float</span> nfx = fixUV(<span class="type">vec2</span>(x + STEP, <span class="number">0.0</span>)).x;</span><br><span class="line">        f += segment(uv, <span class="type">vec2</span>(fx, func(fx)), <span class="type">vec2</span>(nfx, func(nfx)), <span class="number">0.006</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> mainImage(<span class="keyword">out</span> <span class="type">vec4</span> fragColor, <span class="keyword">in</span> <span class="type">vec2</span> fragCoord) &#123;</span><br><span class="line">    <span class="comment">// old</span></span><br><span class="line">    <span class="type">vec2</span> uv = fixUV(fragCoord.xy);</span><br><span class="line">    <span class="type">vec3</span> color = grid(uv);</span><br><span class="line"></span><br><span class="line">    <span class="type">float</span> f = plotFunc(uv);</span><br><span class="line">    color = <span class="built_in">mix</span>(color, <span class="type">vec3</span>(<span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>), f);</span><br><span class="line">    fragColor = <span class="type">vec4</span>(color, <span class="number">1.0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.shadertoy.com/view/Wc2fzw">https://www.shadertoy.com/view/Wc2fzw</a></p>
<h3 id="4-å®ç°ä¸€ä¸ªï¼ˆé™æ€ï¼‰æ˜ŸèŠ’æ•ˆæœ"><a href="#4-å®ç°ä¸€ä¸ªï¼ˆé™æ€ï¼‰æ˜ŸèŠ’æ•ˆæœ" class="headerlink" title="4. å®ç°ä¸€ä¸ªï¼ˆé™æ€ï¼‰æ˜ŸèŠ’æ•ˆæœ"></a>4. å®ç°ä¸€ä¸ªï¼ˆé™æ€ï¼‰æ˜ŸèŠ’æ•ˆæœ</h3><figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#define PI 3.1415926</span></span><br><span class="line"><span class="meta">#define STEP 1.0</span></span><br><span class="line"></span><br><span class="line"><span class="type">vec2</span> fixUV(<span class="type">vec2</span> coord) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">4.0</span> * (<span class="number">2.</span> * (coord.xy - <span class="number">0.5</span> * iResolution.xy) / <span class="built_in">min</span>(iResolution.x, iResolution.y));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">vec3</span> grid(<span class="type">vec2</span> uv) &#123;</span><br><span class="line">    <span class="comment">// åæ ‡å¤–å…¶ä»–é¢œè‰²ç»˜åˆ¶æ”¹å˜</span></span><br><span class="line">    <span class="type">vec3</span> color = <span class="type">vec3</span>(<span class="number">0.0</span>);</span><br><span class="line">    color.rg = <span class="built_in">fract</span>(uv);</span><br><span class="line"></span><br><span class="line">    <span class="type">vec2</span> cell = <span class="number">1.0</span> - <span class="number">2.0</span> * <span class="built_in">abs</span>(<span class="built_in">fract</span>(uv) - <span class="number">0.5</span>);</span><br><span class="line">    <span class="comment">// ç½‘æ ¼çºµå‘</span></span><br><span class="line">    color = <span class="built_in">mix</span>(color, <span class="type">vec3</span>(<span class="number">0.7</span>), <span class="built_in">step</span>(cell.x, <span class="number">4.0</span> * <span class="built_in">fwidth</span>(uv.x)));</span><br><span class="line">    <span class="comment">// ç½‘æ ¼æ¨ªå‘</span></span><br><span class="line">    color = <span class="built_in">mix</span>(color, <span class="type">vec3</span>(<span class="number">0.7</span>), <span class="built_in">smoothstep</span>(<span class="number">4.0</span> * <span class="built_in">fwidth</span>(uv.y), <span class="number">3.9</span> * <span class="built_in">fwidth</span>(uv.y), cell.y));</span><br><span class="line">    <span class="comment">// çºµå‘åæ ‡è½´</span></span><br><span class="line">    color = <span class="built_in">mix</span>(color, <span class="type">vec3</span>(<span class="number">0.3</span>, <span class="number">0.7</span>, <span class="number">0.8</span>), <span class="built_in">smoothstep</span>(<span class="number">2.0</span> * <span class="built_in">fwidth</span>(uv.x), <span class="number">1.9</span> * <span class="built_in">fwidth</span>(uv.x), <span class="built_in">abs</span>(uv.x)));</span><br><span class="line">    <span class="comment">// æ¨ªå‘åæ ‡è½´</span></span><br><span class="line">    color = <span class="built_in">mix</span>(color, <span class="type">vec3</span>(<span class="number">1.0</span>, <span class="number">0.5</span>, <span class="number">0.0</span>), <span class="built_in">smoothstep</span>(<span class="number">2.0</span> * <span class="built_in">fwidth</span>(uv.x), <span class="number">1.9</span> * <span class="built_in">fwidth</span>(uv.y), <span class="built_in">abs</span>(uv.y)));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> color;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> func(<span class="keyword">in</span> <span class="type">float</span> x) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sin</span>(x + <span class="built_in">sin</span>(x + <span class="built_in">sin</span>(x) * <span class="number">0.8</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> distLine(<span class="type">vec2</span> p, <span class="type">vec2</span> a, <span class="type">vec2</span> b) &#123;</span><br><span class="line">    <span class="type">vec2</span> ab = b - a;</span><br><span class="line">    <span class="type">vec2</span> ap = p - a;</span><br><span class="line">    <span class="type">vec2</span> ad = <span class="built_in">clamp</span>(<span class="built_in">dot</span>(ab, ap) / <span class="built_in">dot</span>(ab, ab), <span class="number">0.0</span>, <span class="number">1.0</span>) * ab;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">length</span>(ap - ad);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> Line(<span class="type">vec2</span> p, <span class="type">vec2</span> a, <span class="type">vec2</span> b) &#123;</span><br><span class="line">    <span class="type">float</span> d = distLine(p, a, b);</span><br><span class="line">    <span class="type">float</span> m = <span class="built_in">smoothstep</span>(<span class="number">0.02</span>, <span class="number">0.01</span>, d);</span><br><span class="line">    <span class="keyword">return</span> m;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> segment(<span class="type">vec2</span> p, <span class="type">vec2</span> a, <span class="type">vec2</span> b, <span class="type">float</span> w) &#123;</span><br><span class="line">    <span class="type">float</span> f = <span class="number">0.0</span>;</span><br><span class="line">    <span class="type">vec2</span> ab = b - a;</span><br><span class="line">    <span class="type">vec2</span> ap = p - a;</span><br><span class="line">    <span class="type">float</span> proj = <span class="built_in">clamp</span>(<span class="built_in">dot</span>(ab, ap) / <span class="built_in">dot</span>(ab, ab), <span class="number">0.0</span>, <span class="number">1.0</span>);</span><br><span class="line">    <span class="type">float</span> d = <span class="built_in">length</span>(ap - proj * ab);</span><br><span class="line">    f = <span class="built_in">smoothstep</span>(w, w * <span class="number">0.2</span>, d);</span><br><span class="line">    <span class="keyword">return</span> f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> mainImage(<span class="keyword">out</span> <span class="type">vec4</span> fragColor, <span class="keyword">in</span> <span class="type">vec2</span> fragCoord) &#123;</span><br><span class="line">    <span class="type">vec2</span> uv = fixUV(fragCoord.xy);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¿®æ”¹äº†ç»˜åˆ¶åæ ‡çš„å‡½æ•°</span></span><br><span class="line">    <span class="type">vec3</span> Basecolor = grid(uv);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°åæ ‡ä½ç½®ä¸­å¿ƒç‚¹å¼„åˆ°æ–¹å—çš„ä¸­å¿ƒ</span></span><br><span class="line">    <span class="type">vec2</span> st = <span class="built_in">fract</span>(uv) - <span class="number">0.5</span>;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»º3x3ç‚¹é˜µ</span></span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="type">vec2</span> p[<span class="number">9</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">float</span> y = <span class="number">-1.0</span>; y &lt;= <span class="number">1.0</span>; y++) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">float</span> x = <span class="number">-1.0</span>; x &lt;= <span class="number">1.0</span>; x++) &#123;</span><br><span class="line">            <span class="type">vec2</span> offs = <span class="type">vec2</span>(x, y);</span><br><span class="line">            p[i++] = offs;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿çº¿ç»˜åˆ¶ (ä½¿ç”¨è“è‰²)</span></span><br><span class="line">    <span class="type">float</span> m2 = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">9</span>; i++) &#123;</span><br><span class="line">        m2 += Line(st, p[i], p[<span class="number">4</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    Basecolor = <span class="built_in">mix</span>(Basecolor, <span class="type">vec3</span>(<span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">1.0</span>), m2); <span class="comment">// ç»˜åˆ¶è¿çº¿</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç»˜åˆ¶æ¯ä¸ªåŒºåŸŸä¸­é—´çš„ç‚¹ (ä½¿ç”¨çº¢è‰²)</span></span><br><span class="line">    <span class="type">float</span> d = <span class="built_in">length</span>(st);</span><br><span class="line">    <span class="type">float</span> m1 = <span class="built_in">smoothstep</span>(<span class="number">0.1</span>, <span class="number">0.09</span>, d);</span><br><span class="line">    Basecolor = <span class="built_in">mix</span>(Basecolor, <span class="type">vec3</span>(<span class="number">1.0</span>), m1); <span class="comment">// ç»˜åˆ¶ç‚¹</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    fragColor = <span class="type">vec4</span>(Basecolor, <span class="number">1.0</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<img src="https://s2.loli.net/2025/09/13/6obpL7qJrvcfXka.png" alt="shadertoy4" style="width: 30%;">

<h3 id="5-éšæœºæ•°ç”ŸæˆåŠæ³•"><a href="#5-éšæœºæ•°ç”ŸæˆåŠæ³•" class="headerlink" title="5. éšæœºæ•°ç”ŸæˆåŠæ³•"></a>5. éšæœºæ•°ç”ŸæˆåŠæ³•</h3><figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">vec2</span> N22(<span class="type">vec2</span> p) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä»»æ„çš„å¤§æ•°å­— ä½†è¿˜æ˜¯æœ‰ä¸€äº›è¦æ±‚ï¼š</span></span><br><span class="line">    <span class="comment">// ä½ å¯ä»¥æ›¿æ¢ä¸ºå…¶ä»–å¤§æ•°ï¼ˆå¦‚ vec2(123.45, 678.90)ï¼‰</span></span><br><span class="line">    <span class="comment">// ä½†éœ€è¦é¿å…ï¼š</span></span><br><span class="line">    <span class="comment">// è¿‡äºç®€å•çš„æ•°å­—ï¼ˆå¦‚ 100.0, 200.0ï¼‰</span></span><br><span class="line">    <span class="comment">// äº’ä¸ºå€æ•°çš„æ•°å­—ï¼ˆå¦‚ 50.0, 100.0ï¼‰</span></span><br><span class="line">    <span class="comment">// ä¸åç»­é­”æ³•æ•°å­—ï¼ˆ123.34ç­‰ï¼‰æœ‰ç®€å•æ•°å­¦å…³ç³»çš„æ•°å­—</span></span><br><span class="line">    p += <span class="type">vec2</span>(<span class="number">434.67</span>, <span class="number">534.23</span>);  </span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†2Dåæ ‡æ‰©å±•ä¸º3Då‘é‡ p.xyxï¼ˆå¦‚è¾“å…¥(x,y)å˜ä¸º(x,y,x)ï¼‰</span></span><br><span class="line">    <span class="comment">// ä¹˜ä»¥ç²¾å¿ƒé€‰æ‹©çš„&quot;é­”æ³•æ•°å­—&quot;å‘é‡ï¼ˆè¿™äº›è´¨æ•°å¢åŠ æ··ä¹±åº¦ï¼‰</span></span><br><span class="line">    <span class="comment">// fract() å–å°æ•°éƒ¨åˆ†ï¼Œç¡®ä¿æ•°å€¼åœ¨[0,1)èŒƒå›´å†…</span></span><br><span class="line">    <span class="type">vec3</span> a = <span class="built_in">fract</span>(p.xyx * <span class="type">vec3</span>(<span class="number">123.34</span>, <span class="number">234.34</span>, <span class="number">345.65</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¡ç®—å‘é‡ç‚¹ç§¯å¹¶å åŠ åˆ°è‡ªèº«ï¼ˆdot(a,a)è®¡ç®—è‡ªç›¸å…³ï¼‰</span></span><br><span class="line">    <span class="comment">// æ·»åŠ 34.45åç§»é¿å…å¯¹ç§°æ€§</span></span><br><span class="line">    <span class="comment">// è¿™æ­¥å¤§å¹…å¢åŠ è¾“å‡ºçš„éšæœºæ€§</span></span><br><span class="line">    a += <span class="built_in">dot</span>(a, a + <span class="number">34.45</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">fract</span>(<span class="type">vec2</span>(a.x * a.y, a.y * a.z));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">vec2</span> fixUV(<span class="type">vec2</span> coord) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">3.0</span> * (<span class="number">2.</span> * (coord.xy - <span class="number">0.5</span> * iResolution.xy) / <span class="built_in">min</span>(iResolution.x, iResolution.y));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> mainImage(<span class="keyword">out</span> <span class="type">vec4</span> fragColor, <span class="keyword">in</span> <span class="type">vec2</span> fragCoord) &#123;</span><br><span class="line">    <span class="type">vec2</span> uv = fixUV(fragCoord.xy);</span><br><span class="line"></span><br><span class="line">    <span class="type">vec2</span> n = N22(uv);</span><br><span class="line">    fragColor = <span class="type">vec4</span>(n, <span class="number">0.0</span>, <span class="number">1.0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="https://s2.loli.net/2025/09/13/s9ievPKCbrxIj3n.png" alt="shadertoy5" style="width: 30%;">

<h3 id="6-æ˜Ÿæ˜Ÿè¿çº¿æ•ˆæœ"><a href="#6-æ˜Ÿæ˜Ÿè¿çº¿æ•ˆæœ" class="headerlink" title="6. æ˜Ÿæ˜Ÿè¿çº¿æ•ˆæœ"></a>6. æ˜Ÿæ˜Ÿè¿çº¿æ•ˆæœ</h3><figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#define PI 3.1415926</span></span><br><span class="line"><span class="meta">#define STEP 1.0</span></span><br><span class="line"></span><br><span class="line"><span class="type">vec2</span> fixUV(<span class="type">vec2</span> coord) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">5.0</span> * (<span class="number">2.</span> * (coord.xy - <span class="number">0.5</span> * iResolution.xy) / <span class="built_in">min</span>(iResolution.x, iResolution.y));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> distLine(<span class="type">vec2</span> p, <span class="type">vec2</span> a, <span class="type">vec2</span> b) &#123;</span><br><span class="line">    <span class="type">vec2</span> ab = b - a;</span><br><span class="line">    <span class="type">vec2</span> ap = p - a;</span><br><span class="line">    <span class="type">vec2</span> ad = <span class="built_in">clamp</span>(<span class="built_in">dot</span>(ab, ap) / <span class="built_in">dot</span>(ab, ab), <span class="number">0.0</span>, <span class="number">1.0</span>) * ab;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">length</span>(ap - ad);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> Line(<span class="type">vec2</span> p, <span class="type">vec2</span> a, <span class="type">vec2</span> b) &#123;</span><br><span class="line">    <span class="type">float</span> d = distLine(p, a, b);  <span class="comment">// è®¡ç®—ç‚¹påˆ°çº¿æ®µabçš„è·ç¦»</span></span><br><span class="line">    <span class="type">float</span> m = <span class="built_in">smoothstep</span>(<span class="number">0.02</span>, <span class="number">0.01</span>, d); <span class="comment">// ç¬¬ä¸€æ¬¡æ¸å˜ï¼šç”Ÿæˆçº¿å®½</span></span><br><span class="line">    <span class="type">float</span> d2 = <span class="built_in">length</span>(a - b);     <span class="comment">// è®¡ç®—çº¿æ®µabçš„é•¿åº¦</span></span><br><span class="line">    m *= <span class="built_in">smoothstep</span>(<span class="number">1.2</span>, <span class="number">1.1</span>, d2);<span class="comment">// ç¬¬äºŒæ¬¡æ¸å˜ï¼šæ§åˆ¶çº¿æ®µæ˜¾éš</span></span><br><span class="line">    <span class="keyword">return</span> m;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">vec2</span> N22(<span class="type">vec2</span> p) &#123;</span><br><span class="line">    p += <span class="type">vec2</span>(<span class="number">434.67</span>, <span class="number">534.23</span>);</span><br><span class="line">    <span class="type">vec3</span> a = <span class="built_in">fract</span>(p.xyx * <span class="type">vec3</span>(<span class="number">123.34</span>, <span class="number">234.34</span>, <span class="number">345.65</span>));</span><br><span class="line">    a += <span class="built_in">dot</span>(a, a + <span class="number">34.45</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">fract</span>(<span class="type">vec2</span>(a.x * a.y, a.y * a.z));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">vec3</span> N23_to_3(<span class="type">vec2</span> p) &#123;</span><br><span class="line">    <span class="comment">// First layer hash</span></span><br><span class="line">    <span class="type">vec3</span> a = <span class="built_in">fract</span>(p.xyx * <span class="type">vec3</span>(<span class="number">123.34</span>, <span class="number">234.34</span>, <span class="number">345.65</span>));</span><br><span class="line">    a += <span class="built_in">dot</span>(a, a.yxz + <span class="number">34.45</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Second layer hash (using rotated coordinates)</span></span><br><span class="line">    <span class="type">vec3</span> b = <span class="built_in">fract</span>(p.yxy * <span class="type">vec3</span>(<span class="number">456.78</span>, <span class="number">567.89</span>, <span class="number">678.91</span>)); </span><br><span class="line">    b += <span class="built_in">dot</span>(b, b.zxy + <span class="number">45.67</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Combine layers</span></span><br><span class="line">    <span class="type">vec3</span> r = <span class="built_in">fract</span>(<span class="type">vec3</span>(</span><br><span class="line">        a.x * b.y,</span><br><span class="line">        a.y * b.z,</span><br><span class="line">        a.z * b.x</span><br><span class="line">    ));</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Final mixing</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">fract</span>(r * <span class="number">0.5</span> + <span class="number">0.5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">vec2</span> GetPos(<span class="type">vec2</span> id, <span class="type">vec2</span> offs) &#123;</span><br><span class="line">    <span class="comment">// æ ¹æ®æ ¼å­çš„ idå’Œoffs äº§ç”Ÿä¸€ä¸ªéšæœºæ•°ï¼Œ</span></span><br><span class="line">    <span class="comment">// ä¹˜ä¸ŠiTimeä½¿å…¶æ ¹æ®æ—¶é—´å‘ç”Ÿå˜åŒ–</span></span><br><span class="line">    <span class="type">vec2</span> n = N22(id + offs) * iTime * <span class="number">6.11</span>; <span class="comment">// 6.11æ˜¯ä¸€ä¸ªè°ƒèŠ‚é€Ÿåº¦çš„æ•°å€¼</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sin</span>(n) * <span class="number">0.4</span> + offs;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> mainImage(<span class="keyword">out</span> <span class="type">vec4</span> fragColor, <span class="keyword">in</span> <span class="type">vec2</span> fragCoord) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="type">vec2</span> uv = fixUV(fragCoord.xy);</span><br><span class="line">    <span class="comment">// ä¿®æ”¹äº†ç»˜åˆ¶åæ ‡çš„å‡½æ•°</span></span><br><span class="line">    <span class="type">vec3</span> Basecolor = <span class="type">vec3</span>(<span class="number">0.0</span>);</span><br><span class="line">    <span class="comment">// å°åæ ‡ä½ç½®ä¸­å¿ƒç‚¹å¼„åˆ°æ–¹å—çš„ä¸­å¿ƒ</span></span><br><span class="line">    <span class="type">vec2</span> st = <span class="built_in">fract</span>(uv) - <span class="number">0.5</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è·å–åˆ°æ ¼å­çš„ä¸­å¿ƒè½´ç‚¹</span></span><br><span class="line">    <span class="type">vec2</span> id = <span class="built_in">floor</span>(uv);</span><br><span class="line">    <span class="type">vec3</span> idcolor = N23_to_3(id);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»º3x3ç‚¹é˜µ</span></span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="type">vec2</span> p[<span class="number">9</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">float</span> y = <span class="number">-1.0</span>; y &lt;= <span class="number">1.0</span>; y++) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">float</span> x = <span class="number">-1.0</span>; x &lt;= <span class="number">1.0</span>; x++) &#123;</span><br><span class="line">            <span class="type">vec2</span> offs = <span class="type">vec2</span>(x, y);</span><br><span class="line">            p[i++] = GetPos(id, offs);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿çº¿ç»˜åˆ¶ (ä½¿ç”¨è“è‰²)</span></span><br><span class="line">    <span class="type">float</span> m2 = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">9</span>; i++) &#123;</span><br><span class="line">        m2 += Line(st, p[i], p[<span class="number">4</span>]);</span><br><span class="line"></span><br><span class="line">     </span><br><span class="line">        <span class="comment">// ç”»æ˜Ÿæ˜Ÿ ä¸­é—´é—ªçƒéƒ¨åˆ†</span></span><br><span class="line">        <span class="type">float</span> d = <span class="built_in">length</span>(st - p[i]);</span><br><span class="line">        <span class="type">float</span> spark = <span class="number">1.0</span> / (d * d * <span class="number">200.0</span>) * (<span class="built_in">sin</span>(iTime * <span class="number">13.0</span> + p[i].x * <span class="number">17.0</span>) * <span class="number">0.4</span> + <span class="number">0.6</span>);</span><br><span class="line">        m2 += spark;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¿™ä¸€éƒ¨åˆ†ä¼šæ–­å¼€ é‡æ–°è¿æ¥</span></span><br><span class="line">        m2 += Line(st, p[<span class="number">1</span>], p[<span class="number">3</span>]);</span><br><span class="line">        m2 += Line(st, p[<span class="number">1</span>], p[<span class="number">5</span>]);</span><br><span class="line">        m2 += Line(st, p[<span class="number">7</span>], p[<span class="number">3</span>]);</span><br><span class="line">        m2 += Line(st, p[<span class="number">7</span>], p[<span class="number">5</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Basecolor = <span class="built_in">mix</span>(Basecolor, idcolor, m2); <span class="comment">// ç»˜åˆ¶è¿çº¿</span></span><br><span class="line">    </span><br><span class="line">    fragColor = <span class="type">vec4</span>(Basecolor, <span class="number">1.0</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="https://s2.loli.net/2025/09/13/VbQwM4mTfhA92B3.png" alt="shadertoy6" style="width: 30%;">

<h3 id="7-æ˜Ÿæ˜Ÿæ¨è¿›ï¼ˆåšä¸»çš„ç‰ˆæœ¬ï¼‰"><a href="#7-æ˜Ÿæ˜Ÿæ¨è¿›ï¼ˆåšä¸»çš„ç‰ˆæœ¬ï¼‰" class="headerlink" title="7. æ˜Ÿæ˜Ÿæ¨è¿›ï¼ˆåšä¸»çš„ç‰ˆæœ¬ï¼‰"></a>7. æ˜Ÿæ˜Ÿæ¨è¿›ï¼ˆåšä¸»çš„ç‰ˆæœ¬ï¼‰</h3><figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">vec2</span> N22(<span class="type">vec2</span> p) &#123;</span><br><span class="line">    p += <span class="type">vec2</span>(<span class="number">434.67</span>, <span class="number">534.23</span>);</span><br><span class="line">    <span class="type">vec3</span> a = <span class="built_in">fract</span>(p.xyx * <span class="type">vec3</span>(<span class="number">123.34</span>, <span class="number">234.34</span>, <span class="number">345.65</span>));</span><br><span class="line">    a += <span class="built_in">dot</span>(a, a + <span class="number">34.45</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">fract</span>(<span class="type">vec2</span>(a.x * a.y, a.y * a.z));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> DistLine(<span class="type">vec2</span> p, <span class="type">vec2</span> a, <span class="type">vec2</span> b) &#123;</span><br><span class="line">    <span class="type">vec2</span> pa = p - a;</span><br><span class="line">    <span class="type">vec2</span> ba = b - a;</span><br><span class="line">    <span class="type">float</span> t = <span class="built_in">clamp</span>(<span class="built_in">dot</span>(pa, ba) / <span class="built_in">dot</span>(ba, ba), <span class="number">0.0</span>, <span class="number">1.0</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">length</span>(pa - ba * t);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">vec2</span> GetPos(<span class="type">vec2</span> id, <span class="type">vec2</span> offs) &#123;</span><br><span class="line">    <span class="type">vec2</span> n = N22(id + offs) * iTime;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sin</span>(n) * <span class="number">0.4</span> + offs;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> Line(<span class="type">vec2</span> p, <span class="type">vec2</span> a, <span class="type">vec2</span> b) &#123;</span><br><span class="line">    <span class="type">float</span> d = DistLine(p, a, b);</span><br><span class="line">    <span class="type">float</span> m = <span class="built_in">smoothstep</span>(<span class="number">0.02</span>, <span class="number">0.01</span>, d);</span><br><span class="line">    <span class="type">float</span> d2 = <span class="built_in">length</span>(a - b);</span><br><span class="line">    m *= <span class="built_in">smoothstep</span>(<span class="number">1.2</span>, <span class="number">0.8</span>, d2) + <span class="built_in">smoothstep</span>(<span class="number">0.05</span>, <span class="number">0.03</span>, <span class="built_in">abs</span>(d2 - <span class="number">0.75</span>));</span><br><span class="line">    <span class="keyword">return</span> m;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> Layer(<span class="type">vec2</span> uv) &#123;</span><br><span class="line">    <span class="type">vec2</span> st = <span class="built_in">fract</span>(uv) - <span class="number">0.5</span>;</span><br><span class="line">    <span class="type">vec2</span> id = <span class="built_in">floor</span>(uv);</span><br><span class="line">    <span class="type">float</span> m = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="type">vec2</span> p[<span class="number">9</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">float</span> y = <span class="number">-1.0</span>; y &lt;= <span class="number">1.0</span>; y++) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">float</span> x = <span class="number">-1.0</span>; x &lt;= <span class="number">1.0</span>; x++) &#123;</span><br><span class="line">            <span class="type">vec2</span> offs = <span class="type">vec2</span>(x, y);</span><br><span class="line">            p[i++] = GetPos(id, offs);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">float</span> t = iTime;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">9</span>; i++) &#123;</span><br><span class="line">        m += Line(st, p[i], p[<span class="number">4</span>]);</span><br><span class="line">        <span class="comment">// vec2 j = (st - p[i]) * 20.0;</span></span><br><span class="line">        <span class="type">float</span> d = <span class="built_in">length</span>(st - p[i]);</span><br><span class="line">        <span class="type">float</span> spark = <span class="number">1.0</span> / (d * d * <span class="number">200.0</span>) * (<span class="built_in">sin</span>(t * <span class="number">13.0</span> + p[i].x * <span class="number">17.0</span>) * <span class="number">0.4</span> + <span class="number">0.6</span>);</span><br><span class="line">        m += spark;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    m += Line(st, p[<span class="number">1</span>], p[<span class="number">3</span>]);</span><br><span class="line">    m += Line(st, p[<span class="number">1</span>], p[<span class="number">5</span>]);</span><br><span class="line">    m += Line(st, p[<span class="number">7</span>], p[<span class="number">3</span>]);</span><br><span class="line">    m += Line(st, p[<span class="number">7</span>], p[<span class="number">5</span>]);</span><br><span class="line">    <span class="keyword">return</span> m;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> mainImage(<span class="keyword">out</span> <span class="type">vec4</span> fragColor, <span class="keyword">in</span> <span class="type">vec2</span> fragCoord) &#123;</span><br><span class="line">    <span class="type">vec2</span> uv = (fragCoord.xy - <span class="number">.5</span> * iResolution.xy) / iResolution.y;</span><br><span class="line">    <span class="type">vec3</span> col = <span class="type">vec3</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">float</span> m = <span class="number">0.0</span>;</span><br><span class="line">    <span class="type">float</span> t = iTime * <span class="number">0.1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">float</span> i = <span class="number">0.0</span>; i &lt;= <span class="number">1.0</span>; i += <span class="number">1.</span> / <span class="number">4.</span>) &#123;</span><br><span class="line">        <span class="type">float</span> depth = <span class="built_in">fract</span>(i + t);</span><br><span class="line">        <span class="type">float</span> size = <span class="built_in">mix</span>(<span class="number">15.0</span>, <span class="number">0.5</span>, depth);</span><br><span class="line">        <span class="type">float</span> fade = <span class="built_in">smoothstep</span>(<span class="number">0.0</span>, <span class="number">0.2</span>, depth) * <span class="built_in">smoothstep</span>(<span class="number">0.9</span>, <span class="number">0.8</span>, depth);</span><br><span class="line">        m += Layer(uv * size + i * <span class="number">20.0</span>) * fade;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    t *= <span class="number">5.0</span>;</span><br><span class="line">    <span class="type">float</span> gradinet = uv.y;</span><br><span class="line">    <span class="type">vec3</span> baseCol = <span class="type">vec3</span>(<span class="number">0.323</span>, <span class="number">0.456</span>, <span class="number">0.567</span>);</span><br><span class="line">    col = m * baseCol * (<span class="built_in">sin</span>(t) * <span class="number">0.4</span> + <span class="number">0.8</span>);</span><br><span class="line">    col -= baseCol * gradinet;</span><br><span class="line">    fragColor = <span class="type">vec4</span>(col, <span class="number">1.0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="https://s2.loli.net/2025/09/13/IsbLwT7aziglYm4.png" alt="shadertoy7" style="width: 30%;">

<h3 id="8-ä¸€ä¸ªæœ€ç®€å•çš„3Dç‚¹"><a href="#8-ä¸€ä¸ªæœ€ç®€å•çš„3Dç‚¹" class="headerlink" title="8.ä¸€ä¸ªæœ€ç®€å•çš„3Dç‚¹"></a>8.ä¸€ä¸ªæœ€ç®€å•çš„3Dç‚¹</h3><p>åŸæœ¬çš„3Dæµç¨‹åº”è¯¥æ˜¯ï¼šâ€œåŸç”»å¸ˆç»˜åˆ¶åœºæ™¯å›¾ï¼ˆå°†3Dåœºæ™¯ç”»ä¸‹æ¥ï¼‰ -&gt; å»ºæ¨¡å¸ˆæ ¹æ®åŸç”»æ„å»ºåœºæ™¯æ¨¡å‹ï¼ˆäº§å‡º3Dæ¨¡å‹ï¼‰-&gt; ç¨‹åºæ¸²æŸ“ï¼ˆå°†3Dæ¨¡å‹å¯¼å…¥åˆ°å¼•æ“ä¸­ï¼Œæˆ–è€…å…¶ä»–3Dæ¸²æŸ“åº“ï¼‰ï¼Œç„¶åæ¸²æŸ“æˆç”»é¢â€ã€‚</p>
<img src="https://s2.loli.net/2025/09/13/bGh2JSUj4oK1WVI.png" alt="img" style="width: 30%;">

<p>æˆ‘ä»¬ç®€è¦å›é¡¾ä¸€ä¸‹ï¼š</p>
<ol>
<li>é¡¶ç‚¹å˜æ¢çš„è¿‡ç¨‹ï¼ˆé¡¶ç‚¹ç€è‰²å™¨ï¼‰</li>
<li>å›¾å…ƒè£…é…ï¼ˆæŒ‰å“ªç§æ–¹å¼è£…é…å›¾å…ƒï¼Œè£…é…ä¸ºç‚¹ï¼Œçº¿è¿˜æ˜¯ä¸‰è§’å½¢ï¼‰</li>
<li>å…‰æ …åŒ–ï¼ˆå°†ä¸Šè¿°çš„å›¾å…ƒä»çŸ¢é‡å›¾å½¢è½¬æ¢ä¸ºåƒç´ ç»„æˆçš„å›¾å½¢ï¼‰</li>
<li>ç€è‰²ï¼ˆç‰‡æ®µç€è‰²å™¨ï¼‰</li>
<li>æµ‹è¯•ï¼ˆAlphaæµ‹è¯•ï¼Œæ·±åº¦æµ‹è¯•ï¼Œæ¨¡æ¿æµ‹è¯•ç­‰ï¼‰&amp; æ··åˆ</li>
</ol>
<p>é€šè¿‡ä¸Šè¿°æ–¹å¼æ¸²æŸ“çš„3Dæ¨¡å‹çš„æ–¹å¼æˆ‘ä»¬é€šå¸¸ç§°ä¸º<strong>å…‰æ …åŒ–çš„æ–¹æ³•</strong></p>
<p>è€Œåœ¨æˆ‘ä»¬çš„shadertoyä¸­ï¼Œæˆ‘ä»¬æ˜¯ç›´æ¥åœ¨ç‰‡æ®µç€è‰²å™¨ä¸­è¿›è¡Œç¼–ç¨‹ï¼Œæˆ‘ä»¬åªæœ‰ä¸Šè¿°çš„ç¬¬å››ä¸ç¬¬äº”æ­¥çš„è¿‡ç¨‹ã€‚å…¶å®ç›¸å½“äºæˆ‘ä»¬ç°åœ¨å˜æˆäº†åŸç”»å¸ˆï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä¸€å¼ çº¸ä¸Šåšç”»ï¼Œè€Œä¸”ç”»çš„æ˜¯3Dåœºæ™¯ã€‚å¥½åœ¨æˆ‘ä»¬è¿˜æœ‰å¦ä¸€ç§æ„å»º3Dåœºæ™¯çš„æ–¹å¼ï¼Œå°±æ˜¯<strong>å…‰çº¿è¿½è¸ªæˆ–å…‰çº¿æ­¥è¿›</strong>ã€‚</p>
<img src="https://s2.loli.net/2025/09/13/1GixOetfmgXlwNq.jpg" alt="img" style="width: 30%;">



<p><a target="_blank" rel="noopener" href="https://juejin.cn/post/7362059823662432306">https://juejin.cn/post/7362059823662432306</a></p>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç‚¹påˆ°ç›´çº¿roåˆ°rdçš„è·ç¦»</span></span><br><span class="line"><span class="type">float</span> DistLine(<span class="type">vec3</span> ro, <span class="type">vec3</span> rd, <span class="type">vec3</span> p) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">length</span>(<span class="built_in">cross</span>(p - ro, rd) / <span class="built_in">length</span>(rd));      <span class="comment">// ä½¿ç”¨å‘é‡å‰ç§¯å…¬å¼è®¡ç®—ç‚¹åˆ°ç›´çº¿çš„è·ç¦»ï¼š(p-ro)ä¸rdçš„å‰ç§¯é•¿åº¦é™¤ä»¥rdçš„é•¿åº¦</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> mainImage(<span class="keyword">out</span> <span class="type">vec4</span> fragColor, <span class="keyword">in</span> <span class="type">vec2</span> fragCoord) &#123;</span><br><span class="line">    <span class="type">vec2</span> uv = fragCoord.xy / iResolution.xy;<span class="comment">// å°†åƒç´ åæ ‡å½’ä¸€åŒ–åˆ°[0,1]èŒƒå›´</span></span><br><span class="line">    uv -= <span class="number">0.5</span>;<span class="comment">// å°†åæ ‡åŸç‚¹ç§»åˆ°å±å¹•ä¸­å¿ƒ(èŒƒå›´å˜ä¸º[-0.5,0.5])</span></span><br><span class="line">    uv.x *= iResolution.x / iResolution.y;<span class="comment">// ä¿®æ­£å®½é«˜æ¯”ï¼Œé˜²æ­¢å›¾åƒå˜å½¢</span></span><br><span class="line"></span><br><span class="line">    <span class="type">vec3</span> ro = <span class="type">vec3</span>(<span class="number">0.</span>, <span class="number">0.</span>, <span class="number">-1.</span>);<span class="comment">// å®šä¹‰æ‘„åƒæœºï¼ˆè§‚å¯Ÿç‚¹ï¼‰ä½ç½®(ray origin)åœ¨z=-1å¤„</span></span><br><span class="line">    <span class="type">vec3</span> rd = <span class="type">vec3</span>(uv.x, uv.y, <span class="number">0.0</span>) - ro;<span class="comment">// è®¡ç®—ä»æ‘„åƒæœºåˆ°å½“å‰åƒç´ çš„å°„çº¿æ–¹å‘(ray direction)</span></span><br><span class="line"></span><br><span class="line">    <span class="type">float</span> t = iGlobalTime; <span class="comment">//å®šä¹‰ä¸€ä¸ªå˜é‡ï¼Œæ–¹ä¾¿è®©çƒåŠ¨èµ·æ¥</span></span><br><span class="line">    <span class="type">vec3</span> p = <span class="type">vec3</span>(<span class="built_in">sin</span>(t), <span class="number">0.</span>, <span class="number">3.0</span>); <span class="comment">// å®šä¹‰çƒçš„ä½ç½®</span></span><br><span class="line">    <span class="type">float</span> r = <span class="number">0.01</span>; <span class="comment">// å®šä¹‰çƒçš„åŠå¾„</span></span><br><span class="line"></span><br><span class="line">    <span class="type">float</span> d = DistLine(ro, rd, p); <span class="comment">// è®¡ç®—çƒå¿ƒä¸è§‚å¯Ÿå°„çº¿ä¹‹é—´çš„è·ç¦»</span></span><br><span class="line">    d = <span class="built_in">smoothstep</span>(r + <span class="number">0.01</span>, r, d); <span class="comment">// è‹¥è·ç¦»å°äºåŠå¾„ï¼Œd åˆ™ç­‰äº1ã€‚</span></span><br><span class="line">    fragColor = <span class="type">vec4</span>(d, d, d, <span class="number">1.0</span>); <span class="comment">// å°†çƒç€è‰²ä¸ºç™½è‰²</span></span><br><span class="line">&#125;   </span><br></pre></td></tr></table></figure>

<img src="https://s2.loli.net/2025/09/13/6ZnjRWTHq9Go4lp.png" alt="shadertoy9" style="width: 30%;">



<h3 id="100-ä¸€ä¸ªæµ·Shaderï¼ˆä¼˜åŒ–ç‰ˆæœ¬ï¼‰"><a href="#100-ä¸€ä¸ªæµ·Shaderï¼ˆä¼˜åŒ–ç‰ˆæœ¬ï¼‰" class="headerlink" title="100.ä¸€ä¸ªæµ·Shaderï¼ˆä¼˜åŒ–ç‰ˆæœ¬ï¼‰"></a>100.ä¸€ä¸ªæµ·Shaderï¼ˆä¼˜åŒ–ç‰ˆæœ¬ï¼‰</h3><figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * &quot;Seascape&quot; by Alexander Alekseev aka TDM - 2014</span></span><br><span class="line"><span class="comment"> * License Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License.</span></span><br><span class="line"><span class="comment"> * Contact: tdmaav@gmail.com</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="type">int</span> NUM_STEPS = <span class="number">32</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="type">float</span> PI	 	= <span class="number">3.141592</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="type">float</span> EPSILON	= <span class="number">1e-3</span>;</span><br><span class="line"><span class="meta">#define EPSILON_NRM (0.1 / iResolution.x)</span></span><br><span class="line"><span class="comment">//#define AA</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// sea</span></span><br><span class="line"><span class="keyword">const</span> <span class="type">int</span> ITER_GEOMETRY = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="type">int</span> ITER_FRAGMENT = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="type">float</span> SEA_HEIGHT = <span class="number">0.6</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="type">float</span> SEA_CHOPPY = <span class="number">4.0</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="type">float</span> SEA_SPEED = <span class="number">0.8</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="type">float</span> SEA_FREQ = <span class="number">0.16</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="type">vec3</span> SEA_BASE = <span class="type">vec3</span>(<span class="number">0.0</span>,<span class="number">0.09</span>,<span class="number">0.18</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="type">vec3</span> SEA_WATER_COLOR = <span class="type">vec3</span>(<span class="number">0.8</span>,<span class="number">0.9</span>,<span class="number">0.6</span>)*<span class="number">0.6</span>;</span><br><span class="line"><span class="meta">#define SEA_TIME (1.0 + iTime * SEA_SPEED)</span></span><br><span class="line"><span class="keyword">const</span> <span class="type">mat2</span> octave_m = <span class="type">mat2</span>(<span class="number">1.6</span>,<span class="number">1.2</span>,<span class="number">-1.2</span>,<span class="number">1.6</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// math</span></span><br><span class="line"><span class="type">mat3</span> fromEuler(<span class="type">vec3</span> ang) &#123;</span><br><span class="line">	<span class="type">vec2</span> a1 = <span class="type">vec2</span>(<span class="built_in">sin</span>(ang.x),<span class="built_in">cos</span>(ang.x));</span><br><span class="line">    <span class="type">vec2</span> a2 = <span class="type">vec2</span>(<span class="built_in">sin</span>(ang.y),<span class="built_in">cos</span>(ang.y));</span><br><span class="line">    <span class="type">vec2</span> a3 = <span class="type">vec2</span>(<span class="built_in">sin</span>(ang.z),<span class="built_in">cos</span>(ang.z));</span><br><span class="line">    <span class="type">mat3</span> m;</span><br><span class="line">    m[<span class="number">0</span>] = <span class="type">vec3</span>(a1.y*a3.y+a1.x*a2.x*a3.x,a1.y*a2.x*a3.x+a3.y*a1.x,-a2.y*a3.x);</span><br><span class="line">	m[<span class="number">1</span>] = <span class="type">vec3</span>(-a2.y*a1.x,a1.y*a2.y,a2.x);</span><br><span class="line">	m[<span class="number">2</span>] = <span class="type">vec3</span>(a3.y*a1.x*a2.x+a1.y*a3.x,a1.x*a3.x-a1.y*a3.y*a2.x,a2.y*a3.y);</span><br><span class="line">	<span class="keyword">return</span> m;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">float</span> hash( <span class="type">vec2</span> p ) &#123;</span><br><span class="line">	<span class="type">float</span> h = <span class="built_in">dot</span>(p,<span class="type">vec2</span>(<span class="number">127.1</span>,<span class="number">311.7</span>));	</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">fract</span>(<span class="built_in">sin</span>(h)*<span class="number">43758.5453123</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">float</span> noise( <span class="keyword">in</span> <span class="type">vec2</span> p ) &#123;</span><br><span class="line">    <span class="type">vec2</span> i = <span class="built_in">floor</span>( p );</span><br><span class="line">    <span class="type">vec2</span> f = <span class="built_in">fract</span>( p );</span><br><span class="line">    <span class="comment">// Add distance-based smoothing</span></span><br><span class="line">    <span class="type">float</span> dist = <span class="built_in">length</span>(p);</span><br><span class="line">    <span class="type">float</span> smoothFactor = <span class="built_in">smoothstep</span>(<span class="number">0.0</span>, <span class="number">5.0</span>, dist);</span><br><span class="line">    <span class="type">vec2</span> u = <span class="built_in">mix</span>(f, f*f*(<span class="number">3.0</span><span class="number">-2.0</span>*f), smoothFactor);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1.0</span>+<span class="number">2.0</span>*<span class="built_in">mix</span>( <span class="built_in">mix</span>( hash( i + <span class="type">vec2</span>(<span class="number">0.0</span>,<span class="number">0.0</span>) ), </span><br><span class="line">                     hash( i + <span class="type">vec2</span>(<span class="number">1.0</span>,<span class="number">0.0</span>) ), u.x),</span><br><span class="line">                <span class="built_in">mix</span>( hash( i + <span class="type">vec2</span>(<span class="number">0.0</span>,<span class="number">1.0</span>) ), </span><br><span class="line">                     hash( i + <span class="type">vec2</span>(<span class="number">1.0</span>,<span class="number">1.0</span>) ), u.x), u.y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// lighting</span></span><br><span class="line"><span class="type">float</span> diffuse(<span class="type">vec3</span> n,<span class="type">vec3</span> l,<span class="type">float</span> p) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(<span class="built_in">dot</span>(n,l) * <span class="number">0.4</span> + <span class="number">0.6</span>,p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">float</span> specular(<span class="type">vec3</span> n,<span class="type">vec3</span> l,<span class="type">vec3</span> e,<span class="type">float</span> s) &#123;    </span><br><span class="line">    <span class="type">float</span> nrm = (s + <span class="number">8.0</span>) / (PI * <span class="number">8.0</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(<span class="built_in">max</span>(<span class="built_in">dot</span>(<span class="built_in">reflect</span>(e,n),l),<span class="number">0.0</span>),s) * nrm;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// sky</span></span><br><span class="line"><span class="type">vec3</span> getSkyColor(<span class="type">vec3</span> e) &#123;</span><br><span class="line">    e.y = (<span class="built_in">max</span>(e.y,<span class="number">0.0</span>)*<span class="number">0.8</span>+<span class="number">0.2</span>)*<span class="number">0.8</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">vec3</span>(<span class="built_in">pow</span>(<span class="number">1.0</span>-e.y,<span class="number">2.0</span>), <span class="number">1.0</span>-e.y, <span class="number">0.6</span>+(<span class="number">1.0</span>-e.y)*<span class="number">0.4</span>) * <span class="number">1.1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// sea</span></span><br><span class="line"><span class="type">float</span> sea_octave(<span class="type">vec2</span> uv, <span class="type">float</span> choppy) &#123;</span><br><span class="line">    uv += noise(uv);        </span><br><span class="line">    <span class="type">vec2</span> wv = <span class="number">1.0</span>-<span class="built_in">abs</span>(<span class="built_in">sin</span>(uv));</span><br><span class="line">    <span class="type">vec2</span> swv = <span class="built_in">abs</span>(<span class="built_in">cos</span>(uv));    </span><br><span class="line">    wv = <span class="built_in">mix</span>(wv,swv,wv);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(<span class="number">1.0</span>-<span class="built_in">pow</span>(wv.x * wv.y,<span class="number">0.65</span>),choppy);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> map(<span class="type">vec3</span> p) &#123;</span><br><span class="line">    <span class="type">float</span> freq = SEA_FREQ;</span><br><span class="line">    <span class="type">float</span> amp = SEA_HEIGHT;</span><br><span class="line">    <span class="type">float</span> choppy = SEA_CHOPPY;</span><br><span class="line">    <span class="type">vec2</span> uv = p.xz; uv.x *= <span class="number">0.75</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="type">float</span> d, h = <span class="number">0.0</span>;    </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; ITER_GEOMETRY; i++) &#123;        </span><br><span class="line">    	d = sea_octave((uv+SEA_TIME)*freq,choppy);</span><br><span class="line">    	d += sea_octave((uv-SEA_TIME)*freq,choppy);</span><br><span class="line">        h += d * amp;        </span><br><span class="line">    	uv *= octave_m; freq *= <span class="number">1.9</span>; amp *= <span class="number">0.22</span>;</span><br><span class="line">        choppy = <span class="built_in">mix</span>(choppy,<span class="number">1.0</span>,<span class="number">0.2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p.y - h;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> map_detailed(<span class="type">vec3</span> p) &#123;</span><br><span class="line">    <span class="type">float</span> freq = SEA_FREQ;</span><br><span class="line">    <span class="type">float</span> amp = SEA_HEIGHT;</span><br><span class="line">    <span class="type">float</span> choppy = SEA_CHOPPY;</span><br><span class="line">    <span class="type">vec2</span> uv = p.xz; uv.x *= <span class="number">0.75</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="type">float</span> d, h = <span class="number">0.0</span>;    </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; ITER_FRAGMENT; i++) &#123;        </span><br><span class="line">    	d = sea_octave((uv+SEA_TIME)*freq,choppy);</span><br><span class="line">    	d += sea_octave((uv-SEA_TIME)*freq,choppy);</span><br><span class="line">        h += d * amp;        </span><br><span class="line">    	uv *= octave_m; freq *= <span class="number">1.9</span>; amp *= <span class="number">0.22</span>;</span><br><span class="line">        choppy = <span class="built_in">mix</span>(choppy,<span class="number">1.0</span>,<span class="number">0.2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p.y - h;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">vec3</span> getSeaColor(<span class="type">vec3</span> p, <span class="type">vec3</span> n, <span class="type">vec3</span> l, <span class="type">vec3</span> eye, <span class="type">vec3</span> dist) &#123;  </span><br><span class="line">    <span class="type">float</span> fresnel = <span class="built_in">clamp</span>(<span class="number">1.0</span> - <span class="built_in">dot</span>(n, -eye), <span class="number">0.0</span>, <span class="number">1.0</span>);</span><br><span class="line">    fresnel = <span class="built_in">min</span>(fresnel * fresnel * fresnel, <span class="number">0.5</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="type">vec3</span> reflected = getSkyColor(<span class="built_in">reflect</span>(eye, n));    </span><br><span class="line">    <span class="type">vec3</span> refracted = SEA_BASE + diffuse(n, l, <span class="number">80.0</span>) * SEA_WATER_COLOR * <span class="number">0.12</span>; </span><br><span class="line">    </span><br><span class="line">    <span class="type">vec3</span> color = <span class="built_in">mix</span>(refracted, reflected, fresnel);</span><br><span class="line">    </span><br><span class="line">    <span class="type">float</span> atten = <span class="built_in">max</span>(<span class="number">1.0</span> - <span class="built_in">dot</span>(dist, dist) * <span class="number">0.001</span>, <span class="number">0.0</span>);</span><br><span class="line">    color += SEA_WATER_COLOR * (p.y - SEA_HEIGHT) * <span class="number">0.18</span> * atten;</span><br><span class="line">    </span><br><span class="line">    color += specular(n, l, eye, <span class="number">60.0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> color;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// tracing</span></span><br><span class="line"><span class="type">vec3</span> getNormal(<span class="type">vec3</span> p, <span class="type">float</span> eps) &#123;</span><br><span class="line">        <span class="comment">// Distance-based eps adjustment</span></span><br><span class="line">    <span class="type">float</span> dist = <span class="built_in">length</span>(p);</span><br><span class="line">    eps = <span class="built_in">mix</span>(eps*<span class="number">0.5</span>, eps*<span class="number">2.0</span>, <span class="built_in">smoothstep</span>(<span class="number">0.0</span>, <span class="number">10.0</span>, dist));</span><br><span class="line">    </span><br><span class="line">    <span class="type">vec3</span> n;</span><br><span class="line">    n.y = map_detailed(p);    </span><br><span class="line">    n.x = map_detailed(<span class="type">vec3</span>(p.x+eps,p.y,p.z)) - n.y;</span><br><span class="line">    n.z = map_detailed(<span class="type">vec3</span>(p.x,p.y,p.z+eps)) - n.y;</span><br><span class="line">    n.y = eps;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Smooth normal</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">normalize</span>(<span class="built_in">mix</span>(n, <span class="type">vec3</span>(<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>), <span class="number">0.1</span> * <span class="built_in">smoothstep</span>(<span class="number">0.0</span>, <span class="number">5.0</span>, dist)));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> heightMapTracing(<span class="type">vec3</span> ori, <span class="type">vec3</span> dir, <span class="keyword">out</span> <span class="type">vec3</span> p) &#123;  </span><br><span class="line">    <span class="type">float</span> tm = <span class="number">0.0</span>;</span><br><span class="line">    <span class="type">float</span> tx = <span class="number">1000.0</span>;    </span><br><span class="line">    <span class="type">float</span> hx = map(ori + dir * tx);</span><br><span class="line">    <span class="keyword">if</span>(hx &gt; <span class="number">0.0</span>) &#123;</span><br><span class="line">        p = ori + dir * tx;</span><br><span class="line">        <span class="keyword">return</span> tx;   </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">float</span> hm = map(ori);    </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; NUM_STEPS; i++) &#123;</span><br><span class="line">        <span class="type">float</span> tmid = <span class="built_in">mix</span>(tm, tx, hm / (hm - hx));</span><br><span class="line">        p = ori + dir * tmid;</span><br><span class="line">        <span class="type">float</span> hmid = map(p);        </span><br><span class="line">        <span class="keyword">if</span>(hmid &lt; <span class="number">0.0</span>) &#123;</span><br><span class="line">            tx = tmid;</span><br><span class="line">            hx = hmid;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            tm = tmid;</span><br><span class="line">            hm = hmid;</span><br><span class="line">        &#125;        </span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">abs</span>(hmid) &lt; EPSILON) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">mix</span>(tm, tx, hm / (hm - hx));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">vec3</span> getPixel(<span class="keyword">in</span> <span class="type">vec2</span> coord, <span class="type">float</span> time) &#123;    </span><br><span class="line">    <span class="type">vec2</span> uv = coord / iResolution.xy;</span><br><span class="line">    uv = uv * <span class="number">2.0</span> - <span class="number">1.0</span>;</span><br><span class="line">    uv.x *= iResolution.x / iResolution.y;    </span><br><span class="line">        </span><br><span class="line">    <span class="comment">// ray</span></span><br><span class="line">    <span class="type">vec3</span> ang = <span class="type">vec3</span>(<span class="built_in">sin</span>(time*<span class="number">3.0</span>)*<span class="number">0.1</span>,<span class="built_in">sin</span>(time)*<span class="number">0.2</span>+<span class="number">0.3</span>,time);    </span><br><span class="line">    <span class="type">vec3</span> ori = <span class="type">vec3</span>(<span class="number">0.0</span>,<span class="number">3.5</span>,time*<span class="number">5.0</span>);</span><br><span class="line">    <span class="type">vec3</span> dir = <span class="built_in">normalize</span>(<span class="type">vec3</span>(uv.xy,<span class="number">-2.0</span>)); dir.z += <span class="built_in">length</span>(uv) * <span class="number">0.14</span>;</span><br><span class="line">    dir = <span class="built_in">normalize</span>(dir) * fromEuler(ang);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// tracing</span></span><br><span class="line">    <span class="type">vec3</span> p;</span><br><span class="line">    heightMapTracing(ori,dir,p);</span><br><span class="line">    <span class="type">vec3</span> dist = p - ori;</span><br><span class="line">    <span class="type">vec3</span> n = getNormal(p, <span class="built_in">dot</span>(dist,dist) * EPSILON_NRM);</span><br><span class="line">    <span class="type">vec3</span> light = <span class="built_in">normalize</span>(<span class="type">vec3</span>(<span class="number">0.0</span>,<span class="number">1.0</span>,<span class="number">0.8</span>)); </span><br><span class="line">             </span><br><span class="line">    <span class="comment">// color</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">mix</span>(</span><br><span class="line">        getSkyColor(dir),</span><br><span class="line">        getSeaColor(p,n,light,dir,dist),</span><br><span class="line">    	<span class="built_in">pow</span>(<span class="built_in">smoothstep</span>(<span class="number">0.0</span>,<span class="number">-0.02</span>,dir.y),<span class="number">0.2</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// main</span></span><br><span class="line"><span class="type">void</span> mainImage( <span class="keyword">out</span> <span class="type">vec4</span> fragColor, <span class="keyword">in</span> <span class="type">vec2</span> fragCoord ) &#123;</span><br><span class="line">    <span class="type">float</span> time = iTime * <span class="number">0.3</span> + iMouse.x*<span class="number">0.01</span>;</span><br><span class="line">	</span><br><span class="line"><span class="meta">#ifdef AA</span></span><br><span class="line">    <span class="type">vec3</span> color = <span class="type">vec3</span>(<span class="number">0.0</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">-1</span>; i &lt;= <span class="number">1</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">-1</span>; j &lt;= <span class="number">1</span>; j++) &#123;</span><br><span class="line">        	<span class="type">vec2</span> uv = fragCoord+<span class="type">vec2</span>(i,j)/<span class="number">3.0</span>;</span><br><span class="line">    		color += getPixel(uv, time);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    color /= <span class="number">9.0</span>;</span><br><span class="line"><span class="meta">#else</span></span><br><span class="line">    <span class="type">vec3</span> color = getPixel(fragCoord, time);</span><br><span class="line"><span class="meta">#endif</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// post</span></span><br><span class="line">	fragColor = <span class="type">vec4</span>(<span class="built_in">pow</span>(color,<span class="type">vec3</span>(<span class="number">0.65</span>)), <span class="number">1.0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="https://s2.loli.net/2025/09/13/vlTKo196wnDypC2.png" alt="shadertoy100" style="width: 30%;">

<h1 id="ShaderToy"><a href="#ShaderToy" class="headerlink" title="ShaderToy"></a>ShaderToy</h1><h2 id="å¸¸ç”¨çš„å…¨å±€å˜é‡"><a href="#å¸¸ç”¨çš„å…¨å±€å˜é‡" class="headerlink" title="å¸¸ç”¨çš„å…¨å±€å˜é‡"></a>å¸¸ç”¨çš„å…¨å±€å˜é‡</h2><img src="https://s2.loli.net/2025/09/13/8dSoxBrp2OcWekl.png" alt="UnrealShaderå­¦ä¹ -2" style="width: 30%;">



<h1 id="âš ï¸è­¦å‘Š"><a href="#âš ï¸è­¦å‘Š" class="headerlink" title="* âš ï¸è­¦å‘Š"></a>* âš ï¸è­¦å‘Š</h1><ol>
<li>å°½å¯èƒ½ä¸è¦åœ¨Shaderä¸­å†™ If é€»è¾‘ä»£ç ï¼Œå› ä¸ºä¸èƒ½<a target="_blank" rel="noopener" href="https://juejin.cn/post/7069209226568007688">å……åˆ†å‘æŒ¥SIMDçš„æ€§èƒ½</a></li>
</ol>
<h1 id="å…¶ä»–ä¸“æœ‰åè¯è§£é‡Š"><a href="#å…¶ä»–ä¸“æœ‰åè¯è§£é‡Š" class="headerlink" title="* å…¶ä»–ä¸“æœ‰åè¯è§£é‡Š"></a>* å…¶ä»–ä¸“æœ‰åè¯è§£é‡Š</h1><ol>
<li><strong>é½æ¬¡åæ ‡</strong>ï¼šç”¨ n + 1 ç»´å‘é‡æ¥è¡¨ç¤º n ç»´å‘é‡ã€‚æ¯”å¦‚åœ¨ 2D ä¸­ï¼Œç‚¹ (x, y) ç”¨ (x, y, w) è¡¨ç¤ºï¼Œw é€šå¸¸ä¸º 1ï¼Œè‹¥ w &#x3D; 0 åˆ™è¡¨ç¤ºæ— ç©·è¿œç‚¹ï¼›åœ¨ 3D é‡Œï¼Œç‚¹ (x, y, z) è¡¨ç¤ºä¸º (x, y, z, w) ã€‚å®ƒèƒ½ç®€åŒ–å›¾å½¢å­¦è®¡ç®—ï¼Œè¿˜å¯è¡¨ç¤ºæ— ç©·è¿œç‚¹ ã€‚</li>
</ol>


            <!-- Tags -->
            


<div class="tags">
    <a href="/tags/Shader/">Shader</a> <a href="/tags/GLSL/">GLSL</a> <a href="/tags/HLSL/">HLSL</a> <a href="/tags/Unreal-Engine/">Unreal Engine</a> <a href="/tags/Graphics-Programming/">Graphics Programming</a> <a href="/tags/Computer-Graphics/">Computer Graphics</a> <a href="/tags/Game-Development-Shader-001/">Game Development Shader 001</a>
</div>



            <!-- Comments -->
            <div>
                




            </div>
        </div><!-- end content -->
    </section>

    <!-- Table of Contents will be generated by toc-collapse.js -->

</section><!-- end main -->

<!-- After footer scripts -->

<!-- jQuery -->

<script src="/js/jquery.js"></script>


<!-- Custom Code -->

<script src="/js/main.js"></script>


<script src="/js/article-collapse.js"></script>


<script src="/js/toc-collapse.js"></script>


<script src="/js/shadertoy-embed.js"></script>


<script src="/js/image-zoom.js"></script>


<!-- Gallery -->
<script src="//cdn.rawgit.com/noelboss/featherlight/1.3.5/release/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Code Block Expansion Script -->
<script type="text/javascript">
document.addEventListener('DOMContentLoaded', function() {
    // Initialize code block expansion
    function initCodeBlockExpansion() {
        const codeBlocks = document.querySelectorAll('figure.highlight');
        
        codeBlocks.forEach(function(codeBlock) {
            // Skip if already processed
            if (codeBlock.closest('.code-block-container')) return;
            
            // Remove table structure and keep only code content
            const table = codeBlock.querySelector('table');
            if (table) {
                const codeCell = table.querySelector('td.code');
                if (codeCell) {
                    // Create a new pre element with code content
                    const newPre = document.createElement('pre');
                    newPre.className = 'code';
                    newPre.innerHTML = codeCell.innerHTML;
                    
                    // Replace table with pre element
                    codeBlock.innerHTML = '';
                    codeBlock.appendChild(newPre);
                }
            }
            
            // Get the code content height
            const codeContent = codeBlock.querySelector('pre.code');
            if (!codeContent) return;
            
            const actualHeight = codeContent.scrollHeight;
            const maxHeight = 400; // Same as CSS max-height
            
            // Only add expansion if content is taller than max height
            if (actualHeight > maxHeight) {
                // Wrap the code block in a container
                const container = document.createElement('div');
                container.className = 'code-block-container collapsed';
                codeBlock.parentNode.insertBefore(container, codeBlock);
                container.appendChild(codeBlock);
                
                // Create expand button
                const expandButton = document.createElement('button');
                expandButton.className = 'expand-button';
                expandButton.textContent = 'å±•å¼€ä»£ç ';
                container.appendChild(expandButton);
                
                // Add click handler
                expandButton.addEventListener('click', function() {
                    if (container.classList.contains('collapsed')) {
                        // Expand to full screen
                        showFullscreenCode(codeBlock, expandButton);
                    }
                });
            }
        });
    }
    
    function showFullscreenCode(codeBlock, button) {
        // Create fullscreen modal
        const modal = document.createElement('div');
        modal.className = 'code-fullscreen-modal active';
        
        const content = document.createElement('div');
        content.className = 'code-fullscreen-content';
        
        // Clone the code block and remove any expansion restrictions
        const clonedBlock = codeBlock.cloneNode(true);
        
        // Remove any size restrictions from cloned block
        clonedBlock.style.maxHeight = 'none';
        clonedBlock.style.overflow = 'visible';
        
        // Find and update the pre.code element in cloned block
        const clonedPre = clonedBlock.querySelector('pre.code');
        if (clonedPre) {
            clonedPre.style.maxHeight = 'none';
            clonedPre.style.height = '100%';
            clonedPre.style.overflowY = 'scroll';
            clonedPre.style.overflowX = 'auto';
            clonedPre.style.minHeight = '0';
            // ç¡®ä¿å†…å®¹å®Œå…¨å¯è§
            clonedPre.scrollTop = 0;
        }
        
        content.appendChild(clonedBlock);
        
        // Create close button
        const closeButton = document.createElement('button');
        closeButton.className = 'close-fullscreen';
        closeButton.textContent = 'å…³é—­';
        content.appendChild(closeButton);
        
        modal.appendChild(content);
        document.body.appendChild(modal);
        
        // Prevent body scrolling
        document.body.style.overflow = 'hidden';
        
        // Close handlers
        function closeModal() {
            document.body.removeChild(modal);
            document.body.style.overflow = '';
        }
        
        closeButton.addEventListener('click', closeModal);
        
        // Close on backdrop click
        modal.addEventListener('click', function(e) {
            if (e.target === modal) {
                closeModal();
            }
        });
        
        // Close on escape key
        function handleKeydown(e) {
            if (e.key === 'Escape') {
                closeModal();
                document.removeEventListener('keydown', handleKeydown);
            }
        }
        document.addEventListener('keydown', handleKeydown);
    }
    
    // Initialize on page load
    initCodeBlockExpansion();
    
    // Re-initialize if new content is loaded (for SPA-like behavior)
    const observer = new MutationObserver(function(mutations) {
        let needsReinit = false;
        mutations.forEach(function(mutation) {
            if (mutation.addedNodes.length > 0) {
                mutation.addedNodes.forEach(function(node) {
                    if (node.nodeType === 1 && (node.matches('figure.highlight') || node.querySelector('figure.highlight'))) {
                        needsReinit = true;
                    }
                });
            }
        });
        if (needsReinit) {
            setTimeout(initCodeBlockExpansion, 100);
        }
    });
    
    observer.observe(document.body, {
        childList: true,
        subtree: true
    });
});
</script>

<!-- Mermaid Initialization -->
<script type="text/javascript">
    // Wait for document ready
    document.addEventListener('DOMContentLoaded', function() {
        if (typeof mermaid !== 'undefined') {
            // Initialize with proper configuration
            mermaid.initialize({ 
                startOnLoad: false,
                theme: 'default',
                securityLevel: 'loose'
            });
            
            // Find and process mermaid code blocks
            const codeBlocks = document.querySelectorAll('figure.highlight.plaintext .code');
            
            codeBlocks.forEach((codeElement, index) => {
                let code = codeElement.textContent || codeElement.innerText;
                
                // Check if it's a mermaid diagram
                if (code.trim().match(/^(graph|flowchart|sequenceDiagram|classDiagram|stateDiagram|journey|pie|gitgraph|erDiagram)/)) {
                    // Critical fix: Remove ALL leading/trailing whitespace and newlines
                    code = code.trim().replace(/^\s+|\s+$/g, '');
                    
                    // Create mermaid div
                    const mermaidDiv = document.createElement('div');
                    mermaidDiv.className = 'mermaid';
                    // Set the cleaned code without any extra whitespace
                    mermaidDiv.textContent = code;
                    mermaidDiv.id = 'mermaid-diagram-' + index;
                    
                    // Replace the entire figure element
                    const figureElement = codeElement.closest('figure');
                    if (figureElement) {
                        figureElement.parentNode.replaceChild(mermaidDiv, figureElement);
                    }
                }
            });
            
            // Initialize mermaid diagrams with explicit selector
            setTimeout(() => {
                mermaid.init(undefined, document.querySelectorAll('.mermaid'));
            }, 100);
        }
    });
</script>

<!-- ShaderToy Placeholder Processing -->
<script type="text/javascript">
document.addEventListener('DOMContentLoaded', function() {
    // Wait a bit for other scripts to load
    setTimeout(function() {
        // Find all elements with shadertoy-placeholder class
        const elements = document.querySelectorAll('.shadertoy-placeholder[data-id]');
        
        console.log('Found shadertoy-placeholder elements:', elements.length);

        elements.forEach(element => {
            const shaderID = element.getAttribute('data-id');
            console.log('Processing shadertoy-placeholder element with ID:', shaderID);
            
            if (shaderID) {
                // Create iframe container
                const container = document.createElement('div');
                container.style.cssText = `
                    position: relative;
                    width: 100%;
                    height: 400px;
                    margin: 20px 0;
                    border: 2px solid #bfbbbb;
                    border-radius: 8px;
                    overflow: hidden;
                    background-color: #f6f6f6;
                `;

                // Create iframe
                const iframe = document.createElement('iframe');
                iframe.src = `https://www.shadertoy.com/embed/${shaderID}?gui=true&t=10&paused=false&muted=false`;
                iframe.style.cssText = `
                    position: absolute;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    border: none;
                `;
                iframe.allowFullscreen = true;
                iframe.loading = 'lazy';

                container.appendChild(iframe);
                element.parentNode.insertBefore(container, element);
                element.parentNode.removeChild(element);
            }
        });
    }, 1000); // Wait a full second for everything to load
});
</script>

<!-- Disqus Comments -->


</body>

</html>