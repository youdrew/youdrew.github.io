<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Eugene&#39;s Page</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2025-12-02T05:44:10.383Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>Eugene Hsuan</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title></title>
    <link href="http://example.com/2025/11/24/CodeReview/"/>
    <id>http://example.com/2025/11/24/CodeReview/</id>
    <published>2025-11-24T10:04:38.046Z</published>
    <updated>2025-12-02T05:44:10.383Z</updated>
    
    <content type="html"><![CDATA[<p>è“å›¾ä»£ç è´¨é‡æ£€æµ‹</p><table><thead><tr><th>å·¥å…·ç±»å‹</th><th>ä»£è¡¨å·¥å…· &#x2F; æ–¹æ¡ˆ</th><th>æ ¸å¿ƒèƒ½åŠ›</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>UE å®˜æ–¹å†…ç½®å·¥å…·</td><td>Blueprint Analyzerï¼ˆUE4.26+ï¼‰</td><td>ç»Ÿè®¡è“å›¾åœˆå¤æ‚åº¦ã€èŠ‚ç‚¹æ•°é‡ã€åˆ†æ”¯æ·±åº¦ï¼Œæ£€æµ‹å†—ä½™èŠ‚ç‚¹ &#x2F; æ— æ•ˆè¿çº¿ï¼Œæ”¯æŒå¯¼å‡ºåˆ†ææŠ¥å‘Š</td><td>åŸºç¡€å¤æ‚åº¦æ£€æµ‹ï¼Œæ— éœ€é¢å¤–å®‰è£…</td></tr><tr><td>UE ç¤¾åŒºå¼€æºå·¥å…·</td><td>Blueprint Metricsï¼ˆGitHubï¼‰</td><td>ä¸“é—¨é’ˆå¯¹ UE4&#x2F;5 çš„è“å›¾åœˆå¤æ‚åº¦è®¡ç®—å·¥å…·ï¼Œå¯è‡ªå®šä¹‰é˜ˆå€¼ã€ç”Ÿæˆå¯è§†åŒ–æŠ¥è¡¨ï¼Œæ”¯æŒæ‰¹é‡æ‰«æ</td><td>ä¸­å°å‹å›¢é˜Ÿï¼Œå¯äºŒæ¬¡å¼€å‘é›†æˆ CR æµç¨‹</td></tr><tr><td>UE æ’ä»¶å¸‚åœºå·¥å…·</td><td><a href="https://www.fab.com/zh-cn/listings/10850cb2-be1d-43d2-971d-922c73d218f3">Linter</a> &#x2F; UE Blueprint Quality Checker</td><td>Linterèƒ½å®ç°ä»£ç è§„åˆ™æ£€æµ‹<br /><br />é…ç½®åœˆå¤æ‚åº¦ &#x2F; ä»£ç è§„èŒƒé˜ˆå€¼ï¼Œæäº¤è“å›¾å‰è‡ªåŠ¨æ£€æµ‹ï¼Œè¿è§„åˆ™æ‹¦æˆª</td><td>å¿«é€Ÿé›†æˆåˆ° UE ç¼–è¾‘å™¨å·¥ä½œæµ</td></tr><tr><td>ä¼ä¸šçº§å·¥ä¸šåŒ–å·¥å…·é“¾</td><td>Epic Industrial Framework &#x2F; Autodesk ShotGrid + UE é›†æˆ</td><td>å†…ç½®è“å›¾ CR æµç¨‹ï¼Œç»“åˆåœˆå¤æ‚åº¦ã€æ€§èƒ½ã€åˆè§„æ€§æ£€æµ‹ï¼Œé€‚é…å¤§å‹å›¢é˜Ÿåä½œ</td><td>3A æ¸¸æˆã€å¤§å‹å•†ç”¨ UE é¡¹ç›®</td></tr><tr><td>é€šç”¨ä»£ç è´¨é‡å·¥å…·é€‚é…</td><td>SonarQube + ç¤¾åŒºè“å›¾è½¬è¯‘æ’ä»¶</td><td>å°†è“å›¾è½¬è¯‘ä¸ºæŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰ï¼Œå¤ç”¨ SonarQube çš„åœˆå¤æ‚åº¦åˆ†æå’Œ CR æµç¨‹</td><td>å·²æœ‰ SonarQube è´¨é‡ä½“ç³»çš„å›¢é˜Ÿ</td></tr><tr><td>è‡ªå®šä¹‰è„šæœ¬ &#x2F; å·¥å…·</td><td>åŸºäº UE çš„ Editor Utility Widgetï¼ˆEUWï¼‰å¼€å‘</td><td>æŒ‰éœ€å®šåˆ¶åœˆå¤æ‚åº¦è®¡ç®—è§„åˆ™ã€CR å®¡æ‰¹æµç¨‹ï¼Œé€‚é…å›¢é˜Ÿä¸ªæ€§åŒ–éœ€æ±‚</td><td>æœ‰ UE äºŒæ¬¡å¼€å‘èƒ½åŠ›çš„å›¢é˜Ÿ</td></tr></tbody></table><p><a href="https://www.fab.com/zh-cn/listings/14d7ba87-a587-406d-9369-ed75fa0a55ed">è“å›¾åŠ©æ‰‹</a>:ä¸€ä¸ªå¾ˆä¸é”™çš„ä»£ç æ•´ç†å·¥å…·ï¼Œ<a href="https://www.youtube.com/watch?v=MQ70ASNunPQ">æ¼”ç¤ºè§†é¢‘</a></p><p><a href="https://codepen.io/dhvoksdw-the-encoder/pen/EaKbeVe">https://codepen.io/dhvoksdw-the-encoder/pen/EaKbeVe</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è“å›¾ä»£ç è´¨é‡æ£€æµ‹&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å·¥å…·ç±»å‹&lt;/th&gt;
&lt;th&gt;ä»£è¡¨å·¥å…· &amp;#x2F; æ–¹æ¡ˆ&lt;/th&gt;
&lt;th&gt;æ ¸å¿ƒèƒ½åŠ›&lt;/th&gt;
&lt;th&gt;é€‚ç”¨åœºæ™¯&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;&lt;tr&gt;
&lt;td&gt;UE å®˜æ–¹å†…</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://example.com/2025/11/24/Capturymarkerless/"/>
    <id>http://example.com/2025/11/24/Capturymarkerless/</id>
    <published>2025-11-24T03:53:22.393Z</published>
    <updated>2025-12-02T04:12:55.621Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ— æ ‡è®°åŠ¨ä½œæ•æ‰ä½¿ç”¨åŠæ’ä»¶æ¥å…¥"><a href="#æ— æ ‡è®°åŠ¨ä½œæ•æ‰ä½¿ç”¨åŠæ’ä»¶æ¥å…¥" class="headerlink" title="æ— æ ‡è®°åŠ¨ä½œæ•æ‰ä½¿ç”¨åŠæ’ä»¶æ¥å…¥"></a>æ— æ ‡è®°åŠ¨ä½œæ•æ‰ä½¿ç”¨åŠæ’ä»¶æ¥å…¥</h1><p><a href="https://www.fab.com/listings/69ee923d-1a3a-42be-8f2a-9924b6e7b79a">CapturyLiveLink</a>_5.2</p><p><a href="http://doc.captury.com/python.html">APIæ–‡æ¡£</a></p><p><a href="http://doc.captury.com/CapturyLive/index.html#overview">å®˜æ–¹æ•™ç¨‹</a></p><p>172.26.7.51</p><p>Blueprint Runtime Error: â€œAttempted to access index -1 from array ARkit Value of length 0!â€. Node:  Set ARkit Head Rotation Graph:  EventGraph Function:  Execute Ubergraph ABP Main Last ZTY Body Blueprint:  ABP_Main_LastZTY_Body<br>Blueprint Runtime Error: â€œAttempted to access index -1 from array ARkit Value of length 0!â€. Node:  Set ARkit Head Rotation Graph:  EventGraph Function:  Execute Ubergraph ABP Main Last ZTY Body Blueprint:  ABP_Main_LastZTY_Body<br>Blueprint Runtime Error: â€œAttempted to access index -1 from array ARkit Value of length 0!â€. Node:  Set ARkit Head Rotation Graph:  EventGraph Function:  Execute Ubergraph ABP Main Last ZTY Body Blueprint:  ABP_Main_LastZTY_Body<br>Blueprint Runtime Error: â€œAttempted to access index -1 from array ARkit Value of length 0!â€. Node:  Set headRoll Graph:  EventGraph Function:  Execute Ubergraph ABP Main Last ZTY Body Blueprint:  ABP_Main_LastZTY_Body</p><p>æˆ‘çš„Livelinkäººç‰©åŠ¨æ•æ•°æ®æ¥å…¥ä¹‹åï¼Œäººç‰©æ²¡æœ‰ååº”ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æ— æ ‡è®°åŠ¨ä½œæ•æ‰ä½¿ç”¨åŠæ’ä»¶æ¥å…¥&quot;&gt;&lt;a href=&quot;#æ— æ ‡è®°åŠ¨ä½œæ•æ‰ä½¿ç”¨åŠæ’ä»¶æ¥å…¥&quot; class=&quot;headerlink&quot; title=&quot;æ— æ ‡è®°åŠ¨ä½œæ•æ‰ä½¿ç”¨åŠæ’ä»¶æ¥å…¥&quot;&gt;&lt;/a&gt;æ— æ ‡è®°åŠ¨ä½œæ•æ‰ä½¿ç”¨åŠæ’ä»¶æ¥å…¥&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https://www.f</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Unreal RemoteControl Note</title>
    <link href="http://example.com/2025/11/21/Unreal%20RemoteControl%20Note/"/>
    <id>http://example.com/2025/11/21/Unreal%20RemoteControl%20Note/</id>
    <published>2025-11-21T03:21:56.000Z</published>
    <updated>2025-11-21T09:58:16.133Z</updated>
    
    <content type="html"><![CDATA[<h1 id="è™šå¹»5è¿œç¨‹æ§åˆ¶ï¼ˆRemoteControlï¼‰ç¬”è®°"><a href="#è™šå¹»5è¿œç¨‹æ§åˆ¶ï¼ˆRemoteControlï¼‰ç¬”è®°" class="headerlink" title="è™šå¹»5è¿œç¨‹æ§åˆ¶ï¼ˆRemoteControlï¼‰ç¬”è®°"></a>è™šå¹»5è¿œç¨‹æ§åˆ¶ï¼ˆRemoteControlï¼‰ç¬”è®°</h1><h2 id="åŸºç¡€ä»‹ç»"><a href="#åŸºç¡€ä»‹ç»" class="headerlink" title="åŸºç¡€ä»‹ç»"></a>åŸºç¡€ä»‹ç»</h2><h3 id="ä»€ä¹ˆæ˜¯ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ï¼Ÿ</h3><table><thead><tr><th><code>WebControl.StartServer</code></th><th>å¯åŠ¨ç½‘é¡µæœåŠ¡å™¨å¹¶å¼€å§‹åœ¨ç«¯å£ <code>30010</code> ä¸Šè†å¬ä¼ å…¥è¯·æ±‚ã€‚</th></tr></thead><tbody><tr><td><code>WebControl.StopServer</code></td><td>åœæ­¢ç½‘é¡µæœåŠ¡å™¨ï¼Œç¦æ­¢å†å¤„ç†ä»»ä½•å¯¹è™šå¹»ç¼–è¾‘å™¨å®ä¾‹çš„è¯·æ±‚ã€‚</td></tr><tr><td><code>WebControl.EnableServerOnStartup</code></td><td>æ¯å½“æ­¤é¡¹ç›®åœ¨è™šå¹»å¼•æ“ä¸­ä»¥ä»»ä½•æ”¯æŒçš„æ¨¡å¼æ‰“å¼€ï¼ˆåœ¨è™šå¹»ç¼–è¾‘å™¨ä¸»çª—å£ä¸­ã€åœ¨ç¼–è¾‘å™¨ä¸­è¿è¡Œï¼ˆPIEï¼‰ä¼šè¯ä¸­ã€æˆ–åœ¨è™šå¹»ç¼–è¾‘å™¨çš„ <code>-æ¸¸æˆ</code> æ¨¡å¼ä¸‹ï¼‰æ—¶ï¼Œä¾¿è‡ªåŠ¨å¯åŠ¨WebæœåŠ¡å™¨ã€‚</td></tr></tbody></table><p>å¦‚æœè¦åœ¨æ‰“åŒ…åä½¿ç”¨ï¼Œéœ€è¦æŠŠé¢„è®¾æ‹–åˆ°åœºæ™¯ä¸­ã€‚å…³äºæ‰“åŒ…åä½¿ç”¨å¯ä»¥å‚è€ƒè¿™ä¸ª<a href="https://www.bilibili.com/video/BV1G84y167Vs/">è§†é¢‘</a></p><p><img src="https://s2.loli.net/2025/11/21/q9QmgrIvkUp3Y2M.png" alt="image-20251121150628085"></p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul><li>UnrealFest2022ä»‹ç»RemoteControlå¸¦ä¸­æ–‡çš„<a href="https://www.bilibili.com/video/BV1Cv4y1L7gH/?spm_id_from=333.337.search-card.all.click&vd_source=60b376a57ab956cf81ad81ef20747a92">æ¬è¿è§†é¢‘</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;è™šå¹»5è¿œç¨‹æ§åˆ¶ï¼ˆRemoteControlï¼‰ç¬”è®°&quot;&gt;&lt;a href=&quot;#è™šå¹»5è¿œç¨‹æ§åˆ¶ï¼ˆRemoteControlï¼‰ç¬”è®°&quot; class=&quot;headerlink&quot; title=&quot;è™šå¹»5è¿œç¨‹æ§åˆ¶ï¼ˆRemoteControlï¼‰ç¬”è®°&quot;&gt;&lt;/a&gt;è™šå¹»5è¿œç¨‹æ§åˆ¶ï¼ˆRemote</summary>
      
    
    
    
    
    <category term="Unreal Engine" scheme="http://example.com/tags/Unreal-Engine/"/>
    
    <category term="Game Development" scheme="http://example.com/tags/Game-Development/"/>
    
  </entry>
  
  <entry>
    <title>UE5 GAS Learning Notes</title>
    <link href="http://example.com/2025/09/21/UE5%20GAS%20Learning%20Notes/"/>
    <id>http://example.com/2025/09/21/UE5%20GAS%20Learning%20Notes/</id>
    <published>2025-09-21T04:34:56.000Z</published>
    <updated>2025-11-21T10:12:06.126Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Unreal-GASç³»ç»Ÿä½¿ç”¨å­¦ä¹ "><a href="#Unreal-GASç³»ç»Ÿä½¿ç”¨å­¦ä¹ " class="headerlink" title="Unreal GASç³»ç»Ÿä½¿ç”¨å­¦ä¹ "></a>Unreal GASç³»ç»Ÿä½¿ç”¨å­¦ä¹ </h1><h2 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h2><p><a href="https://www.bilibili.com/video/BV1ud4y1y7a8/">UEç½‘ç»œæ¶æ„</a></p><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>Gameplay Ability Systemï¼Œç®€ç§°(GAS)æ˜¯ä¸€ä¸ªå¥å£®çš„ã€é«˜åº¦å¯æ‰©å±•çš„ã€gameplayæ¡†æ¶,é€šå¸¸ç”¨äºæ„å»ºRPGã€MOBAç­‰æ¸¸æˆçš„å®Œæ•´æˆ˜æ–—é€»è¾‘æ¡†æ¶ã€‚é€šè¿‡GAS,å¯ä»¥å¿«é€Ÿåœ°åˆ¶ä½œæ¸¸æˆä¸­çš„ä¸»åŠ¨&#x2F;è¢«åŠ¨æŠ€èƒ½ã€å„ç§æ•ˆæœbuffã€è®¡ç®—å±æ€§ä¼¤å®³ã€å¤„ç†ç©å®¶å„ç§æˆ˜æ–—çŠ¶æ€é€»è¾‘ã€‚</p><p>GASè¯•å›¾<u>å°†æœºåˆ¶æå–ä¸ºé€šç”¨çš„æ¸¸æˆè®¾è®¡æ¨¡å¼</u>ï¼Œå¹¶æä¾›æ¡†æ¶æ¥è§£å†³å¸¸è§çš„Gameplayå®ç°é—®é¢˜ï¼ŒåŒæ—¶ä½¿ä¸Šä¸‹æ–‡å› é¡¹ç›®è€Œå¼‚ã€‚</p><h3 id="GASæä¾›äº†å“ªäº›åŠŸèƒ½"><a href="#GASæä¾›äº†å“ªäº›åŠŸèƒ½" class="headerlink" title="GASæä¾›äº†å“ªäº›åŠŸèƒ½?"></a>GASæä¾›äº†å“ªäº›åŠŸèƒ½?</h3><ol><li>å®ç°äº†å¸¦æœ‰æ¶ˆè€—å’Œå†·å´åŠŸèƒ½çš„è§’è‰²æŠ€èƒ½</li><li>å¤„ç†æ•°å€¼å±æ€§(ç”Ÿå‘½ã€é­”æ³•ã€æ”»å‡»åŠ›ã€é˜²å¾¡åŠ›)</li><li>åº”ç”¨çŠ¶æ€æ•ˆæœ(å‡»é£ã€ç€ç«ã€çœ©æ™•)</li><li>åº”ç”¨æ¸¸æˆæ ‡ç­¾(GameplayTags)</li><li>ç”Ÿæˆç‰¹æ•ˆå’ŒéŸ³æ•ˆ</li><li>å®Œæ•´çš„ç½‘ç»œå¤åˆ¶ã€é¢„æµ‹åŠŸèƒ½</li></ol><h3 id="é€‚åˆä½¿ç”¨GASçš„é¡¹ç›®"><a href="#é€‚åˆä½¿ç”¨GASçš„é¡¹ç›®" class="headerlink" title="é€‚åˆä½¿ç”¨GASçš„é¡¹ç›®"></a>é€‚åˆä½¿ç”¨GASçš„é¡¹ç›®</h3><ol><li><p>C++é¡¹ç›®,å¼€å‘äººå‘˜æœ‰å……è¶³çš„C++å¼€å‘ç»éªŒ</p></li><li><p>ä½¿ç”¨Dedicated Serverä¸“ç”¨æœåŠ¡å™¨çš„è”æœºæ¸¸æˆï¼ˆå•çº¯çš„æ¸¸æˆé€»è¾‘æœåŠ¡ç«¯ï¼Œä¸Dedicated Serverç›¸å¯¹çš„æ˜¯Listen Serverï¼Œå…¶ä¸­ä¸€ä½ç©å®¶å……å½“æœåŠ¡å™¨ï¼Œå®¹æ˜“å‡ºç°â€œä¸»æœºä¼˜åŠ¿â€ï¼‰</p></li><li><p>é¡¹ç›®æœ‰å¤§é‡ä¸”å¤æ‚çš„æŠ€èƒ½é€»è¾‘è®¾è®¡éœ€æ±‚</p></li></ol><h3 id="GASçš„ä¸»è¦ä¼˜åŠ¿"><a href="#GASçš„ä¸»è¦ä¼˜åŠ¿" class="headerlink" title="GASçš„ä¸»è¦ä¼˜åŠ¿"></a>GASçš„ä¸»è¦ä¼˜åŠ¿</h3><ul><li><strong>ç½‘ç»œå¤åˆ¶ï¼ˆNetwork Replicationï¼‰ï¼š</strong> ä¸å¿…æ‹…å¿ƒä½ çš„å±æ€§æˆ–å‡ç›Šæ•ˆæœå¾—ä¸åˆ°å¦¥å–„åœ°åº”ç”¨æˆ–å¤åˆ¶ã€‚GASä¼šä¸ºä½ å¤„ç†å†…éƒ¨é€»è¾‘ã€‚</li><li><strong>æ¨¡å—åŒ–ï¼ˆModularityï¼‰ï¼š</strong> æ·»åŠ æˆ–æ›´æ”¹æ¸¸æˆæœºåˆ¶é€šå¸¸ä¸å®ç°å’Œèµ‹äºˆæ–°æŠ€èƒ½ä¸€æ ·ç®€å•ã€‚é€šè¿‡å°†GameplayåŠŸèƒ½åˆ†è§£ä¸ºå•ç‹¬çš„èµ„äº§ï¼ŒæŠ€èƒ½ç³»ç»Ÿå¯ä»¥åœ¨å®Œå…¨ä¸åŒçš„æ¸¸æˆå¯¹è±¡æˆ–æœºåˆ¶ä¹‹é—´æä¾›é€šç”¨çš„é€šä¿¡å±‚ã€‚ä¾‹å¦‚ï¼Œç”Ÿå‘½å€¼ï¼ˆHealthï¼‰å¯ä»¥åˆ’åˆ†åˆ°è‡ªå·±çš„å±æ€§é›†ï¼Œå¹¶é€šè¿‡æ¥è‡ªå„ç§ç³»ç»Ÿçš„Gameplayæ•ˆæœè¿›è¡Œäº¤äº’ã€‚</li><li><strong>å¿«é€Ÿè¿­ä»£ï¼ˆFast iterationï¼‰ï¼š</strong> GASå¯ä»¥è½»æ¾æ›´æ”¹å•ä¸ªæ¸¸æˆè§„åˆ™ï¼Œè€Œæ— éœ€ä¿®æ”¹æ•´ä¸ªç³»ç»Ÿã€‚ç”¨äºè®¡ç®—æ¸¸æˆçš„æ•°æ®æºå¯ä»¥è½»æ¾äº¤æ¢ï¼Œå¹¶ä¸”å¯ä»¥ä»ç›¸åº”çš„Gameplayæ•ˆæœä¸­ä¿®æ”¹åŠ¨ä½œæ•ˆæœã€‚</li></ul><h3 id="æˆ‘ä¸ºä»€ä¹ˆå­¦ä¹ GAS"><a href="#æˆ‘ä¸ºä»€ä¹ˆå­¦ä¹ GAS" class="headerlink" title="æˆ‘ä¸ºä»€ä¹ˆå­¦ä¹ GAS"></a>æˆ‘ä¸ºä»€ä¹ˆå­¦ä¹ GAS</h3><p>ç¼–å†™æ ·æ¿ä»£ç é€šå¸¸æ˜“å‡ºé”™ä¸”è€—æ—¶ï¼Œå°¤å…¶æ˜¯å¯¹äºå¤šäººæ¸¸æˆè€Œè¨€ã€‚ä¾‹å¦‚ï¼Œä½ ä¸å¸Œæœ›èŠ±è´¹å¤§é‡æ—¶é—´æ¥ç¡®ä¿ä½ çš„ç”Ÿå‘½ï¼ˆHealthï¼‰å€¼æ­£ç¡®å¤åˆ¶ï¼Œæˆ–è€…åœ¨ä½ å†³å®šå…·æœ‰ç›¸åŒè¡Œä¸ºçš„èƒ½é‡ï¼ˆEnergyï¼‰å€¼æ—¶ï¼Œå¤åˆ¶ç›¸åŒçš„ä»£ç è¡Œã€‚</p><p>GASé€šè¿‡æä¾›å°½å¯èƒ½å®ç°å¸¸è§GameplayåŠŸèƒ½çš„åŸºç¡€æ¥è§£å†³è¿™äº›é—®é¢˜ï¼ŒåŒæ—¶ä¿æŒæœºåˆ¶ä¸­ç«‹ã€‚GASå¹¶éå¼ºåˆ¶ä½¿ç”¨è¯¸å¦‚ç”Ÿå‘½å€¼ï¼ˆHealthï¼‰ã€å¼¹è¯ï¼ˆAmmoï¼‰ã€è¿‘æˆ˜æ”»å‡»ï¼ˆMelee Attackï¼‰æˆ–æ¯’è¯å‡ç›Šï¼ˆPoison Debuffï¼‰ä¹‹ç±»çš„æ¦‚å¿µï¼Œè€Œæ˜¯æä¾›äº†èƒ½å¤Ÿå®šä¹‰ã€å¤åˆ¶å’Œä½¿ç”¨ <strong>å±æ€§ï¼ˆAttributesï¼‰</strong> ã€ <strong>æŠ€èƒ½ï¼ˆAbilitiesï¼‰</strong> å’Œ <strong>æ•ˆæœï¼ˆEffectsï¼‰</strong> çš„å·¥å…·ï¼Œç„¶åä½ å¯ä»¥å°†è¿™äº›å·¥å…·ä¸“ç”¨äºæ»¡è¶³ç»™å®šGameplayæœºåˆ¶çš„éœ€æ±‚ã€‚</p><p><u>äºæˆ‘è€Œè¨€</u>ï¼šå…¬å¸çš„é¡¹ç›®éœ€è¦ä½¿ç”¨åˆ°è”ç½‘çš„æ¸¸æˆæœåŠ¡ã€‚æ‰€ä»¥ä½ ä¼šåœ¨æˆ‘çš„ç¬”è®°ä¸­çœ‹åˆ°ä¸€äº›æ–œä½“çš„å¤‡æ³¨ï¼Œè¿™äº›å¤‡æ³¨æ„å‘³ç€å¯¹æˆ‘è‡ªå·±é¡¹ç›®çš„å¤‡æ³¨ã€‚å¯ä»¥å¿½ç•¥ã€‚</p><h2 id="GASçš„ç»„ä»¶"><a href="#GASçš„ç»„ä»¶" class="headerlink" title="GASçš„ç»„ä»¶"></a>GASçš„ç»„ä»¶</h2><h3 id="ASCï¼šwhoè°èƒ½æ”¾æŠ€èƒ½ï¼Ÿ"><a href="#ASCï¼šwhoè°èƒ½æ”¾æŠ€èƒ½ï¼Ÿ" class="headerlink" title="ASCï¼šwhoè°èƒ½æ”¾æŠ€èƒ½ï¼Ÿ"></a>ASCï¼šwhoè°èƒ½æ”¾æŠ€èƒ½ï¼Ÿ</h3><p>Ability System Componentï¼ˆASCï¼‰æ˜¯æ•´ä¸ª GAS çš„åŸºç¡€ç»„ä»¶ã€‚ASC æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª UActorComponentï¼Œç”¨äºå¤„ç†æ•´ä¸ªæ¡†æ¶ä¸‹çš„äº¤äº’é€»è¾‘ï¼ŒåŒ…æ‹¬ä½¿ç”¨æŠ€èƒ½ï¼ˆGameplayAbilityï¼‰ã€åŒ…å«å±æ€§ï¼ˆAttributeSetï¼‰ã€å¤„ç†å„ç§æ•ˆæœï¼ˆGameplayEffectï¼‰ã€‚æ‰€æœ‰éœ€è¦åº”ç”¨ GAS çš„å¯¹è±¡ï¼ˆActorï¼‰ï¼Œéƒ½å¿…é¡»æ‹¥æœ‰ GAS ç»„ä»¶ã€‚ï¼ˆå³æ‰€æœ‰æœ‰æŠ€èƒ½äº¤äº’çš„è§’è‰²éƒ½æ˜¯ASCï¼‰ã€‚</p><ul><li>ASCæ˜¯ä¸€ç§è§’è‰²ç»„ä»¶ï¼Œè´Ÿè´£å’ŒGAã€GEã€ASæ‰“äº¤é“ã€‚</li><li>ä¸€èˆ¬åªæ”¾åœ¨Character or PlayerStateä¸Šã€‚</li><li>æ‹¥æœ‰ ASC çš„ Actor è¢«ç§°ä¸º ASC çš„ OwnerActorï¼ŒASC å®é™…ä½œç”¨çš„ Actor å«åš AvatarActorã€‚</li></ul><h3 id="GAï¼šHow-æŠ€èƒ½çš„é€»è¾‘ï¼Ÿ"><a href="#GAï¼šHow-æŠ€èƒ½çš„é€»è¾‘ï¼Ÿ" class="headerlink" title="GAï¼šHow:æŠ€èƒ½çš„é€»è¾‘ï¼Ÿ"></a><strong>GA</strong>ï¼šHow:æŠ€èƒ½çš„é€»è¾‘ï¼Ÿ</h3><p>Gameplay Abilityï¼ˆGAï¼‰<u>æ ‡è¯†äº†æ¸¸æˆä¸­ä¸€ä¸ªå¯¹è±¡ï¼ˆActorï¼‰å¯ä»¥åšçš„è¡Œä¸ºæˆ–æŠ€èƒ½</u>ã€‚å®ƒä»£è¡¨è§’è‰²å¯ä»¥æ‰§è¡Œçš„ä»»ä½•æŠ€èƒ½æˆ–è¡Œä¸ºã€‚<br>èƒ½åŠ›ï¼ˆAbilityï¼‰å¯ä»¥æ˜¯æ™®é€šæ”»å‡»æˆ–è€…åŸå”±æŠ€èƒ½ï¼Œå¯ä»¥æ˜¯è§’è‰²è¢«å‡»é£å€’åœ°ï¼Œè¿˜å¯ä»¥æ˜¯ä½¿ç”¨æŸç§é“å…·ï¼Œäº¤äº’æŸä¸ªç‰©ä»¶ï¼Œç”šè‡³è·³è·ƒã€é£è¡Œç­‰è§’è‰²è¡Œä¸ºä¹Ÿå¯ä»¥æ˜¯Abilityã€‚<br>Abilityå¯ä»¥è¢«èµ‹äºˆå¯¹è±¡æˆ–ä»å¯¹è±¡çš„ASCä¸­ç§»é™¤ï¼Œå¯¹è±¡åŒæ—¶å¯ä»¥æ¿€æ´»å¤šä¸ªGameplayAbilityã€‚</p><ul><li>åŸºæœ¬çš„ç§»åŠ¨è¾“å…¥ã€UIäº¤äº’è¡Œä¸ºåˆ™ä¸èƒ½æˆ–ä¸å»ºè®®é€šè¿‡GAæ¥å®ç°ã€‚</li><li>é€šè¿‡è“å›¾ç»§æ‰¿GamePlay Abilityæ¥å®ç°</li></ul><h4 id="GAçš„æ‰§è¡Œæµç¨‹"><a href="#GAçš„æ‰§è¡Œæµç¨‹" class="headerlink" title="GAçš„æ‰§è¡Œæµç¨‹"></a>GAçš„æ‰§è¡Œæµç¨‹</h4><div class="mermaid" style="background: white; border: 1px solid #e1e1e1; border-radius: 4px; padding: 20px;">graph TD    A[TryActivateAbility] --> B{CanActivateAbility}    B -->|Yes| C[ActivateAbility]    B -->|No| D[EndAbility]    C --> E[Start AbilityTask]    E -->|Some Time Later| F[CommitAbility]    F -->|Can't Afford| D    F --> G[Start AbilityTask]    G -->|Some Time Later| H[Apply GameplayEffects]    G --> I[Start AbilityTask]    I -->|Some Time Later| J[Apply GameplayEffects]    I -->|Some Time Later| K[End Ability]    D --> L[OnEndAbility]    K --> L    L --> M[Cleanup]</div><ol><li><span style="color: blue;">TryActivateAbility</span> ï¼šé¦–å…ˆåˆ¤æ–­ä¸€ä¸‹èƒ½ä¸èƒ½æ‰§è¡Œã€‚</li><li><span style="color: green;">ActivateAbility</span>ï¼šæ‰§è¡Œä¸€å¥—æŠ€èƒ½ï¼ˆæœ‰æŠ€èƒ½åŠ¨ç”»ï¼Œæ¯”å¦‚å‘å°„ä¸€ä¸ªç«ç„°ï¼‰ã€‚</li><li><span style="color: #9C27B0;">CommitAbility</span>ï¼šæŠ€èƒ½é‡Šæ”¾äº†æˆåŠŸäº†ï¼Œè¦æ‰£è“ã€‚</li><li><span style="color: #ffeb3b;">Start AbilityTask</span> * 2:æŠ€èƒ½æ‰§è¡Œä¸­â€¦æŠ€èƒ½æ‰§è¡Œç»“æŸã€‚ç„¶ååº”ç”¨å¯¹åº”æ•ˆæœã€‚</li></ol><p>å…¶ä¸­ActivateAbilityå’ŒEnd Abilityæ˜¯ç±»ä¼¼äºBeginPlayå’ŒEndPlayè¿™æ ·çš„å‡½æ•°ï¼Œåœ¨è“å›¾ä¸­è°ƒç”¨ã€‚</p><h4 id="è“å›¾ä¸­çš„è®¾ç½®"><a href="#è“å›¾ä¸­çš„è®¾ç½®" class="headerlink" title="è“å›¾ä¸­çš„è®¾ç½®"></a>è“å›¾ä¸­çš„è®¾ç½®</h4><h4 id="ä¸»è¦é€‰é¡¹è§£é‡Š"><a href="#ä¸»è¦é€‰é¡¹è§£é‡Š" class="headerlink" title="ä¸»è¦é€‰é¡¹è§£é‡Š"></a>ä¸»è¦é€‰é¡¹è§£é‡Š</h4><h5 id="å¸¸è§è“å›¾"><a href="#å¸¸è§è“å›¾" class="headerlink" title="å¸¸è§è“å›¾"></a>å¸¸è§è“å›¾</h5><ul><li>EndAbility ç»“æŸè¿™ä¸ªèƒ½åŠ›</li></ul><h5 id="é«˜çº§è®¾ç½®"><a href="#é«˜çº§è®¾ç½®" class="headerlink" title="é«˜çº§è®¾ç½®"></a>é«˜çº§è®¾ç½®</h5><div style="text-align: center;">  <img src="https://s2.loli.net/2025/10/29/Ndl5QoW8hUkyKrw.png" alt="image-20251028173049722" width="50%" /></div><ul><li><p><strong>Replication Policy</strong>ï¼ˆå¤åˆ¶ç­–ç•¥ï¼‰ï¼š å†³å®šè¯¥Abilityçš„æ¿€æ´»ã€æ‰§è¡Œç­‰ä¿¡æ¯æ˜¯å¦åœ¨ç½‘ç»œä¸Šä¼ æ’­ã€‚å¸¸è§é€‰é¡¹æœ‰ï¼š</p><ul><li>Not Replicatedï¼šä»…æœ¬åœ°æ‰§è¡Œï¼Œä¸åŒæ­¥åˆ°å…¶ä»–å®¢æˆ·ç«¯&#x2F;æœåŠ¡å™¨ã€‚</li><li>Replicatedï¼šåœ¨æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¹‹é—´åŒæ­¥ã€‚</li></ul></li><li><p><strong>Instancing Policy</strong>ï¼ˆå®ä¾‹åŒ–ç­–ç•¥ï¼‰ï¼š å†³å®šAbilityçš„å®ä¾‹åŒ–æ–¹å¼ã€‚</p><ul><li>Non-Instancedï¼šæ‰€æœ‰æ¿€æ´»è€…å…±äº«åŒä¸€ä¸ªAbilityå¯¹è±¡ï¼Œé€‚åˆæ— çŠ¶æ€é€»è¾‘ã€‚</li><li>Instanced Per Actorï¼šæ¯ä¸ªæ‹¥æœ‰è€…æœ‰ç‹¬ç«‹å®ä¾‹ï¼Œé€‚åˆæœ‰çŠ¶æ€é€»è¾‘ã€‚</li><li>Instanced Per Executionï¼šæ¯æ¬¡æ¿€æ´»éƒ½æ–°å»ºå®ä¾‹ï¼Œé€‚åˆéœ€è¦éš”ç¦»çŠ¶æ€çš„å¤æ‚æŠ€èƒ½ã€‚</li></ul></li><li><p><strong>Server Respects Remote Ability Cancellation</strong>ï¼ˆæœåŠ¡å™¨å°Šé‡è¿œç«¯å–æ¶ˆï¼‰ï¼šå‹¾é€‰åï¼ŒæœåŠ¡å™¨ä¼šå“åº”å®¢æˆ·ç«¯è¯·æ±‚å–æ¶ˆAbilityçš„æ“ä½œã€‚é€‚åˆéœ€è¦å®¢æˆ·ç«¯ä¸»åŠ¨å–æ¶ˆæŠ€èƒ½çš„åœºæ™¯ã€‚</p></li><li><p><strong>Retrigger Instanced Ability</strong>ï¼ˆå¯é‡å¤è§¦å‘å®ä¾‹åŒ–Abilityï¼‰ï¼šå…è®¸Abilityåœ¨å·²æ¿€æ´»æ—¶å†æ¬¡è¢«æ¿€æ´»ï¼ˆä¼šé‡æ–°å®ä¾‹åŒ–ï¼‰ï¼Œé€‚åˆå¯å åŠ æˆ–å¯é‡å¤é‡Šæ”¾çš„æŠ€èƒ½ã€‚</p></li><li><p><strong>Net Execution Policy</strong>ï¼ˆç½‘ç»œæ‰§è¡Œç­–ç•¥ï¼‰ï¼šå†³å®šAbilityçš„æ¿€æ´»å’Œæ‰§è¡Œåœ¨å“ªç«¯è¿›è¡Œã€‚</p><ul><li>Local Predictedï¼šå®¢æˆ·ç«¯é¢„æµ‹æ‰§è¡Œï¼ŒæœåŠ¡å™¨æ ¡éªŒã€‚</li><li>Local Onlyï¼šä»…æœ¬åœ°æ‰§è¡Œã€‚</li><li>Server Onlyï¼šä»…æœåŠ¡å™¨æ‰§è¡Œã€‚</li><li>Server Initiatedï¼šæœåŠ¡å™¨å‘èµ·ï¼Œå®¢æˆ·ç«¯å¯å‚ä¸ã€‚</li></ul></li><li><p><strong>Net Security Policy</strong>ï¼ˆç½‘ç»œå®‰å…¨ç­–ç•¥ï¼‰ï¼šæ§åˆ¶Abilityçš„å®‰å…¨ç­‰çº§ï¼Œé˜²æ­¢è¢«æ¶æ„å®¢æˆ·ç«¯æ»¥ç”¨ã€‚</p><ul><li>Client Or Serverï¼šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éƒ½å¯æ¿€æ´»ã€‚</li><li>Server Only Executionï¼šåªæœ‰æœåŠ¡å™¨å¯æ¿€æ´»ã€‚</li><li>Server Only Execution and Dataï¼šåªæœ‰æœåŠ¡å™¨å¯æ¿€æ´»ä¸”æ•°æ®ä»…åœ¨æœåŠ¡å™¨ã€‚</li></ul></li></ul><h4 id="GAè¦åšçš„äº‹æƒ…"><a href="#GAè¦åšçš„äº‹æƒ…" class="headerlink" title="GAè¦åšçš„äº‹æƒ…"></a>GAè¦åšçš„äº‹æƒ…</h4><div style="text-align: center;">  <img src="https://s2.loli.net/2025/10/29/jaloAZzDKkq5fx2.png" alt="image-20251028200009953" width="50%" /></div><p>ä¸€èˆ¬GAè¦åšçš„äº‹æœ‰ï¼š</p><ul><li>è®¾ç½®GAçš„Tagã€CDã€Costç­‰å±æ€§ã€‚</li><li>è·å–å¿…è¦ä¿¡æ¯ï¼Œä¸»è¦é€šè¿‡Get Actor Infoã€‚å¦‚æœæ˜¯é€šè¿‡Eventè°ƒç”¨çš„GAï¼ˆä½¿ç”¨Activate Ability From EventèŠ‚ç‚¹ä½œä¸ºè¾“å…¥ï¼‰ï¼Œè¿˜å¯ä»¥é€šè¿‡Gameplay Event Dataè·å–ã€‚</li><li>ç¼–å†™é€»è¾‘ï¼Œå¦‚æ’­æ”¾åŠ¨ç”»ã€åº”ç”¨GEã€åº”ç”¨å†²é‡ç­‰ã€‚</li><li>ä¸€å®šä¸è¦å¿˜äº†EndAbilityã€‚</li></ul><h4 id="GAçš„è°ƒç”¨"><a href="#GAçš„è°ƒç”¨" class="headerlink" title="GAçš„è°ƒç”¨"></a>GAçš„è°ƒç”¨</h4><p>GAçš„è°ƒç”¨åˆ†æˆäº†ä¸»åŠ¨è°ƒç”¨ï¼ˆé‡Šæ”¾æŠ€èƒ½ï¼‰å’Œè¢«åŠ¨è°ƒç”¨ï¼ˆæŒ¨æ‰“ï¼‰ä¸¤ç±»ï¼Œä¸‹é¢ä¾æ¬¡ä»‹ç»ä¸åŒçš„è°ƒç”¨æ–¹æ³•ã€‚</p><h5 id="ä¸»åŠ¨è°ƒç”¨"><a href="#ä¸»åŠ¨è°ƒç”¨" class="headerlink" title="ä¸»åŠ¨è°ƒç”¨"></a>ä¸»åŠ¨è°ƒç”¨</h5><p>åœ¨è“å›¾ä¸­ä¸»è¦æœ‰by Classå’Œby Tag ä¸¤ç§è°ƒç”¨æ–¹æ³•ã€‚</p><div style="text-align: center;">  <img src="https://pic4.zhimg.com/v2-0671623b3bf57f42b92903bfc3acb667_1440w.jpg" alt="img" width="50%" /></div><p>byClassä¸€æ¬¡åªèƒ½Activateä¸€ä¸ªGAï¼ŒbyTagå¯ä»¥Activateä»»æ„å¤šä¸ªGAï¼Œé…åˆTagå®¹å™¨ä½¿ç”¨ã€‚</p><p>å¦‚æœä½¿ç”¨EnhancedInputActionæ’ä»¶æ¥ç®¡ç†è¾“å…¥ï¼Œè¦æ³¨æ„åœ¨æŸäº›è®¾ç½®ä¸‹triggerä¼šæ¯å¸§éƒ½è¿›è¡Œè¾“å‡ºï¼ˆæœ¬äººæµ‹è¯•ç¯å¢ƒä¸º4.27ï¼ŒUE5ä¼¼ä¹æœ‰ä¸€äº›æ”¹åŠ¨ã€‚<br>1.62GB<br>å¤ä»£å±±è°·é¡¹ç›®å°±ä½¿ç”¨äº†æ–°ç‰ˆè¾“å…¥æ’ä»¶å’ŒGASç³»ç»Ÿï¼Œå¯ä»¥çœ‹ä¸€çœ‹å®ç°æ–¹æ³•ï¼‰ã€‚</p><p>åªè¦èƒ½è·å–ASCï¼Œå°±å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è°ƒç”¨GAï¼Œæ¯”å¦‚è¡Œä¸ºæ ‘Taskè“å›¾ï¼Œç”šè‡³åœ¨GAè“å›¾ä¸­è°ƒç”¨å…¶ä»–GAã€‚</p><h5 id="è¢«åŠ¨è°ƒç”¨"><a href="#è¢«åŠ¨è°ƒç”¨" class="headerlink" title="è¢«åŠ¨è°ƒç”¨"></a>è¢«åŠ¨è°ƒç”¨</h5><p>Triggerå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªTagï¼Œå½“ASCç»„ä»¶æ”¶åˆ°ä¸€ä¸ªTriggeræ—¶ï¼Œå°±ä¼šè‡ªåŠ¨è°ƒç”¨æ‰€æœ‰æ‹¥æœ‰è¯¥Triggerçš„GAã€‚</p><p>Triggerçš„Tagåœ¨GAçš„detailsé¢æ¿ä¸­è®¾ç½®ã€‚</p><div style="text-align: center;">  <img src="https://pic2.zhimg.com/v2-9fdb393dae4753b3539245b335c3a531_1440w.jpg" alt="img" width="50%" /></div><p>Triggerçš„è§¦å‘æ–¹å¼æœ‰ä¸‰ç§ï¼Œåˆ†åˆ«æ˜¯ï¼š</p><ul><li>Gameplay Event: å½“Owneræ”¶åˆ°ä¸€ä¸ªå¸¦æœ‰Tagçš„Gameplay Eventï¼ˆ<strong>ä¸æ˜¯Gameplay Effectçš„GEï¼</strong>ï¼‰æ—¶<strong>è°ƒç”¨ä¸€æ¬¡</strong>GAï¼Œæ­¤æ—¶Owner<strong>ä¸ä¼šæ‹¥æœ‰å¯¹åº”çš„Tag</strong>ã€‚</li><li>Owner Tag Added: å½“Owner<strong>è·å–å¯¹åº”Tag</strong>çš„æ—¶å€™<strong>è°ƒç”¨ä¸€æ¬¡</strong>GAã€‚</li><li>Owner Tag Present: å½“Owner<strong>æ‹¥æœ‰Tag</strong>æ—¶è°ƒç”¨GAï¼Œå¤±å»Tagæ—¶ç§»é™¤ã€‚</li></ul><p>ä¸€èˆ¬ä½¿ç”¨ç¬¬ä¸€ç§æ–¹æ³•ï¼Œå¹¶é…åˆSendGameplayEventToActorèŠ‚ç‚¹ä½¿ç”¨ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ï¼ˆè¿™å¼ å›¾æ˜¯å¾ˆä¹…ä»¥å‰æˆªçš„ï¼ŒTagå»ºè®®ä»¥Eventå¼€å¤´ï¼‰</p><div style="text-align: center;"><img src="https://pica.zhimg.com/v2-0759f3f09591c5a808113d8841733b38_1440w.jpg" alt="img" style="zoom: 50%;" / width="50%" /></div><p>å—å‡»æ•ˆæœçš„ä¾‹å­ï¼Œå‘é€ä¸€ä¸ªTagä¸ºHitçš„Eventç»™ç¢°æ’æ£€æµ‹åˆ°çš„Actor</p><p>ä½¿ç”¨Gameplay Eventè°ƒç”¨çš„å¥½å¤„æ˜¯ï¼Œå¯ä»¥ä¼ å…¥æ•°æ®ï¼ˆPayloadï¼‰ï¼Œæ˜¯é™¤äº†Get Actor Infoå¤–çš„å¦ä¸€ç§ä¿¡æ¯ä¼ é€’æ–¹æ³•ã€‚</p><p>æ­¤æ—¶åº”è¯¥åˆ é™¤ActiveAbilityèŠ‚ç‚¹ï¼Œè½¬è€Œä½¿ç”¨ActivateAbilityFromEventäº‹ä»¶ã€‚ï¼ˆ<strong>ä¸è¦é€šè¿‡åœ¨å·¦ä¸Šè§’é‡è½½å‡½æ•°çš„æ–¹å¼ï¼Œå³é”®ç©ºç™½å¤„æœç´¢æ‰æ˜¯å¯¹çš„</strong>ï¼‰</p><h3 id="GEï¼šWhatæŠ€èƒ½æ”¹å˜çš„å±æ€§ï¼Ÿ"><a href="#GEï¼šWhatæŠ€èƒ½æ”¹å˜çš„å±æ€§ï¼Ÿ" class="headerlink" title="GEï¼šWhatæŠ€èƒ½æ”¹å˜çš„å±æ€§ï¼Ÿ"></a>GEï¼šWhatæŠ€èƒ½æ”¹å˜çš„å±æ€§ï¼Ÿ</h3><p>Gameplay Effectï¼ˆGEï¼‰æ˜¯Abilityå¯¹<strong>è‡ªå·±æˆ–ä»–äººäº§ç”Ÿå½±å“çš„é€”å¾„</strong>ã€‚<br>GEé€šå¸¸å¯ä»¥è¢«ç†è§£ä¸ºæˆ‘ä»¬æ¸¸æˆä¸­çš„buffã€‚æ¯”å¦‚å¢ç›Š&#x2F;å‡ç›Šæ•ˆæœï¼ˆä¿®æ”¹å±æ€§ï¼‰ã€‚<br>ä½†æ˜¯GASä¸­çš„GEä¹Ÿæ›´åŠ å¹¿ä¹‰ï¼Œé‡Šæ”¾æŠ€èƒ½æ—¶å€™çš„ä¼¤å®³ç»“ç®—ï¼Œæ–½åŠ ç‰¹æ®Šæ•ˆæœçš„æ§åˆ¶ã€éœ¸ä½“æ•ˆæœï¼ˆä¿®æ”¹GameplayTagï¼‰éƒ½æ˜¯é€šè¿‡GEæ¥å®ç°çš„ã€‚</p><ul><li><u>GEåªæ˜¯ä¸€ä¸ªå¯é…ç½®çš„*<em>æ•°æ®è¡¨</em> *</u>ï¼Œä¸å¯ä»¥æ·»åŠ é€»è¾‘ã€‚å¼€å‘è€…åˆ›å»ºä¸€ä¸ªUGameplayEffectçš„æ´¾ç”Ÿè“å›¾ï¼Œå°±å¯ä»¥æ ¹æ®éœ€æ±‚åˆ¶ä½œæƒ³è¦çš„æ•ˆæœã€‚</li><li>GEæ˜¯çº¯è“å›¾</li></ul><h3 id="GTï¼šifæŠ€èƒ½æ”¹å˜çš„æ¡ä»¶ï¼Ÿ"><a href="#GTï¼šifæŠ€èƒ½æ”¹å˜çš„æ¡ä»¶ï¼Ÿ" class="headerlink" title="GTï¼šifæŠ€èƒ½æ”¹å˜çš„æ¡ä»¶ï¼Ÿ"></a>GTï¼šifæŠ€èƒ½æ”¹å˜çš„æ¡ä»¶ï¼Ÿ</h3><p>FGameplayTagsæ˜¯ä¸€ç§å±‚çº§æ ‡ç­¾ï¼Œå¦‚Parent.Child.GrandChildã€‚<br>é€šè¿‡GameplayTagManagerè¿›è¡Œæ³¨å†Œã€‚<br>æ›¿ä»£äº†åŸæ¥çš„Boolï¼Œæˆ–Enumçš„ç»“æ„ï¼Œå¯ä»¥åœ¨ç©æ³•è®¾è®¡ä¸­æ›´é«˜æ•ˆçš„<strong>æ ‡è®°å¯¹è±¡çš„è¡Œä¸ºæˆ–çŠ¶æ€</strong>ï¼ˆæ¯”å¦‚ä¸€ä¸ªç¼çƒ§æ•ˆæœï¼ŒGEå®Œæˆä¹‹åï¼Œä¾¿å¯ä»¥å–æ¶ˆæ ‡ç­¾ï¼‰ã€‚<br>æˆ‘ç†è§£æ˜¯ä¸€ä¸ªåœ¨Actorä¸‹çš„Jsonã€‚</p><ul><li>Tagçš„<strong>å±‚çº§å…³ç³»</strong>ä¹Ÿéœ€è¦åˆç†è®¾è®¡ï¼Œåˆ°äº†åæœŸä¿®æ”¹æˆæœ¬æ¯”è¾ƒå¤§ã€‚</li></ul><h3 id="Attribute-Set"><a href="#Attribute-Set" class="headerlink" title="Attribute Set"></a>Attribute Set</h3><p>è´Ÿè´£å®šä¹‰å’ŒæŒæœ‰å±æ€§ï¼Œå¹¶ä¸”ç®¡ç†å±æ€§çš„<u>å˜åŒ–</u>ï¼ŒåŒ…æ‹¬<u>ç½‘ç»œåŒæ­¥</u>ã€‚<br>éœ€è¦åœ¨Actorä¸­è¢«æ·»åŠ ä¸ºæˆå‘˜å˜é‡ï¼Œå¹¶æ³¨å†Œåˆ°ASCï¼ˆC++ï¼‰ã€‚<br>ä¸€ä¸ªASCå¯ä»¥æ‹¥æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªï¼ˆä¸åŒçš„ï¼‰AttributeSetï¼Œå› æ­¤å¯ä»¥è§’è‰²å…±äº«ä¸€ä¸ªå¾ˆå¤§çš„Attribute Setï¼Œä¹Ÿå¯ä»¥æ¯ä¸ªè§’è‰²æŒ‰éœ€æ·»åŠ Attribute Setã€‚<br>å¯ä»¥åœ¨å±æ€§å˜åŒ–å‰ï¼ˆPreAttributeChangeï¼‰åï¼ˆPostGameplayEffectExecuteï¼‰å¤„ç†ç›¸å…³é€»è¾‘ï¼Œå¯ä»¥é€šè¿‡å§”æ‰˜çš„æ–¹å¼ç»‘å®šå±æ€§å˜åŒ–ã€‚</p><h3 id="Player-State"><a href="#Player-State" class="headerlink" title="Player State"></a>Player State</h3><div style="text-align: center;">  <img src="https://s2.loli.net/2025/11/21/N17ULdln2Ako5cI.png" alt="Player State æ¶æ„ç¤ºæ„å›¾" width="50%" /></div>PlayerState æ˜¯ Unreal Engine ä¸­ç”¨äºå­˜å‚¨ç©å®¶ç›¸å…³ä¿¡æ¯çš„ç‰¹æ®Š Actor ç±»ã€‚åœ¨å¤šäººæ¸¸æˆä¸­ï¼ŒPlayerState ä¼šè‡ªåŠ¨åœ¨æœåŠ¡å™¨å’Œæ‰€æœ‰å®¢æˆ·ç«¯ä¹‹é—´å¤åˆ¶ï¼Œéå¸¸é€‚åˆå­˜å‚¨éœ€è¦è·¨ç½‘ç»œåŒæ­¥çš„ç©å®¶æ•°æ®ã€‚<p>åœ¨ GAS ç³»ç»Ÿä¸­ï¼Œ<u>ASC å¯ä»¥é€‰æ‹©æŒ‚è½½åœ¨ PlayerState ä¸Šè€Œä¸æ˜¯ Character ä¸Š</u>ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼š</p><ul><li><strong>æŒä¹…æ€§</strong>ï¼šå½“è§’è‰²æ­»äº¡æˆ–é‡ç”Ÿæ—¶ï¼ŒPlayerState ä¾ç„¶å­˜åœ¨ï¼ŒæŠ€èƒ½å’Œå±æ€§æ•°æ®ä¸ä¼šä¸¢å¤±</li><li><strong>ç½‘ç»œå¤åˆ¶</strong>ï¼šPlayerState å¤©ç„¶æ”¯æŒç½‘ç»œå¤åˆ¶ï¼Œé€‚åˆå¤šäººæ¸¸æˆåœºæ™¯</li><li><strong>UI è®¿é—®</strong>ï¼šUI å¯ä»¥æ›´æ–¹ä¾¿åœ°è®¿é—®ç©å®¶çš„æŠ€èƒ½å’Œå±æ€§ä¿¡æ¯ï¼Œæ— éœ€ä¾èµ–å…·ä½“çš„ Character å®ä¾‹</li><li><strong>è§‚å¯Ÿè€…æ¨¡å¼</strong>ï¼šå³ä½¿ç©å®¶å¤„äºè§‚å¯Ÿè€…çŠ¶æ€ï¼ˆæ²¡æœ‰ Characterï¼‰ï¼Œä¹Ÿèƒ½ä¿æŒæŠ€èƒ½ç³»ç»Ÿçš„çŠ¶æ€</li></ul><p>å¸¸è§çš„åšæ³•æ˜¯ï¼š</p><ul><li><strong>ç©å®¶æ§åˆ¶çš„è§’è‰²</strong>ï¼šASC æ”¾åœ¨ PlayerState ä¸Š</li><li><strong>AI æ§åˆ¶çš„è§’è‰²</strong>ï¼šASC ç›´æ¥æ”¾åœ¨ Character ä¸Š</li></ul><h3 id="ç»„ä»¶æ€»ç»“"><a href="#ç»„ä»¶æ€»ç»“" class="headerlink" title="ç»„ä»¶æ€»ç»“"></a>ç»„ä»¶æ€»ç»“</h3><p>Visualï¼šæŠ€èƒ½çš„è§†è§‰æ•ˆæœï¼ŸGameplayCue<br>Asyncï¼šæŠ€èƒ½çš„é•¿æ—¶è¡ŒåŠ¨ï¼Ÿ(å¼‚æ­¥)GameplayTask<br>Sendï¼šæŠ€èƒ½çš„æ¶ˆæ¯äº‹ä»¶ï¼ŸGamePplayEvent<br>è¿™ä¿©æ˜¯åŒä¸€ä¸ªä¸œè¥¿</p><h2 id="åŸºç¡€ä½¿ç”¨"><a href="#åŸºç¡€ä½¿ç”¨" class="headerlink" title="åŸºç¡€ä½¿ç”¨"></a>åŸºç¡€ä½¿ç”¨</h2><h3 id="å¼€å¯æ’ä»¶"><a href="#å¼€å¯æ’ä»¶" class="headerlink" title="å¼€å¯æ’ä»¶"></a>å¼€å¯æ’ä»¶</h3><div style="text-align: center;">  <img src="https://s2.loli.net/2025/10/29/PxXeVshqdbliFYQ.png" alt="image-20251027203033649" width="50%" />  <img src="https://s2.loli.net/2025/10/29/TmQHkou6jg5PzSN.png" alt="image-20251027203540226" width="50%" /></div><ol><li><u>C++é¡¹ç›®</u>ï¼Œå®‰è£…Gameplay Abilityæ’ä»¶ã€‚</li><li>åœ¨Toolsèœå•ä¸‹é¢æœ‰GameplayCue Editoræœ‰äº†ï¼Œå°±è¯´æ˜å¼€å¯æˆåŠŸäº†ã€‚</li><li>åœ¨æ–°å»ºçš„è“å›¾çš„é¡µé¢å¯ä»¥çœ‹åˆ°GamePlayç›¸å…³çš„ä¸œè¥¿</li></ol><h3 id="ä½¿ç”¨Riderå¿«é€Ÿæ·»åŠ Unrealç±»"><a href="#ä½¿ç”¨Riderå¿«é€Ÿæ·»åŠ Unrealç±»" class="headerlink" title="ä½¿ç”¨Riderå¿«é€Ÿæ·»åŠ Unrealç±»"></a>ä½¿ç”¨Riderå¿«é€Ÿæ·»åŠ Unrealç±»</h3><div style="text-align: center;">  <img src="https://s2.loli.net/2025/10/29/kqL2KOeURij69dr.png" alt="image-20251027215401030" width="50%" /></div><p>é€šè¿‡è¿™é‡Œåˆ›å»ºä¸€ä¸ªCharacterã€‚å¯ä»¥å¿«é€Ÿæ‹¥æœ‰ä¸€äº›å¤´æ–‡ä»¶ã€‚</p><h3 id="ASCç»„ä»¶æ¶æ„"><a href="#ASCç»„ä»¶æ¶æ„" class="headerlink" title="ASCç»„ä»¶æ¶æ„"></a>ASCç»„ä»¶æ¶æ„</h3><div class="mermaid" style="background: white; border: 1px solid #e1e1e1; border-radius: 4px; padding: 20px;">classDiagram  class ACharacter  class ARPGCharacterBase {    +AbilitySystemComponent  }  class BP_Character {    +å…¬å…±é€»è¾‘  }  class BP_PlayerCharacter {    -ç»„è£…Cameraç­‰ç»„ä»¶    -è¾“å…¥ç»‘å®š  }  class BP_NPCCharacter  ACharacter <|-- ARPGCharacterBase  ARPGCharacterBase <|-- BP_Character  BP_Character <|-- BP_PlayerCharacter  BP_Character <|-- BP_NPCCharacter</div><p>ä½ éœ€è¦è‡ªå·±åˆ›å»ºä¸€ä¸ªç»§æ‰¿è‡ªACharacterçš„C++ç±»ã€‚</p><p>ä¹‹åæƒ³ç”¨è“å›¾ï¼Œå°±ä»è¿™ä¸ªè‡ªå®šä¹‰çš„C++Characterç±»æ´¾ç”Ÿå°±å¯ä»¥äº†ã€‚ </p><h3 id="å†™ä¸€ä¸ªBase-GAS-ACharacteræ–‡ä»¶"><a href="#å†™ä¸€ä¸ªBase-GAS-ACharacteræ–‡ä»¶" class="headerlink" title="å†™ä¸€ä¸ªBase GAS ACharacteræ–‡ä»¶"></a>å†™ä¸€ä¸ªBase GAS ACharacteræ–‡ä»¶</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">PublicDependencyModuleNames.AddRange(<span class="keyword">new</span> <span class="built_in">string</span>[]</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;Core&quot;</span>, <span class="string">&quot;CoreUObject&quot;</span>, <span class="string">&quot;Engine&quot;</span>, <span class="string">&quot;InputCore&quot;</span>, <span class="string">&quot;EnhancedInput&quot;</span>,</span><br><span class="line">    <span class="string">&quot;GameplayAbilities&quot;</span>,<span class="string">&quot;GameplayTags&quot;</span>,<span class="string">&quot;GameplayTasks&quot;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>åœ¨Buildæ–‡ä»¶é‡Œæ·»åŠ å¦‚ä¸‹çš„å†…å®¹GameplayAbilitiesã€GameplayTagsã€GameplayTasksã€‚</p><p>åœ¨å¤´æ–‡ä»¶é‡Œé¢æ·»åŠ ä¸€ä¸ªAbilitySystemComponentï¼Œç›´æ¥åœ¨è§’è‰²ä¸ŠæŒ‚è½½ AbilitySystemComponentï¼ˆASCï¼‰ï¼Œå¯ä»¥é€‚é…å¤šäººæ¸¸æˆã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TObjectPtr&lt;UTCGAbilitySystemComponent&gt; AbilitySystemComponent;</span><br></pre></td></tr></table></figure><p>åœ¨.cppä¸­æ„é€ å‡½æ•°éƒ¨åˆ†å®ä¾‹åŒ–AbilitySystemComponentï¼ˆASCï¼‰ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å®ä¾‹åŒ–ASC</span></span><br><span class="line">AbilitySystemComponent = <span class="built_in">CreateDefaultSubobject</span>&lt;UAbilitySystemComponent&gt;(<span class="built_in">TEXT</span>(<span class="string">&quot;AbilitySystem&quot;</span>));</span><br></pre></td></tr></table></figure><p>è§’è‰²ç±»ç»§æ‰¿IAbilitySystemInterfaceæ¥å£ï¼Œå¹¶å®ç°GetASCå‡½æ•°</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystemInterface.h&quot;</span></span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ARPG_UNREAL_API</span> ACharacterBase : <span class="keyword">public</span> ACharacter, <span class="keyword">public</span> IAbilitySystemInterface</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function">UAbilitySystemComponent* <span class="title">GetAbilitySystemComponent</span><span class="params">()</span><span class="type">const</span> <span class="keyword">override</span></span>;</span><br></pre></td></tr></table></figure><p>åœ¨CPPä¸­å®ç°</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">UAbilitySystemComponent* <span class="title">ACharacterBase::GetAbilitySystemComponent</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> AbilitySystemComponent;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ğŸ‘†è¿™é‡Œçš„returnå³ä½¿å†™ä¸ºnullï¼Œä¹Ÿå¯èƒ½å¯èƒ½è°ƒç”¨</p><p><em>è¿™ä¸ªåœ¨é¡¹ç›®ä¸­çš„è·¯å¾„åœ¨ï¼šSource&#x2F;TCG_AwesomeLive&#x2F;CharacterSystem&#x2F;TCGCharacterBase.h</em></p><h3 id="æŠŠGAæ•°ç»„åŠ å…¥åˆ°Actorä¸­"><a href="#æŠŠGAæ•°ç»„åŠ å…¥åˆ°Actorä¸­" class="headerlink" title="æŠŠGAæ•°ç»„åŠ å…¥åˆ°Actorä¸­"></a>æŠŠGAæ•°ç»„åŠ å…¥åˆ°Actorä¸­</h3><p>å¯ä»¥å°†UEåŸç”Ÿçš„UGameplayAbilityç›´æ¥åŠ å…¥åˆ°éœ€è¦Abilityçš„Actorä¸­ï¼ˆä¹Ÿæ˜¯åŠ åˆ°è¿™ä¸ªBase GAS ACharacteræ–‡ä»¶ä¸­ï¼‰</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UPROPERTY</span>(BlueprintReadOnly, EditAnywhere, Category = <span class="string">&quot;Test|Abilities&quot;</span>)</span><br><span class="line">TArray&lt;TSubclassOf&lt;UGameplayAbility&gt;&gt; CharacterAbilities;</span><br></pre></td></tr></table></figure><p><strong>åœ¨C++ä¸­èµ‹äºˆGA</strong>ï¼šæˆ‘ä»¬å¯ä»¥å°†æˆ‘ä»¬æ‰€æœ‰çš„æŠ€èƒ½å‚¨å­˜åœ¨ä¸€å¼ DAè¡¨ä¹‹ä¸­ï¼Œç„¶åä»DAè¡¨é‡Œè¯»å–æ•°æ®ï¼Œå¹¶ä½¿ç”¨AbilitySystemComponent-&gt;GiveAbilityå°†æ•°æ®èµ‹äºˆASCã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ·»åŠ èƒ½åŠ›</span></span><br><span class="line"><span class="keyword">for</span>(FTCGAblityInfo&amp; Info : AllAbilitiesInfo)&#123;</span><br><span class="line">    <span class="keyword">if</span> (Info.AbilityClass == <span class="literal">nullptr</span>)</span><br><span class="line">       <span class="keyword">continue</span>;</span><br><span class="line">    CharacterAbilities.<span class="built_in">Add</span>(Info.AbilityClass);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> StartupAbility : CharacterAbilities)</span><br><span class="line">&#123;</span><br><span class="line">    AbilitySystemComponent-&gt;<span class="built_in">GiveAbility</span>(</span><br><span class="line">       <span class="built_in">FGameplayAbilitySpec</span>(StartupAbility, <span class="number">1</span>, INDEX_NONE, <span class="keyword">this</span>)</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨ç»§æ‰¿äº†Base Characterçš„å­ç±»ä¸­ï¼Œçœ‹åˆ°Abilityçš„é€‰é¡¹äº†ã€‚</p><div style="text-align: center;">  <img src="https://s2.loli.net/2025/10/29/KYsEzGVCQ1Ibwre.png" alt="image-20251028184812916" width="50%" /></div>èµ‹äºˆGAçš„æ–¹å¼æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚åœ¨éœ€è¦çš„è“å›¾ä¸­è°ƒç”¨<u>Give Ability</u>èŠ‚ç‚¹ã€‚è¿˜å¯ä»¥ä½¿ç”¨GEèµ‹äºˆGAã€‚<p>åœ¨å®˜æ–¹çš„Lyraæ¡ˆä¾‹é‡Œé¢ä½¿ç”¨AbilitySetæ¥å‚¨å­˜ä¸€ç±»Abilityï¼Œé€šè¿‡åŠ è½½æ¥å®ç°èµ‹äºˆã€‚å‚çœ‹ä¸‹æ–‡Unrealå®˜æ–¹æ¡ˆä¾‹â€œèµ‹äºˆGAâ€éƒ¨åˆ†ã€‚</p><h2 id="Unrealå®˜æ–¹æ¡ˆä¾‹"><a href="#Unrealå®˜æ–¹æ¡ˆä¾‹" class="headerlink" title="Unrealå®˜æ–¹æ¡ˆä¾‹"></a>Unrealå®˜æ–¹æ¡ˆä¾‹</h2><p>UEä¸­æœ‰ä¸€ä¸ªéå¸¸ä¸é”™çš„å®˜æ–¹ç¤ºä¾‹<a href="https://dev.epicgames.com/documentation/zh-cn/unreal-engine/lyra-sample-game-in-unreal-engine?application_version=5.0">Lyra</a>é‡Œé¢å±•ç¤ºäº†ä¸€ä¸ªå®Œæ•´çš„GASç³»ç»Ÿã€‚</p><h3 id="é¡¹ç›®é‡Œçš„è®¾ç½®"><a href="#é¡¹ç›®é‡Œçš„è®¾ç½®" class="headerlink" title="é¡¹ç›®é‡Œçš„è®¾ç½®"></a>é¡¹ç›®é‡Œçš„è®¾ç½®</h3><div style="text-align: center;"><img src="https://s2.loli.net/2025/11/21/zWIduBsAxTriGkX.png" alt="image-20251111183652281" width="50%" /></div><p>è¿™ä¸ªé¡¹ç›®é‡Œå¼€å‘è€…è®¾ç½®äº†ä¸€äº›è°ƒæ•´é€‰é¡¹ï¼Œå¯ä»¥è®¾å®šä¸€äº›debugçš„å‚æ•°ã€‚</p><p>æ¯”å¦‚å­å¼¹å°„å‡»åœç•™æ—¶é—´ï¼Œç”Ÿæˆçš„botçš„æ•°é‡ã€‚</p><h3 id="é¡¹ç›®è“å›¾å¸¸è§å‰ç¼€æ ‡è¯†"><a href="#é¡¹ç›®è“å›¾å¸¸è§å‰ç¼€æ ‡è¯†" class="headerlink" title="é¡¹ç›®è“å›¾å¸¸è§å‰ç¼€æ ‡è¯†"></a>é¡¹ç›®è“å›¾å¸¸è§å‰ç¼€æ ‡è¯†</h3><p><strong>WID_</strong><br>å…¨ç§°å¯ç†è§£ä¸º Weapon Item Definitionã€‚<br>ç”¨é€”ï¼šæ­¦å™¨ç±»çš„â€œç‰©å“å®šä¹‰â€è“å›¾èµ„äº§ï¼Œç»§æ‰¿è‡ª ULyraInventoryItemDefinitionï¼ˆä½ åœ¨ä»£ç é‡Œçœ‹åˆ°çš„åŸºç±»ï¼‰ã€‚<br><strong>ID_</strong><br>å¯ç†è§£ä¸ºï¼ˆGenericï¼‰Item Definitionã€‚<br>ç”¨é€”ï¼šéæ­¦å™¨çš„ä¸€èˆ¬ç‰©å“å®šä¹‰ï¼ˆæ¯”å¦‚æ¶ˆè€—å“ã€å¼¹è¯ã€åŒ…è£¹ã€å¯å †å èµ„æºç­‰ï¼‰ä¹Ÿç»§æ‰¿ ULyraInventoryItemDefinitionï¼Œç”¨ ID_ å‰ç¼€åŒºåˆ†ä¸ WID_ï¼ˆæ­¦å™¨ä¸“ç”¨ï¼‰èµ„äº§ã€‚<br><strong>B</strong>_<br>B_ å‰ç¼€åœ¨ Lyra ä¸­é€šå¸¸ä»£è¡¨ä¸€ä¸ª Blueprint ç±»èµ„äº§ï¼ˆç­‰åŒå¾ˆå¤šå›¢é˜Ÿå¸¸ç”¨çš„ BP_ï¼ŒLyra é¡¹ç›®é‡Œå–äº†æ›´çŸ­çš„ B_ï¼‰ã€‚</p><h3 id="æºç è§£æ"><a href="#æºç è§£æ" class="headerlink" title="æºç è§£æ"></a>æºç è§£æ</h3><ul><li>è¿™ä¸€éƒ¨åˆ†æˆ‘ä¸»è¦å‚è€ƒçš„æ˜¯<a href="https://zhuanlan.zhihu.com/p/1934717850632823338">è¿™é‡Œ</a>åŠ ä¸Šäº†ä¸€äº›æˆ‘è‡ªå·±çš„è¡¥å……ã€‚æ•´ä½“ç»“æ„é‡‡ç”¨äº†åŸæœ¬çš„ç»“æ„ï¼Œä½†æ˜¯æœ‰æˆ‘è‡ªå·±çš„åˆ å‡ï¼Œå¯ä»¥å¯¹ç…§åœ°çœ‹ã€‚</li></ul><h4 id="åˆå§‹åŒ–Ability-System"><a href="#åˆå§‹åŒ–Ability-System" class="headerlink" title="åˆå§‹åŒ–Ability System"></a>åˆå§‹åŒ–Ability System</h4><h5 id="åˆ›å»ºASC"><a href="#åˆ›å»ºASC" class="headerlink" title="åˆ›å»ºASC"></a>åˆ›å»ºASC</h5><p>ASCç”¨äºæ€»ä½“æ§åˆ¶GASåŠŸèƒ½ï¼Œå¯ä»¥æŒ‚åœ¨Characterä¸Šæˆ–è€…PlayerStateä¸Šï¼Œå¯¹äºè§’è‰²ä¼šæ­»äº¡é‡ç”Ÿçš„åœºæ™¯ï¼ŒæŒ‚åœ¨PlayerStateä¸Šæ›´åˆé€‚ï¼Œä¸ä¼šå› Characteré”€æ¯è€Œä¸¢å¤±æ•°æ®ã€‚å› æ­¤Lyraé€‰æ‹©æŠŠASCæŒ‚åœ¨äº†PlayerStateä¸Šï¼Œè¿™æ ·è¿˜æœ‰é¢å¤–ä½œç”¨ï¼Œå°±æ˜¯æŒ‰Tabé”®æ˜¾ç¤ºè®¡åˆ†æ¿è¿™ç§æˆ˜æ–—æ— å…³çš„åŠŸèƒ½ï¼Œä¹Ÿå¯ä»¥ç”¨GAå®ç°ï¼Œä»¥å¾€çš„ä¹ æƒ¯éƒ½æ˜¯ç¡¬ç¼–ç ã€‚</p><p>ULyraAbilitySystemComponentæœ¬èº«æ˜¯ä¸€ä¸ªManagerï¼Œä¸æ•°æ®æ— å…³ï¼Œæ‰€ä»¥PlayerStateç›´æ¥Newäº†ä¸€ä¸ªå¯¹è±¡å³å¯ï¼š</p><blockquote><p>Source&#x2F;LyraGame&#x2F;GameModes&#x2F;LyraGameState.h&#x2F;cpp</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å£°æ˜</span></span><br><span class="line"><span class="built_in">UPROPERTY</span>(VisibleAnywhere, Category = <span class="string">&quot;Lyra|PlayerState&quot;</span>)</span><br><span class="line">TObjectPtr&lt;ULyraAbilitySystemComponent&gt; AbilitySystemComponent;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ›å»º</span></span><br><span class="line">AbilitySystemComponent = ObjectInitializer.<span class="built_in">CreateDefaultSubobject</span>&lt;ULyraAbilitySystemComponent&gt;(<span class="keyword">this</span>, <span class="built_in">TEXT</span>(<span class="string">&quot;AbilitySystemComponent&quot;</span>));</span><br><span class="line">AbilitySystemComponent-&gt;<span class="built_in">SetIsReplicated</span>(<span class="literal">true</span>);</span><br><span class="line">AbilitySystemComponent-&gt;<span class="built_in">SetReplicationMode</span>(EGameplayEffectReplicationMode::Mixed);</span><br></pre></td></tr></table></figure><h5 id="ASCé‡Œé¢ä¹Ÿä¼šè®°å½•Actor"><a href="#ASCé‡Œé¢ä¹Ÿä¼šè®°å½•Actor" class="headerlink" title="ASCé‡Œé¢ä¹Ÿä¼šè®°å½•Actor"></a>ASCé‡Œé¢ä¹Ÿä¼šè®°å½•Actor</h5><blockquote><p>Plugins&#x2F;Runtime&#x2F;GameplayAbilities&#x2F;Source&#x2F;GameplayAbilities&#x2F;Public&#x2F;AbilitySystemComponent.h</p></blockquote><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span>:</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** The actor that owns this component logically */</span></span><br><span class="line">    <span class="built_in">UPROPERTY</span>(ReplicatedUsing = OnRep_OwningActor)</span><br><span class="line">    TObjectPtr&lt;AActor&gt; OwnerActor;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** The actor that is the physical representation used for abilities. Can be NULL */</span></span><br><span class="line">    <span class="built_in">UPROPERTY</span>(ReplicatedUsing = OnRep_OwningActor)</span><br><span class="line">    TObjectPtr&lt;AActor&gt; AvatarActor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** Cached off data about the owning actor that abilities will need to frequently access (movement component, mesh component, anim instance, etc) */</span></span><br><span class="line">    TSharedPtr&lt;FGameplayAbilityActorInfo&gt;  AbilityActorInfo;</span><br></pre></td></tr></table></figure><p>ASCä¹Ÿä¼šè®°å½•å…³è”Actorçš„ä¿¡æ¯ï¼š</p><p><strong>OwnerActor</strong>æŒ‚åœ¨å“ªä¸ªActorä¸Šï¼Œè¿™é‡Œæ˜¯PlayerStateï¼›</p><p><strong>AvatarActor</strong>æ˜¯ä½¿ç”¨Abilityå®ä½“ï¼Œè¿™é‡Œæ˜¯Characterã€‚</p><p>è¿™ä¸¤ä¸ªå±æ€§æ˜¯ASCç»å¸¸è¦è·å–çš„å˜é‡ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰å¤šä¸ªä¸Actorå…³è”çš„å±æ€§ä¼šè¢«é«˜é¢‘è¯»å–ï¼Œä¸ºäº†æé«˜è¯»å–æ€§èƒ½ï¼ŒASCç´¢æ€§æŠŠå®ƒä»¬å¤åˆ¶äº†ä¸€ä»½ï¼Œé›†ä¸­å­˜å‚¨åœ¨<strong>AbilityActorInfo</strong>å˜é‡ä¸­ï¼ŒåŒ…æ‹¬äº†PlayerControllerï¼ŒSkeletalMeshComponentï¼ŒAnimInstanceï¼ŒMovementComponentï¼ŒAffectedAnimInstanceTagã€‚</p><h5 id="èµ‹äºˆGAï¼ˆå‰å»ºç«‹Experienceåšæ•°æ®è¡”æ¥ï¼‰"><a href="#èµ‹äºˆGAï¼ˆå‰å»ºç«‹Experienceåšæ•°æ®è¡”æ¥ï¼‰" class="headerlink" title="èµ‹äºˆGAï¼ˆå‰å»ºç«‹Experienceåšæ•°æ®è¡”æ¥ï¼‰"></a>èµ‹äºˆGAï¼ˆå‰å»ºç«‹Experienceåšæ•°æ®è¡”æ¥ï¼‰</h5><p>åˆ›å»ºå®ŒASCåï¼Œè¦å¾€è¿™ä¸ªå®¹å™¨é‡Œèµ‹äºˆGAäº†ï¼Œè¡¨ç¤ºActoræœ‰è¿™äº›èƒ½åŠ›ã€‚</p><p>Lyraå·¥ç¨‹é«˜åº¦æ¨¡å—åŒ–ï¼Œé…ç½®æ¯”è¾ƒåˆ†æ•£ï¼Œä½¿ç”¨AbilitySetæ¥å‚¨å­˜ä¸€ç±»Abilityï¼Œé€šè¿‡åŠ è½½æ¥å®ç°è‡ªåŠ¨åŒ–é…ç½®å’Œèµ‹äºˆGAã€‚</p><p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªExperienceï¼Œ<u>é¦–å…ˆä»€ä¹ˆæ˜¯Experienceï¼Ÿ</u></p><ul><li><p>å®šä¹‰è§’è‰²ï¼š Experienceï¼ˆé€šè¿‡ ULyraExperienceDefinitionï¼‰æŠŠä¸€ç»„è¿è¡Œæ—¶è¡Œä¸ºã€èµ„æºå’Œè§„åˆ™æ‰“åŒ…æˆä¸€ä¸ªå¯åˆ‡æ¢çš„ä½“éªŒï¼ˆä¾‹å¦‚ä¸åŒæ¨¡å¼ã€åœ°å›¾æˆ–ç©æ³•é…ç½®ï¼‰ã€‚</p></li><li><p>ä¸»è¦ç”¨é€”ï¼šåœ¨æ¸¸æˆå¯åŠ¨æˆ–åˆ‡æ¢ä½“éªŒæ—¶å‘Šè¯‰å¼•æ“â€œè¦å¯ç”¨å“ªäº› GameFeaturesã€é»˜è®¤çš„ Pawn æ•°æ®ã€ä»¥åŠéœ€è¦æ‰§è¡Œå“ªäº›åŠ¨ä½œ&#x2F;èµ‹èƒ½â€</p></li><li><p>åŸå› </p><ul><li>ç»Ÿä¸€é…ç½®ä¸å¯åˆ‡æ¢æ€§ï¼šæŠŠè°ƒè¡¨ï¼ˆæŠ€èƒ½ã€æ•ˆæœã€é»˜è®¤ pawn ç­‰ï¼‰æ”¾åˆ° Experience é‡Œï¼Œä¾¿äºåœ¨ä¸åŒç©æ³•&#x2F;æ¨¡å¼é—´åˆ‡æ¢å’Œå¤ç”¨ï¼Œä¸ç”¨æŠŠèƒ½åŠ›å†™æ­»åœ¨ä»£ç é‡Œã€‚</li><li>æ•°æ®é©±åŠ¨ä¸å»¶è¿ŸåŠ è½½ï¼šExperience å¯ä»¥åœ¨è¿è¡Œæ—¶å¯&#x2F;åœ GameFeaturesã€æ³¨å…¥èµ„æºï¼Œå†æŠŠéœ€è¦çš„èƒ½åŠ›&#x2F;æ•ˆæœæ‰¹é‡ä¸‹å‘ã€‚</li><li>ä½œç”¨åŸŸä¸ç”Ÿå‘½å‘¨æœŸå¯æ§ï¼šé€šè¿‡ Experience å¯ä»¥åœ¨å¯ç”¨æ—¶æˆäºˆã€åœç”¨æ—¶æ’¤é”€ï¼Œæ–¹ä¾¿æ•´ä½“ç®¡ç†å’Œçƒ­åŠ è½½ã€‚</li></ul></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UCLASS</span>(BlueprintType, Const)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ULyraExperienceDefinition</span> : <span class="keyword">public</span> UPrimaryDataAsset</span><br><span class="line">&#123;</span><br><span class="line">...</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">UPROPERTY</span>(EditDefaultsOnly, Category = Gameplay)</span><br><span class="line">    TArray&lt;FString&gt; GameFeaturesToEnable;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">UPROPERTY</span>(EditDefaultsOnly, Category=Gameplay)</span><br><span class="line">    TObjectPtr&lt;<span class="type">const</span> ULyraPawnData&gt; DefaultPawnData;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">UPROPERTY</span>(EditDefaultsOnly, Instanced, Category=<span class="string">&quot;Actions&quot;</span>)</span><br><span class="line">    TArray&lt;TObjectPtr&lt;UGameFeatureAction&gt;&gt; Actions;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">UPROPERTY</span>(EditDefaultsOnly, Category=Gameplay)</span><br><span class="line">    TArray&lt;TObjectPtr&lt;ULyraExperienceActionSet&gt;&gt; ActionSets;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å¦‚å›¾Lyraçš„ç»“æ„ã€‚</p><div style="text-align: center;"><img src="https://s2.loli.net/2025/11/21/jlbEy7vf4z2D6xF.png" alt="image-20251111172739503" width="50%" /></div><p>ç»§æ‰¿è‡ªULyraExperienceDefinitionçš„ï¼šB_BasicShooterTestB_BasicShooterTestè¿™ä¸ªæ•°æ®ç±»é‡Œçš„Actionåˆ†ç»„é‡Œé¢ï¼Œæœ‰éœ€è¦æˆäºˆçš„GAçš„DAè¡¨ã€‚</p><p>æ¯”å¦‚ï¼š**AbilitySet_<strong>Eliminationï¼ˆä¸‹é¢é‚£ä¸ªï¼‰ å’Œ HeroData_ShooterGameé‡Œé¢çš„</strong>AbilitySet_**ShooterHeroã€‚</p><ul><li>é¦–å…ˆçœ‹AbilitySet_Elimination  DAè¡¨ï¼ˆå®ƒç»§æ‰¿è‡ªLyraAbilitySetï¼‰ã€‚</li></ul><div style="text-align: center;"><img src="https://s2.loli.net/2025/11/21/khSfJeNB3I5Fvcq.png" alt="image-20251111171556976" width="50%" /></div><p>  æ‰“å¼€è¿™ä¸ªAbilitySet_Eliminationï¼Œé‡Œé¢åŒ…å«ä¸¤ä¸ªGAã€‚<br>  GA_ShowLeaderboard_TDMç”¨äºæŒ‰Tabæ˜¾ç¤ºè®¡åˆ†æ¿ã€‚<br>  GA_AutoRespawnç”¨äºæ­»äº¡å¤æ´»ï¼Œè¿™ä¸¤ä¸ªGAä¸Characteræˆ˜æ–—æ— å…³ï¼Œåœ¨æ²¡ç”¨Characteræ—¶ä¹Ÿèƒ½æ‰§è¡Œã€‚</p><ul><li>ç„¶åçœ‹AbilitySet_ShooterPistol DAè¡¨ï¼ˆå‚¨å­˜åœ¨æ€»è¡¨çš„HeroData_ShooterGameé‡Œé¢ å®ƒç»§æ‰¿è‡ªULyraPawnDataï¼‰</li></ul><div style="text-align: center;"><img src="https://s2.loli.net/2025/11/21/abXfUKiehOG3lHs.png" alt="image-20251111174500121" width="50%" /></div><div style="text-align: center;"><img src="https://s2.loli.net/2025/11/21/4Zt68goQNHmdsOk.png" alt="AbilitySet_ShooterHero" width="50%" /></div><p>  åŒ…å«Characterç›¸å…³çš„GAï¼Œæ•°é‡è¾ƒå¤šã€‚æ¯”å¦‚GA_Hero_Jumpå®ç°äº†è·³è·ƒï¼ŒGA_Emoteå®ç°äº†è·³èˆã€‚</p><ul><li>ç„¶åè¿˜æœ‰ä¸€ä¸ªAbilitySet_ShooterPisto</li></ul><div style="text-align: center;"><img src="https://s2.loli.net/2025/11/21/ls8hrwJVOjfkMZF.png" alt="image-20251111181356512" width="50%" /></div><p>  å®ƒä¸æ˜¯å®šä¹‰åœ¨B_BasicShooterTestB_BasicShooterTestè¿™å¼ å¤§è¡¨é‡Œé¢çš„ã€‚</p><p>  è€Œæ˜¯é€šè¿‡WID_Pistolè¢«å…·ä½“çš„è“å›¾è°ƒç”¨ã€‚</p><p>ç„¶åå¯¹æ¯ä¸ªGAï¼Œè°ƒç”¨UAbilitySystemComponent::GiveAbilityå‡½æ•°è¿›è¡Œèµ‹äºˆã€‚</p><div style="text-align: center;"><img src="https://s2.loli.net/2025/11/21/Je2w7BSxbQEapTV.png" alt="image-20251111185235151" style="zoom:25%;" / width="50%" /></div><p>ä¼šåœ¨å¾ˆå¤šåœ°æ–¹è°ƒç”¨ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">FGameplayAbilitySpecHandle <span class="title">UAbilitySystemComponent::GiveAbility</span><span class="params">(<span class="type">const</span> FGameplayAbilitySpec&amp; Spec)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">ABILITYLIST_SCOPE_LOCK</span>();</span><br><span class="line">    FGameplayAbilitySpec&amp; OwnedSpec = ActivatableAbilities.Items[ActivatableAbilities.Items.<span class="built_in">Add</span>(Spec)];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (OwnedSpec.Ability-&gt;<span class="built_in">GetInstancingPolicy</span>() == EGameplayAbilityInstancingPolicy::InstancedPerActor)</span><br><span class="line">    &#123;</span><br><span class="line">       <span class="comment">// Create the instance at creation time</span></span><br><span class="line">       <span class="built_in">CreateNewInstanceOfAbility</span>(OwnedSpec, Spec.Ability);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">OnGiveAbility</span>(OwnedSpec);</span><br><span class="line">    <span class="built_in">MarkAbilitySpecDirty</span>(OwnedSpec, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">UE_LOG</span>(LogAbilitySystem, Log, <span class="built_in">TEXT</span>(<span class="string">&quot;%s: GiveAbility %s [%s] Level: %d Source: %s&quot;</span>), *<span class="built_in">GetNameSafe</span>(<span class="built_in">GetOwner</span>()), *<span class="built_in">GetNameSafe</span>(Spec.Ability), *Spec.Handle.<span class="built_in">ToString</span>(), Spec.Level, *<span class="built_in">GetNameSafe</span>(Spec.SourceObject.<span class="built_in">Get</span>()));</span><br><span class="line">    <span class="built_in">UE_VLOG</span>(<span class="built_in">GetOwner</span>(), VLogAbilitySystem, Log, <span class="built_in">TEXT</span>(<span class="string">&quot;GiveAbility %s [%s] Level: %d Source: %s&quot;</span>), *<span class="built_in">GetNameSafe</span>(Spec.Ability), *Spec.Handle.<span class="built_in">ToString</span>(), Spec.Level, *<span class="built_in">GetNameSafe</span>(Spec.SourceObject.<span class="built_in">Get</span>()));</span><br><span class="line">    <span class="keyword">return</span> OwnedSpec.Handle;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‡½æ•°å‚æ•°ä¸ºFGameplayAbilitySpecï¼Œè¡¨ç¤ºâ€œè¿™æ¬¡èµ‹äºˆâ€çš„æè¿°ä¿¡æ¯ã€‚</p><p>ä¸ä»…åŒ…å«è¿™æ¬¡èµ‹äºˆçš„æè¿°ä¿¡æ¯ï¼Œæ¯”å¦‚GAçš„Classï¼ŒæŒ‡å®šGAçš„ç­‰çº§ï¼ŒGAç»‘å®šçš„è¾“å…¥Tagã€‚è€Œä¸”ä¹Ÿæ˜¯GAåœ¨ASCä¸Šçš„runtimeè¡¨ç¤ºï¼Œæœ‰å¾ˆå¤šruntimeä¿¡æ¯ã€‚æ¯ä¸ªSpecéƒ½æœ‰å”¯ä¸€çš„IDï¼Œç§°ä¸ºHandleï¼Œé€šè¿‡è‡ªå¢èµ‹äºˆï¼Œå„ç³»ç»Ÿé—´Specçš„ä¼ é€’éƒ½é€šè¿‡Handleå®ç°ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯Spec.SourceObjectå±æ€§ï¼Œè¡¨ç¤ºè¿™ä¸ªGAæ‰€å…³è”çš„æœ€â€œå¯†åˆ‡â€çš„Objectï¼Œåœ¨åˆ›å»ºæ—¶ç”±æˆ‘ä»¬æŒ‡å®šã€‚<br>æ¯”å¦‚GA_Weapon_Fire_Pistolï¼Œæ˜¯æªå¼€ç«çš„GAï¼ŒSourceObjectå°±æ˜¯æ­¦å™¨B_WeaponInstance_Pistolï¼›<br>GA_Hero_Jumpæ˜¯è§’è‰²è·³è·ƒçš„GAï¼ŒSourceObejctå°±æ˜¯Characterï¼›<br>GA_ShowLeaderboard_TDMåˆ™æ˜¯ä¸æˆ˜æ–—æ— å…³çš„æ‰“å¼€è®¡åˆ†æ¿çš„GAï¼ŒOurceObjectå°±æ˜¯PlayerStatã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">USTRUCT(BlueprintType)</span><br><span class="line">struct GAMEPLAYABILITIES_API FGameplayAbilitySpec : public FFastArraySerializerItem</span><br><span class="line">&#123;</span><br><span class="line">GENERATED_USTRUCT_BODY()</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">    UPROPERTY(NotReplicated)</span><br><span class="line">    TArray&lt;TObjectPtr&lt;UGameplayAbility&gt;&gt; NonReplicatedInstances;</span><br><span class="line"></span><br><span class="line">    UPROPERTY()</span><br><span class="line">    TArray&lt;TObjectPtr&lt;UGameplayAbility&gt;&gt; ReplicatedInstances;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ·»åŠ æ—¶ï¼Œé¦–å…ˆæŠŠSpecåŠ å…¥åˆ°ActivatableAbilitiesæ•°ç»„ä¸­ï¼Œç„¶åæ ¹æ®Policyåˆ›å»ºä¸€ä¸ªGAçš„å®ä¾‹ï¼Œé»˜è®¤çš„InstancedPerActoræ˜¯è¦åˆ›å»ºçš„ã€‚åˆ›å»ºå®Œæˆåï¼Œå¦‚æœGAè®¾ç½®ä¸ºç½‘ç»œåŒæ­¥ï¼Œå°±åŠ å…¥åˆ°Spec.ReplicatedInstancesä¸­ï¼Œå¦åˆ™åŠ å…¥Spec.NonReplicatedInstancesã€‚</p><h5 id="æ³¨å†ŒTrigger"><a href="#æ³¨å†ŒTrigger" class="headerlink" title="æ³¨å†ŒTrigger"></a>æ³¨å†ŒTrigger</h5><p>GAå¯ä»¥ç»‘å®šä¸€äº›Triggerï¼Œå®é™…æ˜¯Tagï¼Œå½“å‘å‡ºGamePlayEventï¼Œå¹¶æŒ‡å®šå¯¹åº”Tagåï¼Œå°±èƒ½æ¿€æ´»GAäº†ã€‚</p><p>æ‰€ä»¥è¿™é‡Œçš„Tagä¸ºäº†æ›´æ–¹ä¾¿åšåˆ¤æ–­å…·ä½“çš„GAã€‚</p><ul><li>é¦–å…ˆæ˜¯InputTagï¼Œå®ƒæœ¬èº«éGASæ¡†æ¶å†…çš„ï¼Œæ˜¯Lyraè‡ªå·±åšçš„ä¸€å¥—è¾“å…¥å’ŒGAçš„æ˜ å°„ã€‚InputTagåœ¨AbilitySetä¸­æŒ‡å®š</li></ul><p><img src="https://s2.loli.net/2025/11/21/DQgqibLETr14JHR.png" alt="image-20251111191635777">AbilitySet_ShooterPisto</p><div style="text-align: center;"><img src="https://s2.loli.net/2025/11/21/FAmWtpUSy94lQez.png" alt="image-20251111191708052" width="50%" /></div><p>AbilitySet_ShooterPistol </p><div style="text-align: center;"><img src="https://s2.loli.net/2025/11/21/1yWC6gVZHb38UPz.png" alt="image-20251111191718509" width="50%" /></div><p>AbilitySet_ShooterPisto</p><p>åˆ›å»ºSpecæ—¶ä¼šæŠŠInputTagæ·»åŠ åˆ°å…¶DynamicSpecSourceTagsï¼ŒDynamicSpecSourceTagsæ˜¯ä¸€ä¸ªé€šç”¨Tagå®¹å™¨ã€‚<br>è¯¥Tagsåœ¨ç»“æ„ä½“FGameplayAbilitySpecé‡Œé¢ï¼Œ<u>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªFGameplayAbilitySpecä»£è¡¨çš„æ˜¯ä¼ é€’çš„ä¸€ä¸ªAbilityçš„èƒ½åŠ›ï¼Œç„¶åé‡Œé¢æœ‰å¾ˆå¤šDynamicAbilityTags</u>ã€‚</p><p>æ³¨å†Œçš„è·¯å¾„å¦‚ä¸‹ï¼š</p><div style="text-align: center;"><img src="https://s2.loli.net/2025/11/21/AzSXP7UNWFsfot1.png" alt="image-20251111205815528" width="50%" /></div><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">ULyraAbilitySet::GiveToAbilitySystem</span><span class="params">(ULyraAbilitySystemComponent* LyraASC, FLyraAbilitySet_GrantedHandles* OutGrantedHandles, UObject* SourceObject)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Grant the attribute sets.</span></span><br><span class="line">    <span class="keyword">for</span> (int32 SetIndex = <span class="number">0</span>; SetIndex &lt; GrantedAttributes.<span class="built_in">Num</span>(); ++SetIndex)</span><br><span class="line">    &#123;</span><br><span class="line">...</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Grant the gameplay abilities.</span></span><br><span class="line">    <span class="keyword">for</span> (int32 AbilityIndex = <span class="number">0</span>; AbilityIndex &lt; GrantedGameplayAbilities.<span class="built_in">Num</span>(); ++AbilityIndex)</span><br><span class="line">    &#123;</span><br><span class="line">       <span class="type">const</span> FLyraAbilitySet_GameplayAbility&amp; AbilityToGrant = GrantedGameplayAbilities[AbilityIndex];</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span> (!<span class="built_in">IsValid</span>(AbilityToGrant.Ability))</span><br><span class="line">       &#123;</span><br><span class="line">          <span class="built_in">UE_LOG</span>(LogLyraAbilitySystem, Error, <span class="built_in">TEXT</span>(<span class="string">&quot;GrantedGameplayAbilities[%d] on ability set [%s] is not valid.&quot;</span>), AbilityIndex, *<span class="built_in">GetNameSafe</span>(<span class="keyword">this</span>));</span><br><span class="line">          <span class="keyword">continue</span>;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       ULyraGameplayAbility* AbilityCDO = AbilityToGrant.Ability-&gt;<span class="built_in">GetDefaultObject</span>&lt;ULyraGameplayAbility&gt;();</span><br><span class="line"></span><br><span class="line">       <span class="function">FGameplayAbilitySpec <span class="title">AbilitySpec</span><span class="params">(AbilityCDO, AbilityToGrant.AbilityLevel)</span></span>;</span><br><span class="line">       AbilitySpec.SourceObject = SourceObject;</span><br><span class="line">       AbilitySpec.<span class="built_in">GetDynamicSpecSourceTags</span>().<span class="built_in">AddTag</span>(AbilityToGrant.InputTag);</span><br><span class="line"></span><br><span class="line">       <span class="type">const</span> FGameplayAbilitySpecHandle AbilitySpecHandle = LyraASC-&gt;<span class="built_in">GiveAbility</span>(AbilitySpec);</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span> (OutGrantedHandles)</span><br><span class="line">       &#123;</span><br><span class="line">          OutGrantedHandles-&gt;<span class="built_in">AddAbilitySpecHandle</span>(AbilitySpecHandle);</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Grant the gameplay effects.</span></span><br><span class="line">    <span class="keyword">for</span> (int32 EffectIndex = <span class="number">0</span>; EffectIndex &lt; GrantedGameplayEffects.<span class="built_in">Num</span>(); ++EffectIndex)</span><br><span class="line">    &#123;</span><br><span class="line">...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨æˆäºˆASC Abilityçš„æ—¶å€™ï¼Œå°†Tags Effectç­‰ä¿¡æ¯ä¸€å¹¶ä¼ å…¥ã€‚</p><p>æˆäºˆGAçš„é€»è¾‘ï¼Œä»¥ä¸Šå°±æ˜¯æœåŠ¡å™¨åˆå§‹åŒ–ASCå¹¶èµ‹äºˆGAçš„å…¨éƒ¨è¿‡ç¨‹ã€‚</p><div style="text-align: center;"><img src="https://s2.loli.net/2025/11/21/4H9xKOcQBbezAFY.png" alt="image-20251111210326498" width="50%" /></div><h4 id="åŒæ­¥å®¢æˆ·ç«¯"><a href="#åŒæ­¥å®¢æˆ·ç«¯" class="headerlink" title="åŒæ­¥å®¢æˆ·ç«¯"></a>åŒæ­¥å®¢æˆ·ç«¯</h4><h5 id="ASC"><a href="#ASC" class="headerlink" title="ASC"></a>ASC</h5><p>é¦–å…ˆï¼ŒASCä½œä¸ºä¸€ä¸ªComponentæŒ‚åœ¨PlayerStateä¸Šï¼Œæ˜¯å¯ä»¥åŒæ­¥çš„ã€‚</p><p>ç”±äºAvatarActoræ˜¯Characterï¼Œå› æ­¤OwnerActorå’ŒAvatarActorçš„æœ€ç»ˆè®¾ç½®ï¼Œéœ€è¦å®¢æˆ·ç«¯çš„Characteråˆ›å»ºåæ‰èƒ½æ‰§è¡Œã€‚</p><p>å…·ä½“ä¸ºCharacteråˆ›å»ºåï¼Œè§¦å‘LyraHeroComponentçš„åŠ è½½èµ„æºæµç¨‹ï¼Œå½“åŠ è½½å®Œæˆå¹¶ä¸”å®¢æˆ·ç«¯è·å–åˆ°PlayerStateåï¼Œå°±æŠŠå½“å‰é˜¶æ®µè®¾ç½®ä¸ºDataAvailabeï¼Œå¹¶æœ€ç»ˆè®¾ç½®OwnerActorå’ŒAvatarActorã€‚</p><h5 id="GASpec"><a href="#GASpec" class="headerlink" title="GASpec"></a>GASpec</h5><p>Specå­˜äºActivatableAbilitieså®¹å™¨ä¸­ï¼Œæœ¬èº«æ˜¯FastArrayï¼Œæ ‡è®°äº†Replicatedï¼Œå¯æ­£å¸¸ç½‘ç»œåŒæ­¥</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UPROPERTY</span>(ReplicatedUsing = OnRep_ActivateAbilities, BlueprintReadOnly, Transient, Category = <span class="string">&quot;Abilities&quot;</span>)</span><br><span class="line">FGameplayAbilitySpecContainer ActivatableAbilities;</span><br></pre></td></tr></table></figure><p>SpecåŒæ­¥åˆ°å®¢æˆ·ç«¯åï¼ŒFastArrayä¼šè§¦å‘FGameplayAbilitySpec::PostReplicatedAdd()æ–¹æ³•ï¼Œé‡Œé¢å†å’ŒæœåŠ¡å™¨åŒæ ·çš„UAbilitySystemComponent::OnGiveAbility()æ–¹æ³•æ¥æ³¨å†ŒSpecã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">FGameplayAbilitySpec::PostReplicatedAdd</span><span class="params">(<span class="type">const</span> <span class="keyword">struct</span> FGameplayAbilitySpecContainer&amp; InArraySerializer)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (InArraySerializer.Owner)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">        InArraySerializer.Owner-&gt;<span class="built_in">OnGiveAbility</span>(*<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äºä¸åŒæ­¥ä½†InstancedPerActorçš„GAï¼Œä¼šåœ¨æ­¤æ—¶åˆ›å»ºå®ä¾‹ï¼ŒåŠ å…¥åˆ°NonReplicatedInstancesæ•°ç»„ï¼Œç„¶åå†æ³¨å†ŒAbilityTriggersã€‚</p><h5 id="Specçš„GAå®ä¾‹"><a href="#Specçš„GAå®ä¾‹" class="headerlink" title="Specçš„GAå®ä¾‹"></a>Specçš„GAå®ä¾‹</h5><p>é¦–å…ˆï¼ŒGAå®ä¾‹åªåŒæ­¥ç»™Autonomouså®¢æˆ·ç«¯ï¼Œä¸ä¼šåŒæ­¥ç»™SimulateProxyã€‚ç„¶åï¼Œä¼šæŠŠGAå®ä¾‹ä½œä¸ºASCçš„SubObjectè¿›è¡ŒåŒæ­¥ï¼Œè¿™æ˜¯SubObjectåŒæ­¥æ˜¯UEè‡ªèº«æ”¯æŒçš„æœºåˆ¶ã€‚</p><p>ä¸»è¦ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åŒæ­¥GA</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAbilitySystemComponent::AddReplicatedInstancedAbility</span><span class="params">(UGameplayAbility* GameplayAbility)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">    <span class="type">const</span> ELifetimeCondition LifetimeCondition = bReplicateAbilitiesToSimulatedProxies ? COND_None : COND_ReplayOrOwner;</span><br><span class="line">    <span class="built_in">AddReplicatedSubObject</span>(GameplayAbility, LifetimeCondition);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//SubObjectåŒæ­¥</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UActorComponent::AddReplicatedSubObject</span><span class="params">(UObject* SubObject, ELifetimeCondition NetCondition)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (AActor* MyOwner=<span class="built_in">GetOwner</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        MyOwner-&gt;<span class="built_in">AddActorComponentReplicatedSubObject</span>(<span class="keyword">this</span>, SubObject, NetCondition);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒæ­¥åˆ°å®¢æˆ·ç«¯åè¡¨ç°å¦‚ä¸‹ï¼š</p><div style="text-align: center;"><img src="https://pic2.zhimg.com/v2-64548e8ebc3b26b89cb095f2c552d39d_1440w.jpg" alt="img" width="50%" /></div><h2 id="å¸¸ç”¨è°ƒæ•´å‘½ä»¤è¡Œ"><a href="#å¸¸ç”¨è°ƒæ•´å‘½ä»¤è¡Œ" class="headerlink" title="å¸¸ç”¨è°ƒæ•´å‘½ä»¤è¡Œ"></a>å¸¸ç”¨è°ƒæ•´å‘½ä»¤è¡Œ</h2><p>ShowDebug AbilitySystem å±•ç¤ºAbilityç›¸å…³çš„å†…å®¹</p><h2 id="è¸©å‘è®°å½•"><a href="#è¸©å‘è®°å½•" class="headerlink" title="è¸©å‘è®°å½•"></a>è¸©å‘è®°å½•</h2><h3 id="GASç½‘ç»œç”Ÿæˆçš„BPéœ€è¦è€ƒè™‘æ‰€æœ‰è€…"><a href="#GASç½‘ç»œç”Ÿæˆçš„BPéœ€è¦è€ƒè™‘æ‰€æœ‰è€…" class="headerlink" title="GASç½‘ç»œç”Ÿæˆçš„BPéœ€è¦è€ƒè™‘æ‰€æœ‰è€…"></a>GASç½‘ç»œç”Ÿæˆçš„BPéœ€è¦è€ƒè™‘æ‰€æœ‰è€…</h3><p><img src="https://s2.loli.net/2025/11/21/YdyXqrBw7hKoGuT.png" alt="image-20251114160307855" style="zoom:25%;" /><img src="https://s2.loli.net/2025/11/21/KmIpqniL5s7ESuj.png" alt="image-20251114160401410" style="zoom: 33%;" /></p><p>å¦‚æœæ˜¯åœ¨Serverç«¯ç”Ÿæˆçš„BPï¼Œä¸€å®šè¦æŒ‡å®šâ€œOwnerâ€ï¼Œå®ƒæ„å‘³ç€æ˜¯è¿™ä¸ªç”Ÿæˆçš„ä¸œè¥¿åœ¨å„ç½‘ç»œè®¾å¤‡ä¹‹é—´æŒ‡å®šçš„æ‰€æœ‰è€…ã€‚<br>å½“è¿™ä¸ªæ‰€æœ‰è€…å†…éƒ¨éœ€è¦æ‰§è¡Œä¸€ä¸ªç½‘ç»œçš„Eventçš„æ—¶å€™ï¼Œå®ƒéœ€è¦é€šçŸ¥ä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œå¦‚æœæ²¡æœ‰Ownerï¼Œè¿™ä¸ªEventä¼šè¢«æ‹’ç»æ‰§è¡Œã€‚</p><h3 id="éšæœºæ•°é—®é¢˜"><a href="#éšæœºæ•°é—®é¢˜" class="headerlink" title="éšæœºæ•°é—®é¢˜"></a>éšæœºæ•°é—®é¢˜</h3><p>æ³¨æ„ç½‘ç»œç«¯å’ŒæœåŠ¡ç«¯ç”Ÿæˆéšæœºæ•°ä¼šä¸ä¸€æ ·ã€‚</p><h3 id="åœ¨GEé‡Œæ‹¿åˆ°â€œäº‹ä»¶è§¦å‘è€…â€å’Œâ€œäº‹ä»¶è¢«å½±å“è€…â€"><a href="#åœ¨GEé‡Œæ‹¿åˆ°â€œäº‹ä»¶è§¦å‘è€…â€å’Œâ€œäº‹ä»¶è¢«å½±å“è€…â€" class="headerlink" title="åœ¨GEé‡Œæ‹¿åˆ°â€œäº‹ä»¶è§¦å‘è€…â€å’Œâ€œäº‹ä»¶è¢«å½±å“è€…â€"></a>åœ¨GEé‡Œæ‹¿åˆ°â€œäº‹ä»¶è§¦å‘è€…â€å’Œâ€œäº‹ä»¶è¢«å½±å“è€…â€</h3><div style="text-align: center;"><img src="https://s2.loli.net/2025/11/21/D9VA2s5EpevFXxL.png" alt="image-20251120172105945" width="50%" /></div><p>å¦‚ä¸Šå›¾ï¼Œæˆ‘æœ‰ä¸€ä¸ªéœ€æ±‚ï¼ŒæŠ•æ·ç‰©ã€‚<br>éœ€è¦ç»™GEä¼ é€’â€œæŠ•æ·ç‰©è¿™ä¸ªç‰©ä½“â€å’Œâ€œè¢«æ’çš„äººâ€ã€‚<br>å…¶ä¸­ï¼Œåœ¨æˆ‘è¿™é‡Œï¼Œâ€œè¢«æ’çš„äººâ€æ˜¯è¦æ‰§è¡Œçš„ASCçš„æ‰€æœ‰è€…ï¼ˆå³è¿™é‡Œçš„Instigatorï¼‰ï¼Œåœ¨åº”ç”¨GEçš„æ—¶å€™å¿…é¡»æä¾›ã€‚</p><p>è°ƒç”¨ BP_ApplyGameplayEffectToTarget æ—¶ï¼Œå®ƒå†…éƒ¨ä¼šï¼š</p><ul><li>ç”¨ã€Œä½œä¸º Target çš„ ASC çš„ Owner &#x2F; Avatar Actorã€æ¥æ„é€  FGameplayEffectContextHandleï¼›</li><li>åœ¨è¿™ä¸ª EffectContext é‡Œè‡ªåŠ¨å¡«å¥½ Instigatorã€EffectCauser ç­‰å­—æ®µï¼›</li><li>æŠŠè¿™ä¸ª EffectContext æ”¾è¿› FGameplayEffectSpecï¼Œæœ€ååº”ç”¨åˆ° Targetï¼›</li></ul><p>ï¼ˆæ­£å¦‚å›¾ä¸Šæ‰€ç¤ºï¼Œå®ƒå…¶å®æœ‰ä¸¤ä¸ªTargetèŠ‚ç‚¹ï¼Œä¸Šé¢é‚£ä¸ªæ˜¯è°ƒç”¨è¿™ä¸ªäº‹ä»¶çš„Targetï¼ˆè“å›¾ä¸­å¸¸è§ï¼‰ï¼Œä¸‹é¢é‚£ä¸ªæ˜¯è¢«å‘½ä¸­çš„â€œè¢«æ’çš„äººâ€ï¼Œå› ä¸ºç¢°å·§éƒ½å«Targetæ‰€ä»¥åœ¨è¿™é‡Œé‡å¤äº†ï¼‰</p><p>è¿™ä¸ªæ¯”è¾ƒå¥½ç†è§£ã€‚ä½†ï¼Œå®é™…ä¸ŠGCä¸€ä¸ªå†…éƒ¨ç»“æ„é‡Œï¼Œæœ‰ä¸‰ä¸ªå‚¨å­˜ç”¨æ¥è¡¨è¾¾â€œäº‹ä»¶è´£ä»»ç›¸å…³äººâ€çš„å˜é‡ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">USTRUCT</span>(BlueprintType, meta = (HasNativeBreak = <span class="string">&quot;/Script/GameplayAbilities.AbilitySystemBlueprintLibrary.BreakGameplayCueParameters&quot;</span>, HasNativeMake = <span class="string">&quot;/Script/GameplayAbilities.AbilitySystemBlueprintLibrary.MakeGameplayCueParameters&quot;</span>))</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">FGameplayCueParameters</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">GENERATED_USTRUCT_BODY</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** Instigator actor, the actor that owns the ability system component */</span></span><br><span class="line">    <span class="built_in">UPROPERTY</span>(BlueprintReadWrite, Category=GameplayCue)</span><br><span class="line">    TWeakObjectPtr&lt;AActor&gt; Instigator;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** The physical actor that actually did the damage, can be a weapon or projectile */</span></span><br><span class="line">    <span class="built_in">UPROPERTY</span>(BlueprintReadWrite, Category=GameplayCue)</span><br><span class="line">    TWeakObjectPtr&lt;AActor&gt; EffectCauser;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** Object this effect was created from, can be an actor or static object. Useful to bind an effect to a gameplay object */</span></span><br><span class="line">    <span class="built_in">UPROPERTY</span>(BlueprintReadWrite, Category=GameplayCue)</span><br><span class="line">    TWeakObjectPtr&lt;<span class="type">const</span> UObject&gt; SourceObject;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨æ–‡ä»¶UE_5.6\Engine\Plugins\Runtime\GameplayAbilities\Source\GameplayAbilities\Public\GameplayEffectTypes.hä¸­</p><p>è¿™ä¸‰ä¸ªåˆ†åˆ«æ˜¯ï¼šInstigatorã€EffectCauserã€SourceObjectã€‚</p><p>æŒ‰ç…§è¯´æ˜ï¼Œä»–ä»¬â€œè´£ä»»â€åˆ†åˆ«çš„ä½œç”¨æ˜¯</p><ul><li>Instigatorï¼šè°æ˜¯ã€Œæ–½åŠ è¿™ä¸ªæ•ˆæœçš„æ§åˆ¶è€…ã€ï¼Œé€šå¸¸æ˜¯ Pawn&#x2F;Characterã€‚</li><li>EffectCauserï¼šæ˜¯å“ªä¸€ä¸ª Actor&#x2F;Componentã€Œå…·ä½“é€ æˆäº†è¿™æ¬¡æ•ˆæœã€ï¼Œæ¯”å¦‚æ­¦å™¨ã€æŠ•æ·ç‰©ã€‚</li><li>SourceObjectï¼šä¸€ä¸ªå®Œå…¨å¼€æ”¾ç»™ä½ ç”¨çš„ UObject*ï¼Œå¯ä»¥æ˜¯æ­¦å™¨å®ä¾‹ã€æŠ€èƒ½å®ä¾‹ã€DataAssetã€æŠ•æ·ç‰©ç­‰ã€‚</li></ul><p>è¿™ä¸‰ä¸ªå­—æ®µçš„å€¼ï¼Œä¸ä¸€å®šéƒ½æœ‰ï¼Œæ˜¯å¦è‡ªåŠ¨å¡«ï¼Œå–å†³äºä½ èµ°çš„ GAS è°ƒç”¨è·¯å¾„ã€‚é€šå¸¸åº”ç”¨çš„è·¯å¾„ä¸Šï¼ŒInstigatorå’ŒEffectCauseréƒ½æ˜¯åŒä¸€ä¸ªå€¼ï¼Œéƒ½æ˜¯è¿™ä¸ªASCçš„æ‹¥æœ‰è€…ã€‚ä½†æ˜¯SourceObjecté€šå¸¸æ˜¯ç©ºçš„ï¼ˆé€šè¿‡GAä¸»åŠ¨å’Œè§¦å‘çš„GEæœ‰æœºä¼šæŠŠGAçš„SourceObejctä¼ å…¥è¿›å»ï¼‰ï¼Œæ‰€ä»¥å¯ä»¥è‡ªå·±æŒ‡å®šï¼Œç”¨ä½œè‡ªå·±çš„å‚æ•°ã€‚</p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ol><li><p><a href="https://www.bilibili.com/video/BV1X5411V7jh/">å®˜æ–¹æ•™å­¦è§†é¢‘</a>:æˆ‘çœ‹ç€è¿™ä¸ªè§†é¢‘ä½œä¸ºæœ€åˆçš„å…¥é—¨</p></li><li><p><a href="https://zhuanlan.zhihu.com/p/486808688">çŸ¥ä¹GASç³»ç»Ÿå¿«é€Ÿå…¥é—¨</a></p></li><li><p><a href="https://dev.epicgames.com/documentation/zh-cn/unreal-engine/gameplay-ability-system-for-unreal-engine">Unrealå®˜æ–¹çš„GASè®²è§£</a></p></li><li><p><a href="https://www.bilibili.com/video/BV1vj4vzkELp?spm_id_from=333.788.player.switch&vd_source=60b376a57ab956cf81ad81ef20747a92&p=14">å…³äºGAçš„è®²è§£</a>ï¼šåˆ«å¿˜äº†å¯ä»¥ç‚¹å¼€Bç«™çš„AIç¿»è¯‘</p></li><li><p><a href="https://www.bilibili.com/video/BV1Nv42127HS">ä¸€ä¸ªå¾ˆä¸é”™çš„å…³äº</a>GASç³»ç»Ÿå®æ“è®²è§£</p></li><li><p><a href="https://www.bilibili.com/video/BV1K7421Z7vm/">ä¸€ä¸ªå¾ˆä¸é”™çš„Lyraç¤ºä¾‹çš„è®²è§£</a></p></li><li><p><a href="https://zhuanlan.zhihu.com/p/1934717850632823338">æ–‡å­—è®²è§£Lyraç»“æ„</a>é€‚åˆä½œä¸ºç ”ç©¶åŸºç¡€ï¼Œç„¶åé…åˆä¸Šé¢çš„è§†é¢‘çœ‹ã€‚</p></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Unreal-GASç³»ç»Ÿä½¿ç”¨å­¦ä¹ &quot;&gt;&lt;a href=&quot;#Unreal-GASç³»ç»Ÿä½¿ç”¨å­¦ä¹ &quot; class=&quot;headerlink&quot; title=&quot;Unreal GASç³»ç»Ÿä½¿ç”¨å­¦ä¹ &quot;&gt;&lt;/a&gt;Unreal GASç³»ç»Ÿä½¿ç”¨å­¦ä¹ &lt;/h1&gt;&lt;h2 id=&quot;å‰ç½®çŸ¥è¯†&quot;&gt;&lt;a </summary>
      
    
    
    
    
    <category term="Unreal Engine" scheme="http://example.com/tags/Unreal-Engine/"/>
    
    <category term="Game Development" scheme="http://example.com/tags/Game-Development/"/>
    
    <category term="Gameplay Ability System" scheme="http://example.com/tags/Gameplay-Ability-System/"/>
    
    <category term="GAS" scheme="http://example.com/tags/GAS/"/>
    
    <category term="C++" scheme="http://example.com/tags/C/"/>
    
    <category term="Network Programming" scheme="http://example.com/tags/Network-Programming/"/>
    
    <category term="RPG" scheme="http://example.com/tags/RPG/"/>
    
    <category term="Game Framework" scheme="http://example.com/tags/Game-Framework/"/>
    
  </entry>
  
  <entry>
    <title>Aximmetry Learning Notes</title>
    <link href="http://example.com/2025/09/13/Aximmetry/"/>
    <id>http://example.com/2025/09/13/Aximmetry/</id>
    <published>2025-09-13T04:34:56.000Z</published>
    <updated>2025-12-02T05:58:13.960Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Aximmetry-ä½æˆæœ¬XRæ–¹æ¡ˆæŠ˜è…¾ç¬”è®°"><a href="#Aximmetry-ä½æˆæœ¬XRæ–¹æ¡ˆæŠ˜è…¾ç¬”è®°" class="headerlink" title="Aximmetry ä½æˆæœ¬XRæ–¹æ¡ˆæŠ˜è…¾ç¬”è®°"></a>Aximmetry ä½æˆæœ¬XRæ–¹æ¡ˆæŠ˜è…¾ç¬”è®°</h1><h2 id="é¡¹ç›®èƒŒæ™¯"><a href="#é¡¹ç›®èƒŒæ™¯" class="headerlink" title="é¡¹ç›®èƒŒæ™¯"></a>é¡¹ç›®èƒŒæ™¯</h2><p>æˆ‘éœ€è¦æ­å»ºå‡ºä¸€å¥—éå¸¸ä½æˆæœ¬çš„XRæ–¹æ¡ˆï¼Œè°ƒç ”çš„æ—¶å€™è€ƒè™‘å›½å†…ä¸€äº›è‡ªç ”æ–¹æ¡ˆï¼Œä»¥åŠHecoosç­‰ä¸»æµæ–¹æ¡ˆï¼Œæµ‹è¯•æœŸæš‚æ—¶ä½¿ç”¨Aximmetryä½œä¸ºæ¼”ç¤ºæ–¹æ¡ˆã€‚ä»¥ä¸‹æ˜¯Aximmetryåœ¨æœ¬æ¬¡æµ‹è¯•ä¸­æ‰€ä½¿ç”¨åˆ°çš„å†…å®¹ã€‚</p><h3 id="å„ç‰ˆæœ¬ä¹‹é—´çš„åŒºåˆ«"><a href="#å„ç‰ˆæœ¬ä¹‹é—´çš„åŒºåˆ«" class="headerlink" title="å„ç‰ˆæœ¬ä¹‹é—´çš„åŒºåˆ«"></a>å„ç‰ˆæœ¬ä¹‹é—´çš„åŒºåˆ«</h3><ol><li><strong>Studio Edition</strong>ï¼ˆå·¥ä½œå®¤ç‰ˆï¼‰ï¼šé€‚åˆéå¸¸å°çš„æˆ–å®¶åº­å·¥ä½œå®¤ï¼Œå¦‚ YouTube åˆ›ä½œè€…ç­‰ã€‚è¯¥ç‰ˆæœ¬å¯é€šè¿‡ HDMI æˆ– USB é‡‡é›†è®¾å¤‡åœ¨ä¸€å° PC ä¸Šä½¿ç”¨å¤šä¸ªæ‘„åƒå¤´ï¼Œå¯é€šè¿‡æ˜¾å¡çš„ HDMI&#x2F;DP&#x2F;DVI ç«¯å£ç”Ÿæˆä¸€ä¸ªæˆ–å¤šä¸ªè§†é¢‘è¾“å‡ºï¼Œè¿˜å¯ç›´æ¥å°†è¾“å‡ºæµå¼ä¼ è¾“åˆ° YouTubeã€Facebookã€Twitch æˆ–ä»»ä½•åŸºäº RTMP çš„è§†é¢‘æœåŠ¡ã€‚å¸¦æ°´å°çš„ Studio ç‰ˆæœ¬å¯æ— é™æœŸç”¨äºéå•†ä¸šç”¨é€”ï¼Œä¹Ÿå¯é€šè¿‡è®¢é˜…è®¡åˆ’å»é™¤æ°´å°ã€‚</li><li><strong>Professional Edition</strong>ï¼ˆä¸“ä¸šç‰ˆï¼‰ï¼šé€‚ç”¨äºå°å‹ä¸“ä¸šå·¥ä½œå®¤ï¼Œæ”¯æŒåœ¨ä¸€å° PC ä¸Šæœ€å¤šä½¿ç”¨ 4 ä¸ª SDI&#x2F;ndi è¾“å…¥ &#x2F; è¾“å‡ºç«¯å£ï¼Œå¦‚ 3 ä¸ª SDI æ‘„åƒæœºè¾“å…¥å’Œ 1 ä¸ª SDI å¤åˆè¾“å‡ºï¼Œä¸”ä¸éœ€è¦ä»»ä½•æ‘„åƒæœºè·Ÿè¸ªè§£å†³æ–¹æ¡ˆï¼Œä»…ä½¿ç”¨å›ºå®šæ‘„åƒæœºä¸è™šæ‹Ÿæ‘„åƒæœºè¿åŠ¨ã€‚</li><li><strong>Broadcast Edition</strong>ï¼ˆå¹¿æ’­ç‰ˆï¼‰ï¼šé€‚ç”¨äºéœ€è¦æ‘„åƒæœºè·Ÿè¸ªåŠŸèƒ½çš„ä¸“ä¸šå·¥ä½œå®¤ï¼Œå¯åœ¨ä¸€å° PC ä¸Šè®¾ç½®æ— é™æ•°é‡çš„ SDI&#x2F;ndi è¾“å…¥ &#x2F; è¾“å‡ºç«¯å£ï¼ˆä»…å—ç¡¬ä»¶æ€§èƒ½é™åˆ¶ï¼‰ï¼Œä¹Ÿå¯åœ¨å¤š PC é…ç½®ä¸­ä½¿ç”¨ã€‚æ­¤å¤–ï¼Œå¹¿æ’­ç‰ˆè¿˜å…·å¤‡å…ˆè¿›çš„æ··åˆç°å®è§£å†³æ–¹æ¡ˆï¼Œæ”¯æŒå¤šæ‘„åƒæœºè·Ÿè¸ªã€è¡Œä¸šæ ‡å‡†çš„è‰²åº¦é”®æ§å™¨ã€é«˜è´¨é‡å®æ—¶å›¾å½¢ã€æ‘„åƒæœºåç§»å’Œé•œå¤´ç•¸å˜çš„è‡ªåŠ¨æ ¡å‡†ç­‰åŠŸèƒ½ã€‚</li></ol><h2 id="å®‰è£…ä½¿ç”¨"><a href="#å®‰è£…ä½¿ç”¨" class="headerlink" title="å®‰è£…ä½¿ç”¨"></a>å®‰è£…ä½¿ç”¨</h2><h3 id="ä½¿ç”¨ç¯å¢ƒçš„åŸºæœ¬å†…å®¹"><a href="#ä½¿ç”¨ç¯å¢ƒçš„åŸºæœ¬å†…å®¹" class="headerlink" title="ä½¿ç”¨ç¯å¢ƒçš„åŸºæœ¬å†…å®¹"></a>ä½¿ç”¨ç¯å¢ƒçš„åŸºæœ¬å†…å®¹</h3><table><thead><tr><th align="center">è½¯ä»¶åå­—</th><th align="center">ç‰ˆæœ¬</th><th align="left">å¤‡æ³¨</th></tr></thead><tbody><tr><td align="center">Aximmetry Composer</td><td align="center"><img src="https://s2.loli.net/2025/10/10/lEkaSNv1s2z4dqC.png" alt="image-20251009155943445" style="zoom: 20%;" /></td><td align="left">è¿™ä¸ªè½¯ä»¶æ˜¯ä¸»è¦ç”¨æ¥åšåˆæˆå’Œæ¥æ”¶è·Ÿè¸ªå†…å®¹çš„</td></tr><tr><td align="center">Aximmetry UE</td><td align="center"><img src="https://s2.loli.net/2025/10/10/KUfiXBt4mxwEL8Z.png" alt="image-20251009160407488" style="zoom:20%;" /></td><td align="left">Aximmetryè‡ªå·±æ”¹çš„UEï¼Œä»–ä»¬æœ‰ä¿®æ”¹æ¸²æŸ“ç®¡çº¿ï¼ˆç›®æµ‹æ˜¯ä¸ºäº†åŠ æ°´å°ï¼‰ã€‚ä»–ä»¬è¯¥ç‰ˆæœ¬çš„å¼•æ“æ˜¯åŸºäºUE5.5è¿›è¡Œä¿®æ”¹çš„ã€‚å¯ä»¥çœ‹åˆ°åœ¨å¼•æ“çš„æ’ä»¶ç›®å½•é‡Œæœ‰ä¸¤ä¸ªæ’ä»¶ã€‚æœ‰æºç ä¹Ÿæ²¡æœ‰å¼•å…¥å¤–éƒ¨çš„åº“ã€‚ä½†æ˜¯Aximmetryä¿®æ”¹äº†æ¸²æŸ“ç®¡çº¿ï¼ŒçŒœæµ‹æ˜¯é˜²æ­¢ç›—ç‰ˆã€‚</td></tr><tr><td align="center">UEå·¥ç¨‹</td><td align="center">5.5</td><td align="left">ä¸€ä¸ªä½¿ç”¨Aximmetry UEåˆ¶ä½œçš„åœºæ™¯ã€‚å»ºè®®åˆ›å»ºä¸€ä¸ª5.5çš„åŸå§‹çš„UEå·¥ç¨‹ï¼Œæ–¹ä¾¿å°†æ’ä»¶é‡æ–°ç¼–è¯‘åŠæµ‹è¯•æ’ä»¶ã€‚</td></tr></tbody></table><h3 id="å»ºç«‹åŸºæœ¬çš„å·¥ç¨‹"><a href="#å»ºç«‹åŸºæœ¬çš„å·¥ç¨‹" class="headerlink" title="å»ºç«‹åŸºæœ¬çš„å·¥ç¨‹"></a>å»ºç«‹åŸºæœ¬çš„å·¥ç¨‹</h3><h4 id="è¿›å…¥å·¥ç¨‹çš„è®¾ç½®"><a href="#è¿›å…¥å·¥ç¨‹çš„è®¾ç½®" class="headerlink" title="è¿›å…¥å·¥ç¨‹çš„è®¾ç½®"></a>è¿›å…¥å·¥ç¨‹çš„è®¾ç½®</h4><div align="center"><img src="https://s2.loli.net/2025/10/10/knatfO9CcYjvASd.png" alt="image-20251009155003718" style="zoom: 20%;" /></div><p>åœ¨Composerçš„å¼€å§‹è®¾ç½®ä¸­ï¼Œä¸»è¦è€ƒè™‘è¾“å…¥çš„å†…å®¹ï¼ˆå·¦è¾¹çš„è¾“å…¥è®¾ç½®ï¼‰ï¼Œè¿™ä¸ªæ˜¯å®æ™¯çš„æ‹æ‘„ç›¸æœºã€‚è¾“å‡ºè§†é¢‘çš„å¤§å°ï¼ˆå³è¾¹çš„è¾“å‡ºè®¾ç½®ï¼‰ï¼Œè¿™ä¸ªæ˜¯æœ€ç»ˆè¾“å‡ºç”»é¢çš„è®¾ç½®ã€‚ä»¥åŠä¸‹é¢çš„UEæ¸²æŸ“è®¾ç½®ã€‚</p><h4 id="èŠ‚ç‚¹è®¾ç½®"><a href="#èŠ‚ç‚¹è®¾ç½®" class="headerlink" title="èŠ‚ç‚¹è®¾ç½®"></a>èŠ‚ç‚¹è®¾ç½®</h4><div align="center"><img src="https://s2.loli.net/2025/10/10/T4rdGiu85asXlDe.png" alt="image-20251009161750537" style="zoom: 20%;" /></div><ol><li>VirtualCamèŠ‚ç‚¹ï¼šå·¥ç¨‹é‡Œæ·»åŠ ä¸€ä¸ªé•œå¤´ï¼Œå¦‚å›¾è¿çº¿ã€‚</li><li>ä¸»èŠ‚ç‚¹ï¼šé‡Œé¢æ·»åŠ é•œå¤´å’Œå·¥ç¨‹ï¼Œå¹¶ä½¿ç”¨Liveæ¨¡å¼ã€‚</li><li>Greenï¼šæ·»åŠ æµ‹è¯•ç”¨åˆ°è§†é¢‘ç´ æï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªç»¿å¹•ç´ æï¼ŒAximmetryä¼šè‡ªåŠ¨å¯¹å…¶è¿›è¡ŒæŠ åƒã€‚</li><li>Camera Trackingï¼šç›¸æœºè¿½è¸ªèŠ‚ç‚¹ï¼Œè¿™é‡Œé¢çš„é€‰é¡¹å¾…ä¼šå„¿è¦<u>å¡«å†™ä¸ŠAximmetryEye</u></li></ol><p>å®Œæˆä¹‹åç‚¹å‡»Composerä¸Šé¢çš„PlayæŒ‰é’®ï¼Œä¸”è®©å·¥ç¨‹åœ¨ç¼–è¾‘å™¨çŠ¶æ€ä¸‹è¿è¡Œèµ·æ¥ï¼Œå°±ä¼šæœ‰åˆæˆçš„ç”»é¢äº†ã€‚</p><h4 id="è®¾ç½®UEå†…å®¹"><a href="#è®¾ç½®UEå†…å®¹" class="headerlink" title="è®¾ç½®UEå†…å®¹"></a>è®¾ç½®UEå†…å®¹</h4><div align="center"><img src="https://s2.loli.net/2025/10/27/7NWYjuvm6zro2ng.png" alt="image-20251011142232445" style="zoom: 20%;" /></div><p>åœ¨åœºæ™¯ä¸­æ·»åŠ ç›¸æœºã€‚</p><h3 id="è®¾ç½®ç›¸æœºè¿é•œ"><a href="#è®¾ç½®ç›¸æœºè¿é•œ" class="headerlink" title="è®¾ç½®ç›¸æœºè¿é•œ"></a>è®¾ç½®ç›¸æœºè¿é•œ</h3><h4 id="æ‰‹åŠ¨è®¾ç½®"><a href="#æ‰‹åŠ¨è®¾ç½®" class="headerlink" title="æ‰‹åŠ¨è®¾ç½®"></a>æ‰‹åŠ¨è®¾ç½®</h4><div align="center"><img src="https://s2.loli.net/2025/10/10/PUwAjTpJatG6O9s.png" alt="image-20250930144118468" style="zoom: 20%;" /></div><p>åœ¨è¿™é‡Œå¯ä»¥ç”¨æ¥è®¾ç½®ç›¸æœºçš„è¿åŠ¨å±æ€§ç­‰ä¿¡æ¯ã€‚Aå’ŒBä»£è¡¨ç€èµ·å§‹ç‚¹å’Œæœ€ç»ˆç‚¹ã€‚ç‚¹å‡»æœ€å·¦è¾¹çš„æŒ‰é’®å¯ä»¥è®©ç›¸æœºè¿åŠ¨èµ·æ¥ã€‚</p><p>ç‚¹å‡»â€œæ‘„å½±æœº&#x2F;æ¸²æŸ“è®¾ç½®â€çš„ç¼–è¾‘æ“ä½œï¼Œå¯ä»¥åœ¨Aximmetryçš„æ¸²æŸ“å‡ºæ¥çš„çª—å£ç”»é¢é‡Œï¼Œç›´æ¥æ‹–åŠ¨ç›¸æœºä½ç½®ã€‚ä½¿ç”¨â†‘â†“â†â†’æŒ‰é’®è°ƒæ•´ç›¸æœºåæ ‡ã€‚</p><h4 id="Iphoneç›¸æœºè·Ÿè¸ª"><a href="#Iphoneç›¸æœºè·Ÿè¸ª" class="headerlink" title="Iphoneç›¸æœºè·Ÿè¸ª"></a>Iphoneç›¸æœºè·Ÿè¸ª</h4><div align="center"><img src="https://s2.loli.net/2025/10/27/radVntHOELqgh2b.png" alt="image-20251013114229527" style="zoom: 20%;" /> <img src="https://s2.loli.net/2025/10/27/DR1TGPCjvgM3nqu.png" alt="image-20251013114601929" style="zoom: 20%;" /></div><p>åœ¨AppStoreï¼ˆIOSï¼‰ä¸‹è½½Aximmetry Eyeè¿™ä¸ªè½¯ä»¶ã€‚ç„¶åé€šè¿‡ç½‘çº¿<strong>æœ‰çº¿è¿æ¥</strong>ï¼ˆé‡ç‚¹ï¼Œæ— çº¿æˆ‘æµ‹è¯•æœ‰é—®é¢˜ï¼‰ï¼Œæœ€å¥½å¥—ä¸Šä¸€ä¸ªæ•£çƒ­å™¨ï¼ˆä¸ç„¶ï¼Œä¸€ä¼šå„¿æ‰‹æœºå°±çƒ«å¾—ä¸è¡Œç„¶åæ–­è¿äº†ï¼Œç„¶åæ•°æ®é£˜é€¸äº†ï¼‰ã€‚ç„¶ååœ¨è¿æ¥çš„æ—¶å€™ï¼Œé€‰æ‹©å‘é€Tracking Dataï¼ˆå¦‚å›¾ï¼‰å³å¯ï¼ˆå› ä¸ºå®é™…ä¸Šæˆ‘ä»¬åªéœ€è¦æ‘„å½±æœºå§¿æ€æ•°æ®ï¼‰ã€‚è¿æ¥å®Œæˆä¹‹åï¼Œå°±å¯ä»¥åœ¨Flowé¡µé¢Camera Trackingçš„èŠ‚ç‚¹ç»†èŠ‚é¢æ¿é‡Œé¢çœ‹åˆ°æ‰‹æœºè¿™ä¸ªé€‰é¡¹äº†ã€‚</p><div align="center"><img src="https://s2.loli.net/2025/10/27/Vc49YvN7KrCqOuP.png" alt="image-20251013203732954" style="zoom: 20%;" /></div><p><u>æ¯æ¬¡åˆå§‹åŒ–çš„æ—¶å€™Iphoneæ‰€åœ¨çš„ä½ç½®ä»¥åŠè½´å‘</u>ï¼Œå°±ä¼šè¢«å½“ä½œåœºæ™¯çš„ä¸­å¿ƒç‚¹ã€‚</p><ul><li>è¯·å‚çœ‹å‚è€ƒèµ„æ–™ï¼Œéƒ¨åˆ†æœ‰è§†é¢‘ã€‚</li></ul><h4 id="ç›¸æœºçš„FOVè®¾å®š"><a href="#ç›¸æœºçš„FOVè®¾å®š" class="headerlink" title="ç›¸æœºçš„FOVè®¾å®š"></a>ç›¸æœºçš„FOVè®¾å®š</h4><div align="center"><img src="https://s2.loli.net/2025/10/27/iSkpaB3lJKqGV2f.png" alt="image-20251013202543178" style="zoom: 20%;" /></div><p>FOVä¹Ÿå¯ä»¥è¿›è¡Œæ‰‹åŠ¨æ ‡å®šï¼Œä¸€èˆ¬ç›¸æœºä¸Šçš„é•œå¤´æ ‡å°ºä¸æ˜¯å¾ˆå‡†ã€‚<br>æ‰€ä»¥éœ€è¦ä¸€äº›ç²¾ç¡®çš„æ ‡å®šã€‚<br>å¯ä»¥åœ¨åˆæˆç”»é¢ä¸­ï¼Œå·¦å³&#x2F;ä¸Šä¸‹æ¨ªç§»ï¼šå¦‚æœè™šæ‹Ÿæ—‹è½¬é€Ÿåº¦æ¯”çœŸå®çš„å¿«ï¼Œé‚£ä¹ˆéœ€è¦å‡å°Zoomã€åä¹‹äº¦ç„¶ã€‚</p><h4 id="Iphoneå¤–å‚æ‰‹åŠ¨æ ‡å®š"><a href="#Iphoneå¤–å‚æ‰‹åŠ¨æ ‡å®š" class="headerlink" title="Iphoneå¤–å‚æ‰‹åŠ¨æ ‡å®š"></a>Iphoneå¤–å‚æ‰‹åŠ¨æ ‡å®š</h4><div align="center"><img src="https://s2.loli.net/2025/10/27/X8FjOHlqyeSdKvx.png" alt="image-20251027113433462" style="zoom: 20%;" /></div><p>é¦–å…ˆåœ¨ç›¸æœºçš„ä¸Šæ–¹å¢åŠ å¢åŠ ä¸€ä¸ªActorç‰©ä½“ï¼Œå‘½åä¸ºCameraLocationã€‚</p><p>Aximmetryçš„é€»è¾‘æ˜¯ ç›¸æœºç”Ÿæˆåœ¨åŸç‚¹ ç„¶å+-æ‰‹æœºAximmetry Eyeä¸Šçš„åç§»å€¼ï¼Œå°±æ˜¯ç›¸æœºåœ¨è¿è¡Œæ—¶å€™çš„ä½ç½®ã€‚</p><p>æ‰€ä»¥éœ€è¦åœ¨CameraLocationï¼Œä¿®æ”¹å…¶ä½ç½®ï¼Œè‡³å®é™…ä¸Šç‰©ç†ç›¸æœºè·ç¦»ä¸­å¿ƒåŸç‚¹çš„ä½ç½®ã€‚</p><h3 id="ç›¸æœºçš„æ ‡å®š"><a href="#ç›¸æœºçš„æ ‡å®š" class="headerlink" title="ç›¸æœºçš„æ ‡å®š"></a>ç›¸æœºçš„æ ‡å®š</h3><h4 id="åŸºç¡€æ¦‚å¿µ"><a href="#åŸºç¡€æ¦‚å¿µ" class="headerlink" title="åŸºç¡€æ¦‚å¿µ"></a>åŸºç¡€æ¦‚å¿µ</h4><p>ç›¸æœºæ ‡å®šçš„æ¦‚å¿µåŒ…æ‹¬ä¸¤éƒ¨åˆ†ï¼šé•œå¤´æ ‡å®šå’Œè·Ÿè¸ªæ ‡å®šã€‚</p><h6 id="é•œå¤´æ ¡å‡†çš„æ¦‚å¿µ"><a href="#é•œå¤´æ ¡å‡†çš„æ¦‚å¿µ" class="headerlink" title="é•œå¤´æ ¡å‡†çš„æ¦‚å¿µ"></a>é•œå¤´æ ¡å‡†çš„æ¦‚å¿µ</h6><p><strong>é•œå¤´æ ¡å‡†</strong>çš„æ¦‚å¿µæ˜¯ï¼Œæ¼”æ’­å®¤æ‘„åƒæœºé•œå¤´çš„å›ºæœ‰ç‰¹æ€§ï¼ˆ <em>ä¾‹å¦‚é•œå¤´ç•¸å˜ã€ä¸­å¿ƒåç§»ç­‰</em> ï¼‰å§‹ç»ˆä¼šå¯¼è‡´å›¾åƒåŠå…¶è‰²å½©å¤±çœŸï¼Œè€Œè™šæ‹Ÿæ‘„åƒæœºï¼ˆ <em>æ¼”æ’­å®¤æ‘„åƒæœºçš„è™šæ‹Ÿå¯¹åº”ç‰©</em> ï¼‰é»˜è®¤ä¼šå‘ˆç°å®Œç¾å›¾åƒï¼ˆ <em>å›¾åƒå’Œ&#x2F;æˆ–è‰²å½©å‡æ— ç•¸å˜</em> ï¼‰ã€‚é•œå¤´æ ¡å‡†çš„ç›®æ ‡æ˜¯å°†äºŒè€…ï¼ˆæ¼”æ’­å®¤æ‘„åƒæœºé•œå¤´ä¸è™šæ‹Ÿæ‘„å½±æœºï¼‰ç»Ÿä¸€åœ¨ä¸€èµ·ã€‚ï¼ˆç•¸å˜æ ¡å‡†ï¼‰</p><h6 id="è·Ÿè¸ªæ ¡å‡†çš„æ¦‚å¿µ"><a href="#è·Ÿè¸ªæ ¡å‡†çš„æ¦‚å¿µ" class="headerlink" title="è·Ÿè¸ªæ ¡å‡†çš„æ¦‚å¿µ"></a>è·Ÿè¸ªæ ¡å‡†çš„æ¦‚å¿µ</h6><p>è·Ÿè¸ªæ ¡å‡†çš„æ¦‚å¿µæ˜¯ï¼Œè·Ÿè¸ªç³»ç»Ÿåªèƒ½æµ‹é‡å…¶è·Ÿè¸ªè®¾å¤‡çš„ä½ç½®å’Œæ—‹è½¬ï¼Œè€Œè™šæ‹Ÿåˆ¶ä½œéœ€è¦æ¼”æ’­å®¤æ‘„åƒæœºæ— è§†å·®ç‚¹ï¼ˆ <em>é è¿‘æ‘„åƒæœºä¼ æ„Ÿå™¨</em> ï¼‰çš„ä½ç½®å’Œæ—‹è½¬ã€‚è·Ÿè¸ªæ ¡å‡†çš„ç›®æ ‡æ˜¯è®¡ç®—è¿™ä¸¤ä¸ªä½ç½®å’Œæ—‹è½¬ä¹‹é—´çš„å·®å¼‚ã€‚</p><h4 id="å·¥å…·ä»‹ç»"><a href="#å·¥å…·ä»‹ç»" class="headerlink" title="å·¥å…·ä»‹ç»"></a>å·¥å…·ä»‹ç»</h4><p><a href="https://aximmetry.com/learn/virtual-production-workflow/tracking/calibration/about-the-concept-of-camera-calibration/">å®˜ç½‘å¯¹äºæ ‡å®šå†…å®¹çš„æ€»ç»“</a>é‡Œé¢æåŠäº†Aximmetryæœ‰ä¸¤ä¸ªæ ‡å®šå·¥å…·ï¼š<a href="https://www.youtube.com/watch?v=Lb2BuzxM4h0">Basic Calibrator</a>å’ŒCamera Calibratorï¼Œåœ¨è½¯ä»¶è·¯å¾„ä¸‹å¯ä»¥çœ‹åˆ°è¿™ä¸¤ä¸ªå·¥å…·ã€‚</p><ul><li><a href="https://aximmetry.com/learn/virtual-production-workflow/tracking/calibration/basic-calibrator/">Basic Calibrator</a> æ‰‹åŠ¨æ ¡å‡†ç›¸æœºæˆ–è°ƒæ•´ç°æœ‰çš„æ ¡å‡†é…ç½®æ–‡ä»¶ã€‚</li><li><a href="https://aximmetry.com/learn/virtual-production-workflow/tracking/calibration/camera-calibrator/">Camera Calibrator</a> è‡ªåŠ¨æ ¡å‡†ç›¸æœºã€‚</li></ul><div align="center"><img src="https://s2.loli.net/2025/10/10/kstDo52JFy1ATgE.png" alt="image-20251009165746851" style="zoom: 20%;" /> <img src="https://s2.loli.net/2025/10/10/gc4PLZmDqfJalM2.png" alt="image-20251009165932446" style="zoom: 20%;" /></div><h5 id="Basic-Calibrator"><a href="#Basic-Calibrator" class="headerlink" title="Basic Calibrator"></a>Basic Calibrator</h5><p>Basic Calibrator æ˜¯ Aximmetry æä¾›çš„æ‰‹åŠ¨ç›¸æœºæ ¡å‡†å·¥å…·ï¼Œç”¨äºè°ƒæ•´ç›¸æœºçš„å†…å¤–å‚æ•°ï¼Œç¡®ä¿è™šæ‹Ÿåœºæ™¯ä¸çœŸå®æ‘„åƒæœºçš„é€è§†å’Œè¿åŠ¨ä¿æŒä¸€è‡´ã€‚</p><p><strong>å®˜æ–¹æ•™ç¨‹</strong>ï¼š<a href="https://www.youtube.com/watch?v=Lb2BuzxM4h0">Aximmetry Basic Calibrator Tutorial</a></p><h6 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h6><ul><li><strong>Zï¼ˆZoomï¼‰</strong>ï¼šè¡¨ç¤ºæœ€å°æ”¾å¤§å€¼ï¼Œå³é•œå¤´çš„å˜ç„¦å‚æ•°</li><li><strong>Fï¼ˆFocusï¼‰</strong>ï¼šä»£è¡¨é•œå¤´çš„å¯¹ç„¦è·ç¦»</li></ul><h6 id="æ ¡å‡†æ­¥éª¤"><a href="#æ ¡å‡†æ­¥éª¤" class="headerlink" title="æ ¡å‡†æ­¥éª¤"></a>æ ¡å‡†æ­¥éª¤</h6><p><strong>1. é…ç½®ç›¸æœºå±æ€§ï¼ˆPropertiesï¼‰</strong></p><p>é¦–å…ˆéœ€è¦åœ¨ Basic Calibrator ä¸­è®¾ç½®ç›¸æœºçš„åŸºæœ¬å‚æ•°ï¼š</p><ul><li><strong>ä¼ æ„Ÿå™¨å°ºå¯¸ï¼ˆSensor Sizeï¼‰</strong>ï¼šè¾“å…¥æ‘„åƒæœºä¼ æ„Ÿå™¨çš„ç‰©ç†å°ºå¯¸<ul><li>ç¤ºä¾‹ï¼šç´¢å°¼ FX3 çš„ä¼ æ„Ÿå™¨å°ºå¯¸ä¸º 35.6 x 23.8 mm</li></ul></li><li><strong>ç›¸æœºé«˜åº¦ï¼ˆCamera Heightï¼‰</strong>ï¼šæµ‹é‡å¹¶è¾“å…¥ç›¸æœºè·ç¦»åœ°é¢çš„å®é™…é«˜åº¦<ul><li>è¿™ä¸ªå‚æ•°å¯¹äºè·Ÿè¸ªæ ¡å‡†éå¸¸é‡è¦</li></ul></li></ul><p><strong>2. è®¾ç½®è™šæ‹Ÿåœ°å¹³é¢</strong></p><ul><li><strong>Pan Virtual</strong>ï¼šè®¾ç½®è™šæ‹Ÿåœºæ™¯ä¸­åœ°å¹³é¢çš„é«˜åº¦</li><li>ç¡®ä¿è™šæ‹Ÿåœ°å¹³é¢ä¸çœŸå®åœ°é¢å¯¹é½ï¼Œè¿™æ˜¯åç»­æ ¡å‡†çš„åŸºå‡†</li></ul><p><strong>3. æ·»åŠ æ ¡å‡†ç‚¹ï¼ˆCalibration Pointsï¼‰</strong></p><ul><li>ç‚¹å‡» <strong>Add</strong> æŒ‰é’®æ·»åŠ æ ¡å‡†ç‚¹</li><li><strong>å»ºè®®ä½¿ç”¨ 5 ä¸ªä»¥ä¸Šçš„æ ¡å‡†ç‚¹</strong>ï¼Œä»¥è·å¾—æ›´å‡†ç¡®çš„æ ¡å‡†ç»“æœ</li><li><strong>æ³¨æ„äº‹é¡¹</strong>ï¼š<ul><li>ä¸è¦åœ¨ç”»é¢è¾¹ç¼˜ä½ç½®æ·»åŠ æ ¡å‡†ç‚¹ï¼Œå› ä¸ºé•œå¤´è¾¹ç¼˜çš„ç•¸å˜è¾ƒå¤§</li><li>æ ¡å‡†ç‚¹åº”å‡åŒ€åˆ†å¸ƒåœ¨ç”»é¢çš„ä¸­å¿ƒåŒºåŸŸ</li><li>é€‰æ‹©ç”»é¢ä¸­æ¸…æ™°å¯è¾¨çš„å‚è€ƒç‚¹ï¼ˆå¦‚åœ°é¢æ ‡è®°ã€å¢™è§’ç­‰ï¼‰</li></ul></li></ul><p><strong>4. è°ƒæ•´ç„¦è·ï¼ˆFocal Lengthï¼‰</strong></p><p>è¿™æ˜¯æ ¡å‡†çš„æ ¸å¿ƒæ­¥éª¤ï¼Œéœ€è¦é€šè¿‡è§‚å¯Ÿè™šæ‹Ÿç½‘æ ¼ä¸çœŸå®åœºæ™¯çš„åŒ¹é…ç¨‹åº¦æ¥è°ƒæ•´ï¼š</p><ul><li><strong>åˆ¤æ–­æ ‡å‡†</strong>ï¼šæ¨ªå‘æˆ–çºµå‘å¹³ç§»ç›¸æœºï¼Œè§‚å¯Ÿè™šæ‹Ÿç½‘æ ¼ä¸åœ°é¢æ ‡è®°çš„ç›¸å¯¹è¿åŠ¨é€Ÿåº¦<ul><li>å¦‚æœ<strong>è™šæ‹Ÿç½‘æ ¼æ—‹è½¬é€Ÿåº¦æ¯”çœŸå®æ ‡è®°å¿«</strong>ï¼šéœ€è¦<strong>å¢åŠ  Focal Length</strong> å€¼</li><li>å¦‚æœ<strong>è™šæ‹Ÿç½‘æ ¼æ—‹è½¬é€Ÿåº¦æ¯”çœŸå®æ ‡è®°æ…¢</strong>ï¼šéœ€è¦<strong>å‡å° Focal Length</strong> å€¼</li></ul></li><li><strong>è°ƒæ•´æ–¹æ³•</strong>ï¼š<ul><li>é€æ­¥å¾®è°ƒ Focal Length å‚æ•°</li><li>é‡å¤æµ‹è¯•ç›¸æœºç§»åŠ¨ï¼Œç›´åˆ°è™šæ‹Ÿç½‘æ ¼ä¸çœŸå®åœºæ™¯å®Œç¾åŒæ­¥</li></ul></li></ul><p><strong>5. éªŒè¯æ ¡å‡†ç»“æœ</strong></p><ul><li>åœ¨ä¸åŒä½ç½®å’Œè§’åº¦æµ‹è¯•ç›¸æœºè¿åŠ¨</li><li>ç¡®ä¿è™šæ‹Ÿåœºæ™¯ä¸çœŸå®åœºæ™¯åœ¨å„ä¸ªæ–¹å‘ä¸Šéƒ½èƒ½ä¿æŒä¸€è‡´</li><li>å¦‚æœå‘ç°åå·®ï¼Œå¯ä»¥æ·»åŠ æ›´å¤šæ ¡å‡†ç‚¹æˆ–é‡æ–°è°ƒæ•´å‚æ•°</li></ul><h6 id="æ ¡å‡†æŠ€å·§"><a href="#æ ¡å‡†æŠ€å·§" class="headerlink" title="æ ¡å‡†æŠ€å·§"></a>æ ¡å‡†æŠ€å·§</h6><ul><li>ä½¿ç”¨ç¨³å®šçš„ä¸‰è„šæ¶æˆ–äº‘å°ï¼Œé¿å…ç›¸æœºæŠ–åŠ¨å½±å“æ ¡å‡†ç²¾åº¦</li><li>åœ¨å…‰çº¿å……è¶³çš„ç¯å¢ƒä¸‹è¿›è¡Œæ ¡å‡†ï¼Œç¡®ä¿å‚è€ƒç‚¹æ¸…æ™°å¯è§</li><li>å®šæœŸé‡æ–°æ ¡å‡†ï¼Œç‰¹åˆ«æ˜¯åœ¨æ›´æ¢é•œå¤´æˆ–è°ƒæ•´ç„¦è·å</li><li>ä¿å­˜æ ¡å‡†é…ç½®æ–‡ä»¶ï¼Œæ–¹ä¾¿åç»­ä½¿ç”¨</li></ul><h6 id="æ”¯æŒçš„è·Ÿè¸ªç³»ç»Ÿç±»å‹"><a href="#æ”¯æŒçš„è·Ÿè¸ªç³»ç»Ÿç±»å‹" class="headerlink" title="æ”¯æŒçš„è·Ÿè¸ªç³»ç»Ÿç±»å‹"></a>æ”¯æŒçš„è·Ÿè¸ªç³»ç»Ÿç±»å‹</h6><p>Basic Calibrator ç›®å‰æ”¯æŒä¸¤ç§ç±»å‹çš„è·Ÿè¸ªç³»ç»Ÿæ ¡å‡†ï¼š</p><div align="center"><img src="https://s2.loli.net/2025/10/10/7eXmrFl6TStBQ8V.png" alt="image-20251009170158715" style="zoom: 20%;" /></div><ul><li><p><strong>6DOFï¼ˆ6 è‡ªç”±åº¦è·Ÿè¸ªç³»ç»Ÿï¼‰</strong></p><ul><li><strong>å®šä¹‰</strong>ï¼šèƒ½å¤ŸåŒæ—¶è·å–æ‘„åƒæœºåœ¨ä¸‰ç»´ç©ºé—´ä¸­çš„ä½ç½®ï¼ˆXã€Yã€Zï¼‰å’Œæ—‹è½¬ï¼ˆPitchä¿¯ä»°ã€Yawåèˆªã€Rollç¿»æ»šï¼‰æ•°æ®</li><li><strong>ç‰¹ç‚¹</strong>ï¼šå®ç°æ‘„åƒæœºçš„å®Œæ•´ç©ºé—´è¿åŠ¨è¿½è¸ª</li><li><strong>åº”ç”¨åœºæ™¯</strong>ï¼šé«˜ç²¾åº¦è™šæ‹Ÿåˆ¶ä½œå’Œæ··åˆç°å®åœºæ™¯</li><li><strong>å…¸å‹è®¾å¤‡</strong>ï¼šæ¥è‡ªå¤–éƒ¨çš„ä¸“ä¸šè·Ÿè¸ªç³»ç»Ÿï¼ˆå¦‚ OptiTrackã€Vicon ç­‰ï¼‰</li></ul></li><li><p><strong>PTZï¼ˆPan-Tilt-Zoomï¼‰</strong></p><ul><li><strong>å®šä¹‰</strong>ï¼šå…·å¤‡äº‘å°ï¼ˆæ°´å¹³æ—‹è½¬ï¼‰ã€ä¿¯ä»°ï¼ˆå‚ç›´æ—‹è½¬ï¼‰å’Œå˜ç„¦åŠŸèƒ½çš„æ‘„åƒæœº</li><li><strong>ç‰¹ç‚¹</strong>ï¼šä¸å…·å¤‡å®Œæ•´çš„ç©ºé—´ä½ç½®è¿½è¸ªèƒ½åŠ›ï¼Œä¸»è¦è¿½è¸ªæ—‹è½¬å’Œå˜ç„¦å‚æ•°</li><li><strong>åº”ç”¨åœºæ™¯</strong>ï¼šåœºæ™¯ç›‘æ§æˆ–ç®€å•è™šæ‹Ÿåˆ¶ä½œ</li><li><strong>å…¸å‹è®¾å¤‡</strong>ï¼šPTZ æ‘„åƒæœºç³»ç»Ÿ</li></ul></li></ul><h6 id="è®¾å¤‡é…ç½®ç¤ºä¾‹"><a href="#è®¾å¤‡é…ç½®ç¤ºä¾‹" class="headerlink" title="è®¾å¤‡é…ç½®ç¤ºä¾‹"></a>è®¾å¤‡é…ç½®ç¤ºä¾‹</h6><p><strong>åœ¨è®¾å¤‡æ˜ å°„å™¨ä¸­æ·»åŠ  Aximmetry Eyeï¼š</strong></p><div align="center"><img src="https://s2.loli.net/2025/10/10/xMOXDgvkuVticse.png" alt="image-20250930155931126" style="zoom: 20%;" /></div><div align="center"><img src="https://s2.loli.net/2025/10/10/LM2ldp7bxyBaIYR.png" alt="image-20250930164348165" style="zoom: 20%;" /></div><p><strong>é‡è¦æç¤º</strong>ï¼šä½¿ç”¨ Aximmetry Eye æ—¶ï¼Œä¸€å®šè¦é€šè¿‡<strong>ç½‘çº¿æœ‰çº¿è¿æ¥</strong>æ‰èƒ½è·å¾—ç¨³å®šçš„è·Ÿè¸ªæ•°æ®ã€‚æ— çº¿è¿æ¥å¯èƒ½å¯¼è‡´æ•°æ®å»¶è¿Ÿæˆ–è¿æ¥ä¸ç¨³å®šã€‚</p><h2 id="å…¶ä»–æ€è€ƒ"><a href="#å…¶ä»–æ€è€ƒ" class="headerlink" title="å…¶ä»–æ€è€ƒ"></a>å…¶ä»–æ€è€ƒ</h2><h5 id="å…³äºIphoneåŒæ­¥é—®é¢˜"><a href="#å…³äºIphoneåŒæ­¥é—®é¢˜" class="headerlink" title="å…³äºIphoneåŒæ­¥é—®é¢˜"></a>å…³äºIphoneåŒæ­¥é—®é¢˜</h5><p>å› ä¸ºIphoneåœ¨ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å¹¶ä¸æ”¯æŒæ—¶é—´å—å’ŒGenlockï¼Œæ‰€ä»¥åœ¨åŒæ­¥ä¸Šå°±ä¼šæœ‰å¾ˆå¤šé—®é¢˜ã€‚</p><p>è®ºå›é‡ŒæåŠäº†<a href="https://my.aximmetry.com/post/3885-aximmetry-eye-as-a-tracker-for-a-studio">è¿™ä¸ªé—®é¢˜</a>ã€‚æ˜¯å¦å¯ä»¥ä½¿ç”¨iphone17æ”¯æŒäº†GenLockæ˜¯å¦å¯ä»¥ç›´æ¥æ‹¿æ¥ä½¿ç”¨ä½œä¸ºå¤–éƒ¨è·Ÿè¸ªå™¨ã€‚</p><p><a href="https://www.youtube.com/watch?v=jjsrc01caGQ">Youtubeé‡Œé¢æåˆ°çš„Blackmgiacä¸ºIphoneåˆ¶ä½œçš„å¤–éƒ¨åŒæ­¥è®¾å¤‡</a></p><h2 id="ä½¿ç”¨æ—¶å€™çš„é—®é¢˜"><a href="#ä½¿ç”¨æ—¶å€™çš„é—®é¢˜" class="headerlink" title="ä½¿ç”¨æ—¶å€™çš„é—®é¢˜"></a>ä½¿ç”¨æ—¶å€™çš„é—®é¢˜</h2><h3 id="å¼•æ“ç‰ˆæœ¬ä¸å…¼å®¹é—®é¢˜"><a href="#å¼•æ“ç‰ˆæœ¬ä¸å…¼å®¹é—®é¢˜" class="headerlink" title="å¼•æ“ç‰ˆæœ¬ä¸å…¼å®¹é—®é¢˜"></a>å¼•æ“ç‰ˆæœ¬ä¸å…¼å®¹é—®é¢˜</h3><p>å®˜ç½‘ä¹Ÿæåˆ°äº†è¿™ä¸ª<a href="https://aximmetry.com/learn/virtual-production-workflow/obtaining-graphics-and-virtual-assets/creating-content-in-unreal-editor/advanced-information-and-features/how-to-install-third-party-code-plugins-for-unreal-editor-for-aximmetry/">é—®é¢˜</a>ï¼Œè¿™ä¼šæ¶‰åŠåˆ°ä¸€äº›åˆ«çš„æ’ä»¶çš„é‡æ–°ç¼–è¯‘ã€å…¼å®¹æ€§çš„é—®é¢˜ã€‚</p><p>Aximmetry çš„ UE ç‰ˆæœ¬ä¸æ˜¯å®˜æ–¹å®Œæ•´æºç ç‰ˆï¼Œå› æ­¤æƒ³è¦é‡æ–°ç¼–è¯‘å¤æ‚ C++ æ’ä»¶ï¼ˆç‰¹åˆ«æ˜¯ä¾èµ–ç§æœ‰æ¨¡å—æˆ–æ¸²æŸ“ç®¡çº¿æ‰©å±•çš„ï¼‰å¾€å¾€ä¼šå¤±è´¥ã€‚</p><p>å¯ä»¥ï¼š</p><ol><li>ä½¿ç”¨è“å›¾æˆ–çº¯èµ„æºæ’ä»¶ï¼›</li><li>å¯»æ‰¾å·²ä¸ºè¯¥ç‰ˆæœ¬é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶åŒ…ï¼›</li><li>å¦‚æœå¿…é¡»ç”¨ C++ æ’ä»¶ï¼Œå°è¯•åœ¨å®˜æ–¹ UE5.5 å»ºå·¥ç¨‹éªŒè¯ï¼Œç¡®è®¤å¯ä»¥è·‘é€šï¼Œç„¶åå†åˆ°Aximmetryçš„å¼•æ“ä¸­å»è·‘ã€‚</li></ol><h3 id="é‡‡é›†å¡æ ¼å¼ä¸å…¼å®¹é—®é¢˜"><a href="#é‡‡é›†å¡æ ¼å¼ä¸å…¼å®¹é—®é¢˜" class="headerlink" title="é‡‡é›†å¡æ ¼å¼ä¸å…¼å®¹é—®é¢˜"></a>é‡‡é›†å¡æ ¼å¼ä¸å…¼å®¹é—®é¢˜</h3><p> åœ¨é¡¹ç›®è®¾ç½®ä¸Šä¼šå‡ºç°é‡‡é›†å¡è¯†åˆ«ä¸åˆ°å‹å·&#x2F;åˆ†è¾¨ç‡ç­‰é—®é¢˜ï¼Œæˆ–æ˜¯é‡‡é›†å¡æ–­æ‰ä¹‹åï¼Œç”»é¢å‘ˆç°é»‘çš„ã€‚<br>è¿™æ—¶å€™éœ€è¦æ‹”æ‰æ’ä»¶å¡é‡æ–°æ’å…¥ï¼Œç„¶åé‡å¯è½¯ä»¶ã€‚</p><h2 id="è‡ªå·±å†™ä¸€ä¸ªXRè½¯ä»¶"><a href="#è‡ªå·±å†™ä¸€ä¸ªXRè½¯ä»¶" class="headerlink" title="è‡ªå·±å†™ä¸€ä¸ªXRè½¯ä»¶"></a>è‡ªå·±å†™ä¸€ä¸ªXRè½¯ä»¶</h2><p>æˆ‘ä»¬æœ‰è‡ªç ”çš„éœ€æ±‚ï¼Œè€ƒè™‘åˆ°Aximmetryçš„ä»¥â€œç‰‡çš„å½¢å¼â€æ”¾ä¸€ä¸ªé‡‡é›†å¡ç”»é¢åˆ°åœºæ™¯ä¸­çš„å®ç°é€»è¾‘è¾ƒä¸ºç®€å•ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œæ‰‹æ“ä¸€ä¸ªXRè½¯ä»¶ï¼Œç”¨äºç»™åé¢çš„å¤§è½¯ä»¶è¿›è¡Œæ“ä½œé€»è¾‘æ•´ç†ï¼Œæˆ‘è®¾æƒ³çš„æ˜¯ï¼Œè¿™æ˜¯ä¸€ä¸ªç¼–è¾‘å™¨ä¸‹çš„å·¥å…·ï¼Œå¯ä»¥ä¾æ‰˜UEå®Œæˆæ•´ä¸ªåˆæˆå’Œæ¸²æŸ“æ“ä½œï¼Œè€Œä¸æ˜¯Aximmetryã€‚</p><p>å®ç°çš„åŠŸèƒ½æ¯”è¾ƒç®€å•ï¼š<br>ä¸»è¦å®ç°ï¼š</p><ol><li>æ¥å…¥ç»¿å¹•å›¾åƒ</li><li>ç»¿å¹•ä¸€ç›´æœå‘æ‘„å½±æœº</li><li>ç›¸æœºçš„å¤šæœºä½åˆ‡æ¢åŠå¤šæœºä½è¿åŠ¨</li><li>æ§åˆ¶å¯¹åº”çš„å±å¹•å…¨å±æ˜¾ç¤º</li></ol><h3 id="æ¥å…¥ç»¿å¹•å›¾åƒ"><a href="#æ¥å…¥ç»¿å¹•å›¾åƒ" class="headerlink" title="æ¥å…¥ç»¿å¹•å›¾åƒ"></a>æ¥å…¥ç»¿å¹•å›¾åƒ</h3><div style="text-align: center;"><img src="https://s2.loli.net/2025/11/04/y1OqgboQ6aPUC2Y.png" alt="image-20251104155838931" style="zoom: 25%;" / width="50%" /></div><p>æ–°å»ºä¸€ä¸ªåœºæ™¯ï¼Œå¹¶æ–°å»ºMediaPlateåˆ°åœºæ™¯ä¸­ã€‚</p><p>å¯¼å…¥ç»¿å¹•è§†é¢‘ï¼ˆå¯ä»¥ç›´æ¥æŠŠUEæ”¯æŒçš„æ ¼å¼çš„è§†é¢‘æ‹–æ‹½åˆ°UEçš„ç¼–è¾‘å™¨é¢æ¿é‡Œï¼‰å¹¶è¿æ¥MediaPlateã€‚</p><div style="text-align: center;"><img src="https://s2.loli.net/2025/11/04/BHVDa1MwzeqQ48v.png" alt="image-20251104160039501" style="zoom:25%;" / width="50%" /></div><p>ä¿®æ”¹ç»¿å¹•æè´¨ï¼ˆç›´æ¥æŠŠMediaPlateçš„æè´¨å¤åˆ¶å‡ºæ¥ä¸€ä»½åˆ°æœ¬åœ°ï¼‰ï¼Œå¹¶æ–°å¢ä¸€ä¸ªMF_ChromKeyerï¼Œå¹¶æŒ‰ç…§å¦‚å›¾æ‰€ç¤ºè¿›è¡Œä¿®æ”¹æè´¨çš„èŠ‚ç‚¹ï¼Œç„¶åå°†å¤åˆ¶å‡ºæ¥çš„æè´¨èµ‹äºˆMediaPlateã€‚</p><div style="text-align: center;"><img src="https://s2.loli.net/2025/11/04/PZQh3SBgt4rVCk8.png" alt="image-20251104160012519" style="zoom:25%;" / width="50%" /></div><p>ä¿®æ”¹å­æè´¨ï¼Œå¯¹æŠ åƒçš„å†…å®¹é€‰æ‹©ç»¿è‰²çš„éƒ¨åˆ†ã€‚ä¿å­˜ï¼Œå³å¯å®ŒæˆæŠ åƒï¼Œè¿™é‡Œæš‚æ—¶ä½¿ç”¨ä¸€ä¸ªä¸´æ—¶çš„è§†é¢‘ç´ æï¼Œæ­£å¼ä½¿ç”¨çš„æ—¶å€™ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªé‡‡é›†å¡æ¥å…¥çš„è§†é¢‘æµã€‚</p><div style="text-align: center;"><img src="https://s2.loli.net/2025/11/04/J3sL9ITyld1aU7N.png" alt="image-20251104160147691" style="zoom:25%;" / width="50%" /></div><p>æˆªæ­¢åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥åœ¨åœºæ™¯ä¸­æ˜¾ç¤ºä¸€ä¸ªæŠ åƒçš„Plateäº†ã€‚</p><p>ä½†æ˜¯è¿™æ ·çš„Levelæ— æ³•ä¿å­˜ä¸‹æ¥ã€‚ç¦»å¼€åœºæ™¯ä¹‹åMediaPlateé‡Œé¢çš„ç´ æä¼šä¸¢ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬è¿˜è¦å®Œå–„ä¸€ä¸‹æè´¨ï¼š</p><div style="text-align: center;"><img src="https://s2.loli.net/2025/11/04/oQZX4KiqvwxtS6g.png" alt="image-20251104165145468" style="zoom:25%;" / width="50%" /></div><p>æ–°å»ºä¸€ä¸ªMediaPlayerï¼Œå°†é‡Œé¢æ’­æ”¾çš„å†…å®¹æ·»åŠ ä¸ºåˆšåˆšå¯¼å…¥çš„ç»¿å¹•è§†é¢‘æ–‡ä»¶ã€‚</p><div style="text-align: center;"><img src="https://s2.loli.net/2025/11/04/H3TibIsC7qyrcxB.png" alt="image-20251104165246306" style="zoom:25%;" / width="50%" /></div><p>æ–°å»ºä¸€ä¸ªMediaTextureï¼Œé‡Œé¢çš„åª’ä½“æŒ‡å®šä¸ºåˆšåˆšæ–°å»ºçš„MediaPlayerã€‚</p><div style="text-align: center;"><img src="https://s2.loli.net/2025/11/04/OfosrTMUuvA3eDB.png" alt="image-20251104165327820" style="zoom:25%;" / width="50%" /></div><p>ç„¶åæŠŠMediaTextureæ‹–åŠ¨åˆ°MediaPlateçš„æè´¨é‡Œé¢ï¼Œå¹¶ä¿®æ”¹è¾“å…¥æºã€‚ä¿å­˜ä¹‹åï¼ŒMediaPlateå°±æ­£å¸¸äº†ã€‚<br>è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†ç»¿å¹•æ¥å…¥è¿™ä¸€é¡¹ã€‚</p><h3 id="ç»¿å¹•ä¸€ç›´æœå‘æ‘„å½±æœº"><a href="#ç»¿å¹•ä¸€ç›´æœå‘æ‘„å½±æœº" class="headerlink" title="ç»¿å¹•ä¸€ç›´æœå‘æ‘„å½±æœº"></a>ç»¿å¹•ä¸€ç›´æœå‘æ‘„å½±æœº</h3><p>ä½†æ˜¯æˆ‘ä»¬ä¼šå‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œå½“æˆ‘ä»¬åˆ‡æ¢ä¸åŒç›¸æœºçš„è§†è§’çš„æ—¶å€™ï¼Œæ‰€ä»¥éœ€è¦è®¾ç½®ç›¸æœºçš„æ‘„å½±æœºæœå‘ã€‚</p><div style="text-align: center;"><img src="https://s2.loli.net/2025/11/04/TxhUdEkNbzIm5VG.png" alt="image-20251104171602887" style="zoom:15%;" / width="50%" /></div><div style="text-align: center;"><img src="https://s2.loli.net/2025/11/04/sCjGTwNf2xbSK5H.png" alt="image-20251104172150884" style="zoom:25%;" / width="50%" /></div><p>å¦åˆ™å°±ä¼šå‡ºç°è¿™ç§æ˜æ˜¾çš„ç‰‡çš„å½¢å¼ã€‚</p><h3 id="ç›¸æœºçš„å¤šæœºä½åˆ‡æ¢åŠå¤šæœºä½è¿åŠ¨"><a href="#ç›¸æœºçš„å¤šæœºä½åˆ‡æ¢åŠå¤šæœºä½è¿åŠ¨" class="headerlink" title="ç›¸æœºçš„å¤šæœºä½åˆ‡æ¢åŠå¤šæœºä½è¿åŠ¨"></a>ç›¸æœºçš„å¤šæœºä½åˆ‡æ¢åŠå¤šæœºä½è¿åŠ¨</h3><p>å› ä¸ºæˆ‘ä»¬æ˜¯ç›´æ¥æ§åˆ¶UEé‡Œçš„æ‘„å½±æœºå™¨ï¼Œæ‰€ä»¥ä¸ç®¡æ˜¯åœ¨PlayçŠ¶æ€ä¸‹è¿˜æ˜¯åœ¨EditorçŠ¶æ€ä¸‹ï¼Œéƒ½å¯ä»¥ç›´æ¥ä¾é UEçš„SequenceåŠŸèƒ½å®ç°é•œå¤´çš„è¿åŠ¨ã€‚ä½†æ˜¯åˆ‡æ¢å¹¶ä¸èƒ½å¾ˆå¥½çš„å®ç°ã€‚æ‰€ä»¥å¯ä»¥ç”¨æˆ‘çš„è½¯ä»¶å®ç°å¿«é€Ÿçš„é•œå¤´åˆ‡æ¢ã€‚</p><div style="text-align: center;"><img src="https://s2.loli.net/2025/11/04/z2WNlO39Sgft6np.png" alt="image-20251104174529386" style="zoom:33%;" / width="50%" /></div><p>åœ¨è¿è¡Œæ—¶ï¼Œå¯ä»¥ç‚¹å‡»è¿™ä¸ªæ§åˆ¶å°ï¼Œæ¥æ“ä½œç›¸æœºè¿›è¡Œåˆ‡æ¢ã€‚</p><h3 id="æ§åˆ¶å¯¹åº”çš„å±å¹•å…¨å±æ˜¾ç¤º"><a href="#æ§åˆ¶å¯¹åº”çš„å±å¹•å…¨å±æ˜¾ç¤º" class="headerlink" title="æ§åˆ¶å¯¹åº”çš„å±å¹•å…¨å±æ˜¾ç¤º"></a>æ§åˆ¶å¯¹åº”çš„å±å¹•å…¨å±æ˜¾ç¤º</h3><div style="text-align: center;"><img src="https://s2.loli.net/2025/11/04/9NtOGMbeDqkXQcn.png" alt="image-20251104174853388" width="50%" /></div><p>é€‰æ‹©éœ€è¦æŠŠç”»é¢æ¸²æŸ“åˆ°çš„å±å¹•ï¼Œç„¶åé€‰æ‹©æ¸²æŸ“åˆ†è¾¨ç‡ï¼Œå¯¹ç”»é¢è¿›è¡Œå…¨å±æ¸²æŸ“ã€‚ç„¶åç›´æ’­çš„æ—¶å€™ï¼Œå¯ä»¥ç”¨OBSé‡‡é›†å¯¹åº”çš„çª—å£ç”»é¢ï¼Œè¿›è¡Œç›´æ’­ã€‚</p><p>äºæ˜¯æˆ‘ä»¬å°±ç»•å¼€äº†AximmetryåŠå…¶å¼•æ“ï¼Œåœ¨UEä¸­è¿›è¡Œåˆæˆå’Œæ¸²æŸ“ï¼Œå¹¶ä¸”ä¹Ÿæ–¹ä¾¿ä½¿ç”¨å¼€æºçš„UEåŠå…¶å‘¨è¾¹å­æ’ä»¶ï¼Œè€Œä¸æ˜¯è¢«Aximmetryçš„ç‰¹æ®Šç‰ˆæœ¬å¼•æ“æ‰€é™åˆ¶ã€‚</p><p>å½“ç„¶è¿™ä¸ªæ’ä»¶ç›®å‰è¿˜æœ‰å¾ˆå¤šé—®é¢˜ã€‚Just for Fun.å¦‚æœè¦ä½¿ç”¨è¿˜è¦è§£å†³å¾ˆå¤šé—®é¢˜ï¼Œæ¯”å¦‚æ ‡å®šç­‰ã€‚</p><h2 id="æ‰€æœ‰æºç "><a href="#æ‰€æœ‰æºç " class="headerlink" title="æ‰€æœ‰æºç "></a>æ‰€æœ‰æºç </h2><h3 id="è½¯ä»¶çš„æ•´ä½“ç»“æ„"><a href="#è½¯ä»¶çš„æ•´ä½“ç»“æ„" class="headerlink" title="è½¯ä»¶çš„æ•´ä½“ç»“æ„"></a>è½¯ä»¶çš„æ•´ä½“ç»“æ„</h3><div style="text-align: center;"><img src="https://s2.loli.net/2025/11/04/Gt92glkBQOUXjNF.png" alt="image-20251104180744538" width="50%" /></div><h3 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h3><h3 id="STcgXRViewport-cpp"><a href="#STcgXRViewport-cpp" class="headerlink" title="STcgXRViewport.cpp"></a>STcgXRViewport.cpp</h3><p><strong>æ–‡ä»¶è·¯å¾„</strong>: <code>Private\STcgXRViewport.cpp</code></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;STcgXRViewport.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;TcgXRViewportClient.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;PreviewScene.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Editor.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;LevelEditor.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Engine/World.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Engine/Level.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;GameFramework/Actor.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CineCameraActor.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CineCameraComponent.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;LevelEditorViewport.h&quot;</span> <span class="comment">// FLevelEditorViewportClient</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;TcgXR.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ„é€ å‡½æ•°ï¼Œåˆå§‹åŒ–è‡ªå®šä¹‰Viewport</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">STcgXRViewport::Construct</span><span class="params">(<span class="type">const</span> FArguments&amp; InArgs)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    SEditorViewport::<span class="built_in">Construct</span>(SEditorViewport::<span class="built_in">FArguments</span>());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºè‡ªå®šä¹‰ViewportClient</span></span><br><span class="line"><span class="function">TSharedRef&lt;FEditorViewportClient&gt; <span class="title">STcgXRViewport::MakeEditorViewportClient</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!PreviewScene.<span class="built_in">IsValid</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        PreviewScene = <span class="built_in">MakeUnique</span>&lt;FPreviewScene&gt;(FPreviewScene::<span class="built_in">ConstructionValues</span>());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ViewportClient = <span class="built_in">MakeShared</span>&lt;FTcgXRViewportClient&gt;(PreviewScene.<span class="built_in">Get</span>(), <span class="built_in">StaticCastSharedRef</span>&lt;SEditorViewport&gt;(<span class="built_in">SharedThis</span>(<span class="keyword">this</span>)));</span><br><span class="line">    ViewportClient-&gt;<span class="built_in">SetViewMode</span>(VMI_Lit);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä»ç¬¬ä¸€ä¸ªä¸»ç¼–è¾‘å™¨è§†å£å¤åˆ¶ç›¸æœºå‚æ•°</span></span><br><span class="line">    <span class="keyword">if</span> (GEditor)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (FEditorViewportClient* VC : GEditor-&gt;<span class="built_in">GetAllViewportClients</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (VC &amp;&amp; VC-&gt;<span class="built_in">IsPerspective</span>())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">const</span> FVector Loc = VC-&gt;<span class="built_in">GetViewLocation</span>();</span><br><span class="line">                <span class="type">const</span> FRotator Rot = VC-&gt;<span class="built_in">GetViewRotation</span>();</span><br><span class="line">                <span class="type">const</span> <span class="type">bool</span> bIsOrtho = VC-&gt;<span class="built_in">IsOrtho</span>();</span><br><span class="line">                <span class="type">const</span> <span class="type">float</span> FOV = VC-&gt;ViewFOV; <span class="comment">// ä½¿ç”¨æºè§†å£FOV</span></span><br><span class="line">                <span class="type">const</span> <span class="type">float</span> OrthoWidth = <span class="number">2048.f</span>; <span class="comment">// é»˜è®¤æ­£äº¤å®½åº¦</span></span><br><span class="line">                ViewportClient-&gt;<span class="built_in">SetCameraFrom</span>(Loc, Rot, FOV, OrthoWidth, bIsOrtho);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åº”ç”¨ç¼“å­˜å‚æ•°ï¼ˆå¦‚æœUIåœ¨Clientåˆ›å»ºå‰è§¦å‘äº†è®¾ç½®ï¼Œä¸ä¼šå´©æºƒï¼‰</span></span><br><span class="line">    <span class="built_in">ApplyCachedParams</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ViewportClient.<span class="built_in">ToSharedRef</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">STcgXRViewport::ApplyCachedParams</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!ViewportClient.<span class="built_in">IsValid</span>()) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span> (CachedFOV.<span class="built_in">IsSet</span>()) &#123; ViewportClient-&gt;<span class="built_in">SetFOV</span>(CachedFOV.<span class="built_in">GetValue</span>()); CachedFOV.<span class="built_in">Reset</span>(); &#125;</span><br><span class="line">    <span class="keyword">if</span> (CachedExposure.<span class="built_in">IsSet</span>()) &#123; ViewportClient-&gt;<span class="built_in">SetExposure</span>(CachedExposure.<span class="built_in">GetValue</span>()); CachedExposure.<span class="built_in">Reset</span>(); &#125;</span><br><span class="line">    <span class="keyword">if</span> (CachedFocalLength.<span class="built_in">IsSet</span>()) &#123; ViewportClient-&gt;<span class="built_in">SetFocalLength</span>(CachedFocalLength.<span class="built_in">GetValue</span>()); CachedFocalLength.<span class="built_in">Reset</span>(); &#125;</span><br><span class="line">    <span class="keyword">if</span> (CachedAperture.<span class="built_in">IsSet</span>()) &#123; ViewportClient-&gt;<span class="built_in">SetAperture</span>(CachedAperture.<span class="built_in">GetValue</span>()); CachedAperture.<span class="built_in">Reset</span>(); &#125;</span><br><span class="line">    <span class="keyword">if</span> (CachedFocusDistance.<span class="built_in">IsSet</span>()) &#123; ViewportClient-&gt;<span class="built_in">SetFocusDistance</span>(CachedFocusDistance.<span class="built_in">GetValue</span>()); CachedFocusDistance.<span class="built_in">Reset</span>(); &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// XRçŠ¶æ€æ§åˆ¶æ¥å£</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">STcgXRViewport::SetShowKeyed</span><span class="params">(<span class="type">bool</span> b)</span> </span>&#123; <span class="keyword">if</span> (ViewportClient) ViewportClient-&gt;<span class="built_in">SetShowKeyed</span>(b); &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">STcgXRViewport::SetVirtualCamMove</span><span class="params">(<span class="type">bool</span> b)</span> </span>&#123; <span class="keyword">if</span> (ViewportClient) ViewportClient-&gt;<span class="built_in">SetVirtualCamMove</span>(b); &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">STcgXRViewport::SetMixedRealityBlend</span><span class="params">(<span class="type">bool</span> b)</span> </span>&#123; <span class="keyword">if</span> (ViewportClient) ViewportClient-&gt;<span class="built_in">SetMixedRealityBlend</span>(b); &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">STcgXRViewport::IsShowKeyed</span><span class="params">()</span> <span class="type">const</span> </span>&#123; <span class="keyword">return</span> ViewportClient ? ViewportClient-&gt;<span class="built_in">IsShowKeyed</span>() : <span class="literal">false</span>; &#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">STcgXRViewport::IsVirtualCamMove</span><span class="params">()</span> <span class="type">const</span> </span>&#123; <span class="keyword">return</span> ViewportClient ? ViewportClient-&gt;<span class="built_in">IsVirtualCamMove</span>() : <span class="literal">false</span>; &#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">STcgXRViewport::IsMixedRealityBlend</span><span class="params">()</span> <span class="type">const</span> </span>&#123; <span class="keyword">return</span> ViewportClient ? ViewportClient-&gt;<span class="built_in">IsMixedRealityBlend</span>() : <span class="literal">true</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å·¥å…·ï¼šè·å–å½“å‰é”å®šçš„ç”µå½±ç›¸æœºï¼ˆå¦‚æœä»»ä½•ä¸€ä¸ªå…³å¡è§†å£å¤„äºPilot/é”å®šçŠ¶æ€ï¼‰</span></span><br><span class="line"><span class="function"><span class="type">static</span> UCineCameraComponent* <span class="title">GetLockedCineCamera</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!GEditor) <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">    <span class="type">const</span> TArray&lt;FLevelEditorViewportClient*&gt;&amp; Clients = GEditor-&gt;<span class="built_in">GetLevelViewportClients</span>();</span><br><span class="line">    <span class="keyword">for</span> (FLevelEditorViewportClient* LVC : Clients)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!LVC || !LVC-&gt;<span class="built_in">IsPerspective</span>()) <span class="keyword">continue</span>;</span><br><span class="line">        AActor* LockedActor = <span class="literal">nullptr</span>;</span><br><span class="line">        <span class="keyword">if</span> (AActor* CineLock = LVC-&gt;<span class="built_in">GetCinematicActorLock</span>().<span class="built_in">GetLockedActor</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            LockedActor = CineLock;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (LVC-&gt;<span class="built_in">GetActiveActorLock</span>().<span class="built_in">IsValid</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            LockedActor = LVC-&gt;<span class="built_in">GetActiveActorLock</span>().<span class="built_in">Get</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (LockedActor)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (ACineCameraActor* Cine = <span class="built_in">Cast</span>&lt;ACineCameraActor&gt;(LockedActor))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> Cine-&gt;<span class="built_in">GetCineCameraComponent</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ•è·é”®ç›˜è¾“å…¥å¹¶åˆ†å‘ç»™æ¨¡å—åšç›¸æœºåˆ‡æ¢</span></span><br><span class="line"><span class="function">FReply <span class="title">STcgXRViewport::OnKeyDown</span><span class="params">(<span class="type">const</span> FGeometry&amp; MyGeometry, <span class="type">const</span> FKeyEvent&amp; InKeyEvent)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (FTcgXRModule* Mod = FModuleManager::<span class="built_in">GetModulePtr</span>&lt;FTcgXRModule&gt;(<span class="string">&quot;TcgXR&quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (Mod-&gt;<span class="built_in">HandleKeyDown</span>(InKeyEvent.<span class="built_in">GetKey</span>()))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> FReply::<span class="built_in">Handled</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> SEditorViewport::<span class="built_in">OnKeyDown</span>(MyGeometry, InKeyEvent);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®‰å…¨è®¾ç½®æ¥å£ï¼ˆä¼˜å…ˆä¿®æ”¹é”å®šåˆ°å…³å¡è§†å£çš„ç›¸æœºï¼Œå¦åˆ™æœ¬åœ°ç¼“å­˜/ViewportClientï¼‰</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">STcgXRViewport::SetFOVParam</span><span class="params">(<span class="type">float</span> InFOV)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (UCineCameraComponent* CineComp = <span class="built_in">GetLockedCineCamera</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        CineComp-&gt;<span class="built_in">SetFieldOfView</span>(InFOV);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (ViewportClient.<span class="built_in">IsValid</span>()) &#123; ViewportClient-&gt;<span class="built_in">SetFOV</span>(InFOV); &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123; CachedFOV = InFOV; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">STcgXRViewport::SetExposureParam</span><span class="params">(<span class="type">float</span> InExposure)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (UCineCameraComponent* CineComp = <span class="built_in">GetLockedCineCamera</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        FPostProcessSettings&amp; PPS = CineComp-&gt;PostProcessSettings;</span><br><span class="line">        PPS.bOverride_AutoExposureBias = <span class="literal">true</span>;</span><br><span class="line">        PPS.AutoExposureBias = InExposure;</span><br><span class="line">        CineComp-&gt;PostProcessBlendWeight = <span class="number">1.0f</span>;</span><br><span class="line">        CineComp-&gt;<span class="built_in">MarkRenderStateDirty</span>();</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (ViewportClient.<span class="built_in">IsValid</span>()) &#123; ViewportClient-&gt;<span class="built_in">SetExposure</span>(InExposure); &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123; CachedExposure = InExposure; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">STcgXRViewport::SetFocalLengthParam</span><span class="params">(<span class="type">float</span> InFocal)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (UCineCameraComponent* CineComp = <span class="built_in">GetLockedCineCamera</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        CineComp-&gt;<span class="built_in">SetCurrentFocalLength</span>(InFocal);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (ViewportClient.<span class="built_in">IsValid</span>()) &#123; ViewportClient-&gt;<span class="built_in">SetFocalLength</span>(InFocal); &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123; CachedFocalLength = InFocal; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">STcgXRViewport::SetApertureParam</span><span class="params">(<span class="type">float</span> InAperture)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (UCineCameraComponent* CineComp = <span class="built_in">GetLockedCineCamera</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        CineComp-&gt;<span class="built_in">SetCurrentAperture</span>(InAperture);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (ViewportClient.<span class="built_in">IsValid</span>()) &#123; ViewportClient-&gt;<span class="built_in">SetAperture</span>(InAperture); &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123; CachedAperture = InAperture; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">STcgXRViewport::SetFocusDistanceParam</span><span class="params">(<span class="type">float</span> InFocus)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (UCineCameraComponent* CineComp = <span class="built_in">GetLockedCineCamera</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        CineComp-&gt;FocusSettings.ManualFocusDistance = InFocus;</span><br><span class="line">        CineComp-&gt;<span class="built_in">SetFocusSettings</span>(CineComp-&gt;FocusSettings);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (ViewportClient.<span class="built_in">IsValid</span>()) &#123; ViewportClient-&gt;<span class="built_in">SetFocusDistance</span>(InFocus); &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123; CachedFocusDistance = InFocus; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="TcgXR-cpp"><a href="#TcgXR-cpp" class="headerlink" title="TcgXR.cpp"></a>TcgXR.cpp</h3><p><strong>æ–‡ä»¶è·¯å¾„</strong>: <code>Private\TcgXR.cpp</code></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Copyright Epic Games, Inc. All Rights Reserved.</span></span><br><span class="line"><span class="comment">// æœ¬æ–‡ä»¶ä¸ºTcgXRæ’ä»¶ä¸»æ¨¡å—ï¼Œè´Ÿè´£æ’ä»¶çš„åˆå§‹åŒ–ã€UIå¸ƒå±€å’Œå‘½ä»¤æ³¨å†Œã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;TcgXR.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;TcgXRStyle.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;TcgXRCommands.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ToolMenus.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Framework/Docking/TabManager.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Widgets/Docking/SDockTab.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Widgets/Layout/SBorder.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Widgets/SBoxPanel.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Widgets/Input/SCheckBox.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Widgets/Input/SButton.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Widgets/Input/SComboBox.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Widgets/Input/SSlider.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Widgets/Input/SSpinBox.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Widgets/Input/SComboButton.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Widgets/Text/STextBlock.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Widgets/SWindow.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Framework/Application/SlateApplication.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;STcgXRViewport.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;TcgXRViewportClient.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;LevelEditor.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;LevelEditorViewport.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;SLevelViewport.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;EngineUtils.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Camera/CameraActor.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Editor.h&quot;</span> <span class="comment">// FEditorDelegates</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">const</span> FName <span class="title">TcgXRTabName</span><span class="params">(<span class="string">&quot;TcgXRWindow&quot;</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LOCTEXT_NAMESPACE <span class="string">&quot;FTcgXRModule&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">FTcgXRModule::StartupModule</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">FTcgXRStyle::<span class="built_in">Initialize</span>();</span><br><span class="line">FTcgXRStyle::<span class="built_in">ReloadTextures</span>();</span><br><span class="line"></span><br><span class="line">FTcgXRCommands::<span class="built_in">Register</span>();</span><br><span class="line"></span><br><span class="line">PluginCommands = <span class="built_in">MakeShareable</span>(<span class="keyword">new</span> FUICommandList);</span><br><span class="line">PluginCommands-&gt;<span class="built_in">MapAction</span>(</span><br><span class="line">FTcgXRCommands::<span class="built_in">Get</span>().PluginAction,</span><br><span class="line">FExecuteAction::<span class="built_in">CreateRaw</span>(<span class="keyword">this</span>, &amp;FTcgXRModule::PluginButtonClicked),</span><br><span class="line"><span class="built_in">FCanExecuteAction</span>());</span><br><span class="line"></span><br><span class="line">FGlobalTabmanager::<span class="built_in">Get</span>()-&gt;<span class="built_in">RegisterNomadTabSpawner</span>(TcgXRTabName,</span><br><span class="line">FOnSpawnTab::<span class="built_in">CreateRaw</span>(<span class="keyword">this</span>, &amp;FTcgXRModule::OnSpawnPluginTab))</span><br><span class="line">.<span class="built_in">SetDisplayName</span>(<span class="built_in">LOCTEXT</span>(<span class="string">&quot;TcgXRTabTitle&quot;</span>, <span class="string">&quot;TcgXR&quot;</span>))</span><br><span class="line">.<span class="built_in">SetMenuType</span>(ETabSpawnerMenuType::Hidden);</span><br><span class="line"></span><br><span class="line">UToolMenus::<span class="built_in">RegisterStartupCallback</span>(FSimpleMulticastDelegate::FDelegate::<span class="built_in">CreateRaw</span>(<span class="keyword">this</span>, &amp;FTcgXRModule::RegisterMenus));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (GEngine)</span><br><span class="line">&#123;</span><br><span class="line">ActorAddedHandle = GEngine-&gt;<span class="built_in">OnLevelActorAdded</span>().<span class="built_in">AddLambda</span>([<span class="keyword">this</span>](AActor* <span class="comment">/*Actor*/</span>)&#123; <span class="built_in">RefreshCameraList</span>(); &#125;);</span><br><span class="line">ActorDeletedHandle = GEngine-&gt;<span class="built_in">OnLevelActorDeleted</span>().<span class="built_in">AddLambda</span>([<span class="keyword">this</span>](AActor* <span class="comment">/*Actor*/</span>)&#123; <span class="built_in">RefreshCameraList</span>(); &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å½“ç¼–è¾‘å™¨ç›¸æœºç§»åŠ¨æˆ–åˆ‡æ¢é”å®šæ—¶ï¼Œåˆ·æ–°â€œå½“å‰æ§åˆ¶â€æ–‡æœ¬</span></span><br><span class="line">FEditorDelegates::OnEditorCameraMoved.<span class="built_in">AddLambda</span>([<span class="keyword">this</span>](<span class="type">const</span> FVector&amp;, <span class="type">const</span> FRotator&amp;, ELevelViewportType, int32)&#123; <span class="built_in">RebuildCameraHotkeyUI</span>(); &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">FTcgXRModule::ShutdownModule</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">UToolMenus::<span class="built_in">UnRegisterStartupCallback</span>(<span class="keyword">this</span>);</span><br><span class="line">UToolMenus::<span class="built_in">UnregisterOwner</span>(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">FGlobalTabmanager::<span class="built_in">Get</span>()-&gt;<span class="built_in">UnregisterNomadTabSpawner</span>(TcgXRTabName);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (GEngine)</span><br><span class="line">&#123;</span><br><span class="line">GEngine-&gt;<span class="built_in">OnLevelActorAdded</span>().<span class="built_in">Remove</span>(ActorAddedHandle);</span><br><span class="line">GEngine-&gt;<span class="built_in">OnLevelActorDeleted</span>().<span class="built_in">Remove</span>(ActorDeletedHandle);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">FTcgXRStyle::<span class="built_in">Shutdown</span>();</span><br><span class="line">FTcgXRCommands::<span class="built_in">Unregister</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">FTcgXRModule::PluginButtonClicked</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">FGlobalTabmanager::<span class="built_in">Get</span>()-&gt;<span class="built_in">TryInvokeTab</span>(TcgXRTabName);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">FTcgXRModule::RegisterMenus</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function">FToolMenuOwnerScoped <span class="title">OwnerScoped</span><span class="params">(<span class="keyword">this</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (UToolMenu* Menu = UToolMenus::<span class="built_in">Get</span>()-&gt;<span class="built_in">ExtendMenu</span>(<span class="string">&quot;LevelEditor.MainMenu.Window&quot;</span>))</span><br><span class="line">&#123;</span><br><span class="line">FToolMenuSection&amp; Section = Menu-&gt;<span class="built_in">FindOrAddSection</span>(<span class="string">&quot;WindowLayout&quot;</span>);</span><br><span class="line">Section.<span class="built_in">AddMenuEntryWithCommandList</span>(FTcgXRCommands::<span class="built_in">Get</span>().PluginAction, PluginCommands);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (UToolMenu* ToolbarMenu = UToolMenus::<span class="built_in">Get</span>()-&gt;<span class="built_in">ExtendMenu</span>(<span class="string">&quot;LevelEditor.LevelEditorToolBar.PlayToolBar&quot;</span>))</span><br><span class="line">&#123;</span><br><span class="line">FToolMenuSection&amp; Section = ToolbarMenu-&gt;<span class="built_in">FindOrAddSection</span>(<span class="string">&quot;PluginTools&quot;</span>);</span><br><span class="line">FToolMenuEntry&amp; Entry = Section.<span class="built_in">AddEntry</span>(FToolMenuEntry::<span class="built_in">InitToolBarButton</span>(FTcgXRCommands::<span class="built_in">Get</span>().PluginAction));</span><br><span class="line">Entry.<span class="built_in">SetCommandList</span>(PluginCommands);</span><br><span class="line">Entry.Icon = <span class="built_in">FSlateIcon</span>(FTcgXRStyle::<span class="built_in">GetStyleSetName</span>(), <span class="built_in">TEXT</span>(<span class="string">&quot;TcgXR.PluginAction.Small&quot;</span>), <span class="built_in">TEXT</span>(<span class="string">&quot;TcgXR.PluginAction&quot;</span>));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">FTcgXRModule::HandleKeyDown</span><span class="params">(<span class="type">const</span> FKey&amp; Key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (TWeakObjectPtr&lt;ACameraActor&gt;* Found = CameraHotkeyMap.<span class="built_in">Find</span>(Key))</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">SwitchToCamera</span>(*Found);</span><br><span class="line"><span class="built_in">RebuildCameraHotkeyUI</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">FTcgXRModule::BindCameraHotkey</span><span class="params">(TWeakObjectPtr&lt;ACameraActor&gt; Camera, <span class="type">const</span> FKey&amp; Key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">// ç¡®ä¿ä¸€ä¸ªç›¸æœºåªç»‘å®šä¸€ä¸ªé”®ï¼šå…ˆç§»é™¤æ—§ç»‘å®š</span></span><br><span class="line">TArray&lt;FKey&gt; KeysToRemove;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span>&amp; Pair : CameraHotkeyMap)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (Pair.Value == Camera)</span><br><span class="line">&#123;</span><br><span class="line">KeysToRemove.<span class="built_in">Add</span>(Pair.Key);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">const</span> FKey&amp; OldKey : KeysToRemove)</span><br><span class="line">&#123;</span><br><span class="line">CameraHotkeyMap.<span class="built_in">Remove</span>(OldKey);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åŒä¸€æŒ‰é”®é‡æ–°ç»‘å®šåˆ°æ–°ç›¸æœº</span></span><br><span class="line">CameraHotkeyMap.<span class="built_in">Add</span>(Key, Camera);</span><br><span class="line"><span class="built_in">RebuildCameraHotkeyUI</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">FTcgXRModule::SwitchToCamera</span><span class="params">(TWeakObjectPtr&lt;ACameraActor&gt; Camera)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (!Camera.<span class="built_in">IsValid</span>()) <span class="keyword">return</span>;</span><br><span class="line">FLevelEditorModule&amp; LevelEditorModule = FModuleManager::<span class="built_in">LoadModuleChecked</span>&lt;FLevelEditorModule&gt;(<span class="string">&quot;LevelEditor&quot;</span>);</span><br><span class="line">TSharedPtr&lt;SLevelViewport&gt; ActiveViewport = LevelEditorModule.<span class="built_in">GetFirstActiveLevelViewport</span>();</span><br><span class="line"><span class="keyword">if</span> (!ActiveViewport.<span class="built_in">IsValid</span>()) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">FLevelEditorViewportClient&amp; LVC = ActiveViewport-&gt;<span class="built_in">GetLevelViewportClient</span>();</span><br><span class="line">LVC.<span class="built_in">SetActorLock</span>(Camera.<span class="built_in">Get</span>());</span><br><span class="line">LVC.<span class="built_in">UpdateViewForLockedActor</span>();</span><br><span class="line"><span class="keyword">if</span> (!ActiveViewport-&gt;<span class="built_in">IsLockedCameraViewEnabled</span>())</span><br><span class="line">&#123;</span><br><span class="line">ActiveViewport-&gt;<span class="built_in">ToggleActorPilotCameraView</span>();</span><br><span class="line">&#125;</span><br><span class="line">LVC.<span class="built_in">Invalidate</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">FText <span class="title">FTcgXRModule::GetCurrentControlledCameraText</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (!GEditor) <span class="keyword">return</span> <span class="built_in">LOCTEXT</span>(<span class="string">&quot;NoEditor&quot;</span>, <span class="string">&quot;å½“å‰æ§åˆ¶: æ— ï¼ˆæœªæ‰¾åˆ°ç¼–è¾‘å™¨ï¼‰&quot;</span>);</span><br><span class="line"><span class="type">const</span> TArray&lt;FLevelEditorViewportClient*&gt;&amp; Clients = GEditor-&gt;<span class="built_in">GetLevelViewportClients</span>();</span><br><span class="line"><span class="keyword">for</span> (FLevelEditorViewportClient* LVC : Clients)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (!LVC || !LVC-&gt;<span class="built_in">IsPerspective</span>()) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (AActor* CineLock = LVC-&gt;<span class="built_in">GetCinematicActorLock</span>().<span class="built_in">GetLockedActor</span>())</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> FText::<span class="built_in">Format</span>(<span class="built_in">LOCTEXT</span>(<span class="string">&quot;ControllingCam&quot;</span>,<span class="string">&quot;å½“å‰æ§åˆ¶: &#123;0&#125;&quot;</span>), FText::<span class="built_in">FromString</span>(CineLock-&gt;<span class="built_in">GetActorLabel</span>()));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (LVC-&gt;<span class="built_in">GetActiveActorLock</span>().<span class="built_in">IsValid</span>())</span><br><span class="line">&#123;</span><br><span class="line">AActor* Locked = LVC-&gt;<span class="built_in">GetActiveActorLock</span>().<span class="built_in">Get</span>();</span><br><span class="line"><span class="keyword">return</span> FText::<span class="built_in">Format</span>(<span class="built_in">LOCTEXT</span>(<span class="string">&quot;ControllingActor&quot;</span>,<span class="string">&quot;å½“å‰æ§åˆ¶: &#123;0&#125;&quot;</span>), FText::<span class="built_in">FromString</span>(Locked-&gt;<span class="built_in">GetActorLabel</span>()));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">LOCTEXT</span>(<span class="string">&quot;NoCam&quot;</span>,<span class="string">&quot;å½“å‰æ§åˆ¶: æ— ï¼ˆæœªé”å®šç›¸æœºï¼‰&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">FText <span class="title">FTcgXRModule::GetBoundKeyTextForCamera</span><span class="params">(TWeakObjectPtr&lt;ACameraActor&gt; Camera)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span>&amp; Pair : CameraHotkeyMap)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (Pair.Value == Camera)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> FText::<span class="built_in">Format</span>(<span class="built_in">LOCTEXT</span>(<span class="string">&quot;BoundKeyFmt&quot;</span>,<span class="string">&quot;å·²ç»‘å®š: &#123;0&#125;&quot;</span>), Pair.Key.<span class="built_in">GetDisplayName</span>());</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">LOCTEXT</span>(<span class="string">&quot;NoKeyBound&quot;</span>,<span class="string">&quot;æœªç»‘å®š&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">FTcgXRModule::RefreshCameraList</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">CachedCameras.<span class="built_in">Reset</span>();</span><br><span class="line"><span class="keyword">if</span> (GEditor)</span><br><span class="line">&#123;</span><br><span class="line">UWorld* World = GEditor-&gt;<span class="built_in">GetEditorWorldContext</span>().<span class="built_in">World</span>();</span><br><span class="line"><span class="keyword">if</span> (World)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (TActorIterator&lt;ACameraActor&gt; <span class="built_in">It</span>(World); It; ++It)</span><br><span class="line">&#123;</span><br><span class="line">CachedCameras.<span class="built_in">Add</span>(*It);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">RebuildCameraHotkeyUI</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">FTcgXRModule::RebuildCameraHotkeyUI</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">TSharedPtr&lt;SVerticalBox&gt; Panel = CameraListPanel.<span class="built_in">Pin</span>();</span><br><span class="line"><span class="keyword">if</span> (!Panel.<span class="built_in">IsValid</span>()) <span class="keyword">return</span>;</span><br><span class="line">Panel-&gt;<span class="built_in">ClearChildren</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// é¡¶éƒ¨æ˜¾ç¤ºå½“å‰æ§åˆ¶çš„ç›¸æœº</span></span><br><span class="line">Panel-&gt;<span class="built_in">AddSlot</span>().<span class="built_in">AutoHeight</span>().<span class="built_in">Padding</span>(<span class="number">0</span>,<span class="number">2</span>)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(STextBlock)</span><br><span class="line">.<span class="built_in">Text_Lambda</span>([<span class="keyword">this</span>]()&#123; <span class="keyword">return</span> <span class="built_in">GetCurrentControlledCameraText</span>(); &#125;)</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">int32 Index = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (TWeakObjectPtr&lt;ACameraActor&gt; Cam : CachedCameras)</span><br><span class="line">&#123;</span><br><span class="line">TWeakObjectPtr&lt;ACameraActor&gt; LocalCam = Cam;</span><br><span class="line">FText Label = FText::<span class="built_in">FromString</span>(FString::<span class="built_in">Printf</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;ç›¸æœº%d: %s&quot;</span>), Index, LocalCam.<span class="built_in">IsValid</span>() ? *LocalCam-&gt;<span class="built_in">GetActorLabel</span>() : <span class="built_in">TEXT</span>(<span class="string">&quot;(æ— )&quot;</span>)));</span><br><span class="line">Panel-&gt;<span class="built_in">AddSlot</span>().<span class="built_in">AutoHeight</span>().<span class="built_in">Padding</span>(<span class="number">0</span>,<span class="number">2</span>)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(SHorizontalBox)</span><br><span class="line">+ SHorizontalBox::<span class="built_in">Slot</span>().<span class="built_in">AutoWidth</span>().<span class="built_in">Padding</span>(<span class="number">2</span>)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(STextBlock).<span class="built_in">Text</span>(Label)</span><br><span class="line">]</span><br><span class="line">+ SHorizontalBox::<span class="built_in">Slot</span>().<span class="built_in">AutoWidth</span>().<span class="built_in">Padding</span>(<span class="number">8</span>,<span class="number">2</span>)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(STextBlock)</span><br><span class="line">.<span class="built_in">Text_Lambda</span>([<span class="keyword">this</span>, LocalCam]()&#123; <span class="keyword">return</span> <span class="built_in">GetBoundKeyTextForCamera</span>(LocalCam); &#125;)</span><br><span class="line">]</span><br><span class="line">+ SHorizontalBox::<span class="built_in">Slot</span>().<span class="built_in">AutoWidth</span>().<span class="built_in">Padding</span>(<span class="number">2</span>)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(SComboButton)</span><br><span class="line">.<span class="built_in">ButtonContent</span>()[ <span class="built_in">SNew</span>(STextBlock).<span class="built_in">Text</span>(<span class="built_in">LOCTEXT</span>(<span class="string">&quot;BindKey&quot;</span>, <span class="string">&quot;ç»‘å®šæŒ‰é”®&quot;</span>)) ]</span><br><span class="line">.<span class="built_in">OnGetMenuContent_Lambda</span>([<span class="keyword">this</span>, LocalCam]()</span><br><span class="line">&#123;</span><br><span class="line">FMenuBuilder <span class="built_in">MenuBuilder</span>(<span class="literal">true</span>, <span class="literal">nullptr</span>);</span><br><span class="line">TArray&lt;FKey&gt; Keys; Keys.<span class="built_in">Reserve</span>(<span class="number">9</span>);</span><br><span class="line">Keys.<span class="built_in">Add</span>(EKeys::One); Keys.<span class="built_in">Add</span>(EKeys::Two); Keys.<span class="built_in">Add</span>(EKeys::Three); Keys.<span class="built_in">Add</span>(EKeys::Four);</span><br><span class="line">Keys.<span class="built_in">Add</span>(EKeys::Five); Keys.<span class="built_in">Add</span>(EKeys::Six); Keys.<span class="built_in">Add</span>(EKeys::Seven); Keys.<span class="built_in">Add</span>(EKeys::Eight); Keys.<span class="built_in">Add</span>(EKeys::Nine);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">const</span> FKey&amp; K : Keys)</span><br><span class="line">&#123;</span><br><span class="line">FText KeyName = K.<span class="built_in">GetDisplayName</span>();</span><br><span class="line">MenuBuilder.<span class="built_in">AddMenuEntry</span>(KeyName, <span class="built_in">LOCTEXT</span>(<span class="string">&quot;BindKeyTip&quot;</span>,<span class="string">&quot;ç»‘å®šåˆ°è¯¥é”®&quot;</span>), <span class="built_in">FSlateIcon</span>(), <span class="built_in">FUIAction</span>(FExecuteAction::<span class="built_in">CreateLambda</span>([<span class="keyword">this</span>, LocalCam, K]()&#123; <span class="built_in">BindCameraHotkey</span>(LocalCam, K); &#125;)));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> MenuBuilder.<span class="built_in">MakeWidget</span>();</span><br><span class="line">&#125;)</span><br><span class="line">]</span><br><span class="line">+ SHorizontalBox::<span class="built_in">Slot</span>().<span class="built_in">AutoWidth</span>().<span class="built_in">Padding</span>(<span class="number">2</span>)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(SButton)</span><br><span class="line">.<span class="built_in">Text</span>(<span class="built_in">LOCTEXT</span>(<span class="string">&quot;SwitchNow&quot;</span>,<span class="string">&quot;åˆ‡æ¢åˆ°è¯¥ç›¸æœº&quot;</span>))</span><br><span class="line">.<span class="built_in">OnClicked_Lambda</span>([<span class="keyword">this</span>, LocalCam]()</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">SwitchToCamera</span>(LocalCam);</span><br><span class="line"><span class="built_in">RebuildCameraHotkeyUI</span>();</span><br><span class="line"><span class="keyword">return</span> FReply::<span class="built_in">Handled</span>();</span><br><span class="line">&#125;)</span><br><span class="line">]</span><br><span class="line">];</span><br><span class="line">++Index;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">FTcgXRModule::CloseAllFullscreenWindows</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (TWeakPtr&lt;SWindow&gt;&amp; W : FullscreenWindows)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (TSharedPtr&lt;SWindow&gt; SW = W.<span class="built_in">Pin</span>())</span><br><span class="line">&#123;</span><br><span class="line">SW-&gt;<span class="built_in">RequestDestroyWindow</span>();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">FullscreenWindows.<span class="built_in">Reset</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”Ÿæˆä¸»çª—å£Tabï¼ŒåŒ…æ‹¬Viewportã€å³ä¾§æ‘„å½±æœºæ§åˆ¶é¢æ¿ã€åº•éƒ¨å…¨å±æŒ‰é’®</span></span><br><span class="line"><span class="function">TSharedRef&lt;SDockTab&gt; <span class="title">FTcgXRModule::OnSpawnPluginTab</span><span class="params">(<span class="type">const</span> FSpawnTabArgs&amp; Args)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">TSharedPtr&lt;STcgXRViewport&gt; ViewportWidget;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">float</span> ManualExposure = <span class="number">0.0f</span>;</span><br><span class="line"><span class="type">static</span> <span class="type">float</span> ManualFOV = <span class="number">90.0f</span>;</span><br><span class="line"><span class="type">static</span> <span class="type">float</span> ManualFocal = <span class="number">35.0f</span>;</span><br><span class="line"><span class="type">static</span> <span class="type">float</span> ManualAperture = <span class="number">2.8f</span>;</span><br><span class="line"><span class="type">static</span> <span class="type">float</span> ManualFocus = <span class="number">1000.0f</span>;</span><br><span class="line"><span class="type">static</span> <span class="type">bool</span> bUseLiveLink = <span class="literal">false</span>;</span><br><span class="line"><span class="type">static</span> TArray&lt;TSharedPtr&lt;FString&gt;&gt; ResolutionOptions;</span><br><span class="line">ResolutionOptions.<span class="built_in">Reset</span>();</span><br><span class="line">ResolutionOptions.<span class="built_in">Add</span>(<span class="built_in">MakeShared</span>&lt;FString&gt;(<span class="built_in">TEXT</span>(<span class="string">&quot;1920x1080&quot;</span>)));</span><br><span class="line">ResolutionOptions.<span class="built_in">Add</span>(<span class="built_in">MakeShared</span>&lt;FString&gt;(<span class="built_in">TEXT</span>(<span class="string">&quot;2560x1440&quot;</span>)));</span><br><span class="line">ResolutionOptions.<span class="built_in">Add</span>(<span class="built_in">MakeShared</span>&lt;FString&gt;(<span class="built_in">TEXT</span>(<span class="string">&quot;3840x2160&quot;</span>)));</span><br><span class="line"><span class="type">static</span> TArray&lt;TSharedPtr&lt;FString&gt;&gt; MonitorOptions;</span><br><span class="line"><span class="type">static</span> int32 SelectedMonitorIndex = <span class="number">0</span>;</span><br><span class="line"><span class="type">static</span> TSharedPtr&lt;FString&gt; SelectedResolution = ResolutionOptions.<span class="built_in">Num</span>() &gt; <span class="number">0</span> ? ResolutionOptions[<span class="number">0</span>] : <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">MonitorOptions.<span class="built_in">Reset</span>();</span><br><span class="line">&#123;</span><br><span class="line">FDisplayMetrics Metrics;</span><br><span class="line">FSlateApplication::<span class="built_in">Get</span>().<span class="built_in">GetDisplayMetrics</span>(Metrics);</span><br><span class="line">MonitorOptions.<span class="built_in">Add</span>(<span class="built_in">MakeShared</span>&lt;FString&gt;(FString::<span class="built_in">Printf</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;ä¸»æ˜¾ç¤ºå™¨ %dx%d&quot;</span>), Metrics.PrimaryDisplayWidth, Metrics.PrimaryDisplayHeight)));</span><br><span class="line"><span class="keyword">for</span> (int32 i = <span class="number">0</span>; i &lt; Metrics.MonitorInfo.<span class="built_in">Num</span>(); ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">const</span> <span class="keyword">auto</span>&amp; M = Metrics.MonitorInfo[i];</span><br><span class="line">FPlatformRect Rect = M.WorkArea;</span><br><span class="line">MonitorOptions.<span class="built_in">Add</span>(<span class="built_in">MakeShared</span>&lt;FString&gt;(FString::<span class="built_in">Printf</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;æ˜¾ç¤ºå™¨%d %dx%d @(%d,%d)&quot;</span>), i, Rect.Right-Rect.Left, Rect.Bottom-Rect.Top, Rect.Left, Rect.Top)));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (MonitorOptions.<span class="built_in">Num</span>() == <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">MonitorOptions.<span class="built_in">Add</span>(<span class="built_in">MakeShared</span>&lt;FString&gt;(<span class="built_in">TEXT</span>(<span class="string">&quot;æ˜¾ç¤ºå™¨0&quot;</span>)));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">TSharedRef&lt;SDockTab&gt; Tab = <span class="built_in">SNew</span>(SDockTab)</span><br><span class="line">.<span class="built_in">TabRole</span>(ETabRole::NomadTab)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(SHorizontalBox)</span><br><span class="line">+ SHorizontalBox::<span class="built_in">Slot</span>().<span class="built_in">FillWidth</span>(<span class="number">1.f</span>)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SAssignNew</span>(ViewportWidget, STcgXRViewport)</span><br><span class="line">]</span><br><span class="line">+ SHorizontalBox::<span class="built_in">Slot</span>().<span class="built_in">AutoWidth</span>().<span class="built_in">Padding</span>(<span class="number">8.f</span>,<span class="number">0.f</span>)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(SVerticalBox)</span><br><span class="line">+ SVerticalBox::<span class="built_in">Slot</span>().<span class="built_in">AutoHeight</span>().<span class="built_in">Padding</span>(<span class="number">0</span>,<span class="number">2</span>)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SAssignNew</span>(CameraListPanel, SVerticalBox)</span><br><span class="line">]</span><br><span class="line"><span class="comment">// é¡¶éƒ¨å¿«é€Ÿå‚æ•°è¡Œï¼šç§»é™¤FOVå’Œæ›å…‰</span></span><br><span class="line">+ SVerticalBox::<span class="built_in">Slot</span>().<span class="built_in">AutoHeight</span>().<span class="built_in">Padding</span>(<span class="number">0</span>, <span class="number">2</span>)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(SHorizontalBox)</span><br><span class="line"><span class="comment">// ç„¦è·</span></span><br><span class="line">+ SHorizontalBox::<span class="built_in">Slot</span>().<span class="built_in">AutoWidth</span>().<span class="built_in">Padding</span>(<span class="number">2</span>)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(STextBlock).<span class="built_in">Text</span>(<span class="built_in">LOCTEXT</span>(<span class="string">&quot;Focal&quot;</span>, <span class="string">&quot;ç„¦è·&quot;</span>))</span><br><span class="line">]</span><br><span class="line">+ SHorizontalBox::<span class="built_in">Slot</span>().<span class="built_in">AutoWidth</span>().<span class="built_in">Padding</span>(<span class="number">2</span>)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(SSpinBox&lt;<span class="type">float</span>&gt;).<span class="built_in">MinValue</span>(<span class="number">1.f</span>).<span class="built_in">MaxValue</span>(<span class="number">300.f</span>)</span><br><span class="line">.<span class="built_in">Value_Lambda</span>([&amp;]&#123; <span class="keyword">return</span> ManualFocal; &#125;)</span><br><span class="line">.<span class="built_in">OnValueChanged_Lambda</span>([&amp;](<span class="type">float</span> V)&#123; ManualFocal = V; <span class="keyword">if</span>(ViewportWidget.<span class="built_in">IsValid</span>()) ViewportWidget-&gt;<span class="built_in">SetFocalLengthParam</span>(V); &#125;)</span><br><span class="line">]</span><br><span class="line"><span class="comment">// å…‰åœˆ</span></span><br><span class="line">+ SHorizontalBox::<span class="built_in">Slot</span>().<span class="built_in">AutoWidth</span>().<span class="built_in">Padding</span>(<span class="number">8</span>,<span class="number">2</span>)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(STextBlock).<span class="built_in">Text</span>(<span class="built_in">LOCTEXT</span>(<span class="string">&quot;Aperture&quot;</span>, <span class="string">&quot;å…‰åœˆ&quot;</span>))</span><br><span class="line">]</span><br><span class="line">+ SHorizontalBox::<span class="built_in">Slot</span>().<span class="built_in">AutoWidth</span>().<span class="built_in">Padding</span>(<span class="number">2</span>)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(SSpinBox&lt;<span class="type">float</span>&gt;).<span class="built_in">MinValue</span>(<span class="number">0.7f</span>).<span class="built_in">MaxValue</span>(<span class="number">32.f</span>)</span><br><span class="line">.<span class="built_in">Value_Lambda</span>([&amp;]&#123; <span class="keyword">return</span> ManualAperture; &#125;)</span><br><span class="line">.<span class="built_in">OnValueChanged_Lambda</span>([&amp;](<span class="type">float</span> V)&#123; ManualAperture = V; <span class="keyword">if</span>(ViewportWidget.<span class="built_in">IsValid</span>()) ViewportWidget-&gt;<span class="built_in">SetApertureParam</span>(V); &#125;)</span><br><span class="line">]</span><br><span class="line"><span class="comment">// å¯¹ç„¦</span></span><br><span class="line">+ SHorizontalBox::<span class="built_in">Slot</span>().<span class="built_in">AutoWidth</span>().<span class="built_in">Padding</span>(<span class="number">8</span>,<span class="number">2</span>)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(STextBlock).<span class="built_in">Text</span>(<span class="built_in">LOCTEXT</span>(<span class="string">&quot;Focus&quot;</span>, <span class="string">&quot;å¯¹ç„¦&quot;</span>))</span><br><span class="line">]</span><br><span class="line">+ SHorizontalBox::<span class="built_in">Slot</span>().<span class="built_in">AutoWidth</span>().<span class="built_in">Padding</span>(<span class="number">2</span>)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(SSpinBox&lt;<span class="type">float</span>&gt;).<span class="built_in">MinValue</span>(<span class="number">1.f</span>).<span class="built_in">MaxValue</span>(<span class="number">100000.f</span>)</span><br><span class="line">.<span class="built_in">Value_Lambda</span>([&amp;]&#123; <span class="keyword">return</span> ManualFocus; &#125;)</span><br><span class="line">.<span class="built_in">OnValueChanged_Lambda</span>([&amp;](<span class="type">float</span> V)&#123; ManualFocus = V; <span class="keyword">if</span>(ViewportWidget.<span class="built_in">IsValid</span>()) ViewportWidget-&gt;<span class="built_in">SetFocusDistanceParam</span>(V); &#125;)</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">+ SVerticalBox::<span class="built_in">Slot</span>().<span class="built_in">AutoHeight</span>().<span class="built_in">Padding</span>(<span class="number">0</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(SHorizontalBox)</span><br><span class="line">+ SHorizontalBox::<span class="built_in">Slot</span>().<span class="built_in">AutoWidth</span>().<span class="built_in">Padding</span>(<span class="number">2.f</span>)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(SCheckBox)</span><br><span class="line">.<span class="built_in">IsChecked_Lambda</span>([] &#123; <span class="keyword">return</span> bUseLiveLink ? ECheckBoxState::Checked : ECheckBoxState::Unchecked; &#125;)</span><br><span class="line">.<span class="built_in">OnCheckStateChanged_Lambda</span>([](ECheckBoxState State) &#123; bUseLiveLink = (State == ECheckBoxState::Checked); &#125;)</span><br><span class="line">]</span><br><span class="line">+ SHorizontalBox::<span class="built_in">Slot</span>().<span class="built_in">AutoWidth</span>().<span class="built_in">Padding</span>(<span class="number">2.f</span>)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(STextBlock).<span class="built_in">Text</span>(<span class="built_in">LOCTEXT</span>(<span class="string">&quot;LiveLinkSwitch&quot;</span>, <span class="string">&quot;ä½¿ç”¨LiveLinkå¤–éƒ¨ç›¸æœº&quot;</span>))</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">+ SVerticalBox::<span class="built_in">Slot</span>().<span class="built_in">AutoHeight</span>().<span class="built_in">Padding</span>(<span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(SVerticalBox)</span><br><span class="line">.<span class="built_in">Visibility_Lambda</span>([] &#123; <span class="keyword">return</span> bUseLiveLink ? EVisibility::Visible : EVisibility::Collapsed; &#125;)</span><br><span class="line">+ SVerticalBox::<span class="built_in">Slot</span>().<span class="built_in">AutoHeight</span>()</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(STextBlock).<span class="built_in">Text</span>(<span class="built_in">LOCTEXT</span>(<span class="string">&quot;LiveLinkTitle&quot;</span>, <span class="string">&quot;LiveLinkå¤–éƒ¨ç›¸æœºå‚æ•°&quot;</span>))</span><br><span class="line">]</span><br><span class="line">+ SVerticalBox::<span class="built_in">Slot</span>().<span class="built_in">AutoHeight</span>().<span class="built_in">Padding</span>(<span class="number">0</span>, <span class="number">2</span>)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(STextBlock).<span class="built_in">Text</span>(<span class="built_in">LOCTEXT</span>(<span class="string">&quot;LiveLinkStatus&quot;</span>, <span class="string">&quot;çŠ¶æ€: æœªè¿æ¥/å·²è¿æ¥&quot;</span>))</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">+ SVerticalBox::<span class="built_in">Slot</span>().<span class="built_in">AutoHeight</span>().<span class="built_in">VAlign</span>(VAlign_Bottom).<span class="built_in">Padding</span>(<span class="number">0</span>, <span class="number">16</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(SVerticalBox)</span><br><span class="line">+ SVerticalBox::<span class="built_in">Slot</span>().<span class="built_in">AutoHeight</span>().<span class="built_in">Padding</span>(<span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(SHorizontalBox)</span><br><span class="line">+ SHorizontalBox::<span class="built_in">Slot</span>().<span class="built_in">AutoWidth</span>().<span class="built_in">Padding</span>(<span class="number">2.f</span>)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(STextBlock).<span class="built_in">Text</span>(<span class="built_in">LOCTEXT</span>(<span class="string">&quot;MonitorLabel&quot;</span>, <span class="string">&quot;å±å¹•&quot;</span>))</span><br><span class="line">]</span><br><span class="line">+ SHorizontalBox::<span class="built_in">Slot</span>().<span class="built_in">AutoWidth</span>().<span class="built_in">Padding</span>(<span class="number">2.f</span>)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(SComboBox&lt;TSharedPtr&lt;FString&gt;&gt;)</span><br><span class="line">.<span class="built_in">OptionsSource</span>(&amp;MonitorOptions)</span><br><span class="line">.<span class="built_in">OnSelectionChanged_Lambda</span>([&amp;](TSharedPtr&lt;FString&gt; NewItem, ESelectInfo::Type)&#123; SelectedMonitorIndex = FMath::<span class="built_in">Clamp</span>(MonitorOptions.<span class="built_in">IndexOfByKey</span>(NewItem), <span class="number">0</span>, MonitorOptions.<span class="built_in">Num</span>()<span class="number">-1</span>); &#125;)</span><br><span class="line">.<span class="built_in">OnGenerateWidget_Lambda</span>([](TSharedPtr&lt;FString&gt; InItem)&#123; <span class="keyword">return</span> <span class="built_in">SNew</span>(STextBlock).<span class="built_in">Text</span>(FText::<span class="built_in">FromString</span>(*InItem)); &#125;)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(STextBlock).<span class="built_in">Text_Lambda</span>([&amp;]&#123; <span class="keyword">return</span> MonitorOptions.<span class="built_in">IsValidIndex</span>(SelectedMonitorIndex) ? FText::<span class="built_in">FromString</span>(*MonitorOptions[SelectedMonitorIndex]) : <span class="built_in">LOCTEXT</span>(<span class="string">&quot;MonitorUnknown&quot;</span>,<span class="string">&quot;æœªçŸ¥å±å¹•&quot;</span>); &#125;)</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line">+ SVerticalBox::<span class="built_in">Slot</span>().<span class="built_in">AutoHeight</span>().<span class="built_in">Padding</span>(<span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(SHorizontalBox)</span><br><span class="line">+ SHorizontalBox::<span class="built_in">Slot</span>().<span class="built_in">AutoWidth</span>().<span class="built_in">Padding</span>(<span class="number">2.f</span>)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(STextBlock).<span class="built_in">Text</span>(<span class="built_in">LOCTEXT</span>(<span class="string">&quot;ResolutionLabel&quot;</span>, <span class="string">&quot;è¾“å‡ºåˆ†è¾¨ç‡&quot;</span>))</span><br><span class="line">]</span><br><span class="line">+ SHorizontalBox::<span class="built_in">Slot</span>().<span class="built_in">AutoWidth</span>().<span class="built_in">Padding</span>(<span class="number">2.f</span>)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(SComboBox&lt;TSharedPtr&lt;FString&gt;&gt;)</span><br><span class="line">.<span class="built_in">OptionsSource</span>(&amp;ResolutionOptions)</span><br><span class="line">.<span class="built_in">OnSelectionChanged_Lambda</span>([&amp;](TSharedPtr&lt;FString&gt; NewItem, ESelectInfo::Type) &#123; SelectedResolution = NewItem; &#125;)</span><br><span class="line">.<span class="built_in">OnGenerateWidget_Lambda</span>([](TSharedPtr&lt;FString&gt; InItem) &#123; <span class="keyword">return</span> <span class="built_in">SNew</span>(STextBlock).<span class="built_in">Text</span>(FText::<span class="built_in">FromString</span>(*InItem)); &#125;)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(STextBlock).<span class="built_in">Text_Lambda</span>([&amp;] &#123; <span class="keyword">return</span> SelectedResolution.<span class="built_in">IsValid</span>() ? FText::<span class="built_in">FromString</span>(*SelectedResolution) : <span class="built_in">LOCTEXT</span>(<span class="string">&quot;ResUnknown&quot;</span>,<span class="string">&quot;æœªçŸ¥&quot;</span>); &#125;)</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line">+ SVerticalBox::<span class="built_in">Slot</span>().<span class="built_in">AutoHeight</span>().<span class="built_in">Padding</span>(<span class="number">0</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(SHorizontalBox)</span><br><span class="line">+ SHorizontalBox::<span class="built_in">Slot</span>().<span class="built_in">AutoWidth</span>().<span class="built_in">Padding</span>(<span class="number">2</span>)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(SButton)</span><br><span class="line">.<span class="built_in">Text</span>(<span class="built_in">LOCTEXT</span>(<span class="string">&quot;FullscreenBtn&quot;</span>, <span class="string">&quot;å…¨å±æ˜¾ç¤º&quot;</span>))</span><br><span class="line">.<span class="built_in">OnClicked_Lambda</span>([<span class="keyword">this</span>, ViewportWidget]() &#123;</span><br><span class="line"><span class="keyword">if</span>(!ViewportWidget.<span class="built_in">IsValid</span>()) <span class="keyword">return</span> FReply::<span class="built_in">Handled</span>();</span><br><span class="line">TSharedPtr&lt;FString&gt; LocalSelectedResolution = SelectedResolution;</span><br><span class="line">int32 LocalSelectedMonitorIndex = SelectedMonitorIndex;</span><br><span class="line">int32 W=<span class="number">1920</span>, H=<span class="number">1080</span>;</span><br><span class="line">&#123;</span><br><span class="line">FString Res= LocalSelectedResolution.<span class="built_in">IsValid</span>() ? *LocalSelectedResolution : <span class="built_in">FString</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;1920x1080&quot;</span>));</span><br><span class="line">FString LW, LH;</span><br><span class="line"><span class="keyword">if</span>(Res.<span class="built_in">Split</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;x&quot;</span>), &amp;LW, &amp;LH)) &#123; W = FCString::<span class="built_in">Atoi</span>(*LW); H = FCString::<span class="built_in">Atoi</span>(*LH); &#125;</span><br><span class="line">&#125;</span><br><span class="line">TSharedPtr&lt;SWindow&gt; FullscreenWindow = <span class="built_in">SNew</span>(SWindow)</span><br><span class="line">.<span class="built_in">Title</span>(<span class="built_in">LOCTEXT</span>(<span class="string">&quot;XRFullscreen&quot;</span>, <span class="string">&quot;XRå…¨å±è¾“å‡º&quot;</span>))</span><br><span class="line">.<span class="built_in">ClientSize</span>(<span class="built_in">FVector2D</span>(W, H))</span><br><span class="line">.<span class="built_in">SizingRule</span>(ESizingRule::FixedSize)</span><br><span class="line">.<span class="built_in">SupportsMaximize</span>(<span class="literal">false</span>)</span><br><span class="line">.<span class="built_in">SupportsMinimize</span>(<span class="literal">false</span>)</span><br><span class="line">.<span class="built_in">HasCloseButton</span>(<span class="literal">true</span>)</span><br><span class="line">.<span class="built_in">UseOSWindowBorder</span>(<span class="literal">false</span>)</span><br><span class="line">.<span class="built_in">CreateTitleBar</span>(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">TSharedPtr&lt;STcgXRViewport&gt; FSViewport;</span><br><span class="line">FullscreenWindow-&gt;<span class="built_in">SetContent</span>(<span class="built_in">SAssignNew</span>(FSViewport, STcgXRViewport));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (FSlateApplication::<span class="built_in">IsInitialized</span>())</span><br><span class="line">&#123;</span><br><span class="line">FSlateApplication::<span class="built_in">Get</span>().<span class="built_in">AddWindow</span>(FullscreenWindow.<span class="built_in">ToSharedRef</span>());</span><br><span class="line">FDisplayMetrics Metrics; FSlateApplication::<span class="built_in">Get</span>().<span class="built_in">GetDisplayMetrics</span>(Metrics);</span><br><span class="line">FVector2D <span class="built_in">TargetPos</span>(<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (Metrics.MonitorInfo.<span class="built_in">IsValidIndex</span>(LocalSelectedMonitorIndex))</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">const</span> <span class="keyword">auto</span>&amp; M = Metrics.MonitorInfo[LocalSelectedMonitorIndex];</span><br><span class="line">TargetPos = <span class="built_in">FVector2D</span>(M.WorkArea.Left, M.WorkArea.Top);</span><br><span class="line">&#125;</span><br><span class="line">FullscreenWindow-&gt;<span class="built_in">MoveWindowTo</span>(TargetPos);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">FullscreenWindows.<span class="built_in">Add</span>(FullscreenWindow);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (ViewportWidget-&gt;<span class="built_in">GetClient</span>().<span class="built_in">IsValid</span>() &amp;&amp; FSViewport.<span class="built_in">IsValid</span>())</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">auto</span> Src = ViewportWidget-&gt;<span class="built_in">GetClient</span>();</span><br><span class="line"><span class="keyword">auto</span> Dst = FSViewport-&gt;<span class="built_in">GetClient</span>();</span><br><span class="line">Dst-&gt;<span class="built_in">SetCameraFrom</span>(Src-&gt;<span class="built_in">GetViewLocation</span>(), Src-&gt;<span class="built_in">GetViewRotation</span>(), Src-&gt;<span class="built_in">GetFOV</span>(), <span class="number">2048.f</span>, <span class="literal">false</span>);</span><br><span class="line">Dst-&gt;<span class="built_in">SetFOV</span>(Src-&gt;<span class="built_in">GetFOV</span>());</span><br><span class="line">Dst-&gt;<span class="built_in">SetExposure</span>(Src-&gt;<span class="built_in">GetExposure</span>());</span><br><span class="line">Dst-&gt;<span class="built_in">SetFocalLength</span>(Src-&gt;<span class="built_in">GetFocalLength</span>());</span><br><span class="line">Dst-&gt;<span class="built_in">SetAperture</span>(Src-&gt;<span class="built_in">GetAperture</span>());</span><br><span class="line">Dst-&gt;<span class="built_in">SetFocusDistance</span>(Src-&gt;<span class="built_in">GetFocusDistance</span>());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> FReply::<span class="built_in">Handled</span>();</span><br><span class="line">&#125;)</span><br><span class="line">]</span><br><span class="line">+ SHorizontalBox::<span class="built_in">Slot</span>().<span class="built_in">AutoWidth</span>().<span class="built_in">Padding</span>(<span class="number">2</span>)</span><br><span class="line">[</span><br><span class="line"><span class="built_in">SNew</span>(SButton)</span><br><span class="line">.<span class="built_in">Text</span>(<span class="built_in">LOCTEXT</span>(<span class="string">&quot;CloseFullscreenBtn&quot;</span>, <span class="string">&quot;å…³é—­æ‰€æœ‰å…¨å±&quot;</span>))</span><br><span class="line">.<span class="built_in">OnClicked_Lambda</span>([<span class="keyword">this</span>]()</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">CloseAllFullscreenWindows</span>();</span><br><span class="line"><span class="keyword">return</span> FReply::<span class="built_in">Handled</span>();</span><br><span class="line">&#125;)</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="built_in">RefreshCameraList</span>();</span><br><span class="line"><span class="keyword">return</span> Tab;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> LOCTEXT_NAMESPACE</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">IMPLEMENT_MODULE</span>(FTcgXRModule, TcgXR)</span><br></pre></td></tr></table></figure><h3 id="TcgXRCommands-cpp"><a href="#TcgXRCommands-cpp" class="headerlink" title="TcgXRCommands.cpp"></a>TcgXRCommands.cpp</h3><p><strong>æ–‡ä»¶è·¯å¾„</strong>: <code>Private\TcgXRCommands.cpp</code></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Copyright Epic Games, Inc. All Rights Reserved.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;TcgXRCommands.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LOCTEXT_NAMESPACE <span class="string">&quot;FTcgXRModule&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">FTcgXRCommands::RegisterCommands</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">UI_COMMAND</span>(PluginAction, <span class="string">&quot;TcgXR&quot;</span>, <span class="string">&quot;Execute TcgXR action&quot;</span>, EUserInterfaceActionType::Button, <span class="built_in">FInputChord</span>());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> LOCTEXT_NAMESPACE</span></span><br></pre></td></tr></table></figure><h3 id="TcgXRStyle-cpp"><a href="#TcgXRStyle-cpp" class="headerlink" title="TcgXRStyle.cpp"></a>TcgXRStyle.cpp</h3><p><strong>æ–‡ä»¶è·¯å¾„</strong>: <code>Private\TcgXRStyle.cpp</code></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Copyright Epic Games, Inc. All Rights Reserved.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;TcgXRStyle.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;TcgXR.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Framework/Application/SlateApplication.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Styling/SlateStyleRegistry.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Slate/SlateGameResources.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Interfaces/IPluginManager.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Styling/SlateStyleMacros.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> RootToContentDir Style-&gt;RootToContentDir</span></span><br><span class="line"></span><br><span class="line">TSharedPtr&lt;FSlateStyleSet&gt; FTcgXRStyle::StyleInstance = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">FTcgXRStyle::Initialize</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (!StyleInstance.<span class="built_in">IsValid</span>())</span><br><span class="line">&#123;</span><br><span class="line">StyleInstance = <span class="built_in">Create</span>();</span><br><span class="line">FSlateStyleRegistry::<span class="built_in">RegisterSlateStyle</span>(*StyleInstance);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">FTcgXRStyle::Shutdown</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">FSlateStyleRegistry::<span class="built_in">UnRegisterSlateStyle</span>(*StyleInstance);</span><br><span class="line"><span class="built_in">ensure</span>(StyleInstance.<span class="built_in">IsUnique</span>());</span><br><span class="line">StyleInstance.<span class="built_in">Reset</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">FName <span class="title">FTcgXRStyle::GetStyleSetName</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function"><span class="type">static</span> FName <span class="title">StyleSetName</span><span class="params">(TEXT(<span class="string">&quot;TcgXRStyle&quot;</span>))</span></span>;</span><br><span class="line"><span class="keyword">return</span> StyleSetName;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">const</span> FVector2D <span class="title">Icon16x16</span><span class="params">(<span class="number">16.0f</span>, <span class="number">16.0f</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="type">const</span> FVector2D <span class="title">Icon20x20</span><span class="params">(<span class="number">20.0f</span>, <span class="number">20.0f</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="type">const</span> FVector2D <span class="title">Icon40x40</span><span class="params">(<span class="number">40.0f</span>, <span class="number">40.0f</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function">TSharedRef&lt; FSlateStyleSet &gt; <span class="title">FTcgXRStyle::Create</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">TSharedRef&lt; FSlateStyleSet &gt; Style = <span class="built_in">MakeShareable</span>(<span class="keyword">new</span> <span class="built_in">FSlateStyleSet</span>(<span class="string">&quot;TcgXRStyle&quot;</span>));</span><br><span class="line">Style-&gt;<span class="built_in">SetContentRoot</span>(IPluginManager::<span class="built_in">Get</span>().<span class="built_in">FindPlugin</span>(<span class="string">&quot;TcgXR&quot;</span>)-&gt;<span class="built_in">GetBaseDir</span>() / <span class="built_in">TEXT</span>(<span class="string">&quot;Resources&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Use vector image brushes from Resources/TcgXR.svg for toolbar/menu icons</span></span><br><span class="line">Style-&gt;<span class="built_in">Set</span>(<span class="string">&quot;TcgXR.PluginAction&quot;</span>, <span class="keyword">new</span> <span class="built_in">IMAGE_BRUSH_SVG</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;TcgXR&quot;</span>), Icon40x40));</span><br><span class="line">Style-&gt;<span class="built_in">Set</span>(<span class="string">&quot;TcgXR.PluginAction.Small&quot;</span>, <span class="keyword">new</span> <span class="built_in">IMAGE_BRUSH_SVG</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;TcgXR&quot;</span>), Icon20x20));</span><br><span class="line"><span class="keyword">return</span> Style;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">FTcgXRStyle::ReloadTextures</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (FSlateApplication::<span class="built_in">IsInitialized</span>())</span><br><span class="line">&#123;</span><br><span class="line">FSlateApplication::<span class="built_in">Get</span>().<span class="built_in">GetRenderer</span>()-&gt;<span class="built_in">ReloadTextureResources</span>();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">const</span> ISlateStyle&amp; <span class="title">FTcgXRStyle::Get</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> *StyleInstance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="TcgXRViewportClient-cpp"><a href="#TcgXRViewportClient-cpp" class="headerlink" title="TcgXRViewportClient.cpp"></a>TcgXRViewportClient.cpp</h3><p><strong>æ–‡ä»¶è·¯å¾„</strong>: <code>Private\TcgXRViewportClient.cpp</code></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// FTcgXRViewportClient implementation has been moved inline to TcgXRViewportClient.h</span></span><br><span class="line"><span class="comment">// This translation unit is intentionally left empty to avoid duplicate definitions.</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="STcgXRViewport-h"><a href="#STcgXRViewport-h" class="headerlink" title="STcgXRViewport.h"></a>STcgXRViewport.h</h3><p><strong>æ–‡ä»¶è·¯å¾„</strong>: <code>Public\STcgXRViewport.h</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;SEditorViewport.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FTcgXRViewportClient</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FPreviewScene</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// TcgXRè‡ªå®šä¹‰Viewportæ§ä»¶ï¼Œæ”¯æŒXRåœºæ™¯æ˜¾ç¤ºå’Œç›¸æœºæ§åˆ¶</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">STcgXRViewport</span> :</span> public SEditorViewport</span><br><span class="line">&#123;</span><br><span class="line">public:</span><br><span class="line">    SLATE_BEGIN_ARGS(STcgXRViewport) &#123;&#125;</span><br><span class="line">    SLATE_END_ARGS()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="type">void</span> <span class="title function_">Construct</span><span class="params">(<span class="type">const</span> FArguments&amp; InArgs)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// XRçŠ¶æ€æ§åˆ¶æ¥å£</span></span><br><span class="line">    <span class="type">void</span> <span class="title function_">SetShowKeyed</span><span class="params">(<span class="type">bool</span> b)</span>; <span class="comment">// è®¾ç½®æ˜¯å¦æ˜¾ç¤ºæŠ åƒ</span></span><br><span class="line">    <span class="type">void</span> <span class="title function_">SetVirtualCamMove</span><span class="params">(<span class="type">bool</span> b)</span>; <span class="comment">// è®¾ç½®æ˜¯å¦è™šæ‹Ÿç›¸æœºè¿åŠ¨</span></span><br><span class="line">    <span class="type">void</span> <span class="title function_">SetMixedRealityBlend</span><span class="params">(<span class="type">bool</span> b)</span>; <span class="comment">// è®¾ç½®æ˜¯å¦è™šå®èåˆ</span></span><br><span class="line"></span><br><span class="line">    <span class="type">bool</span> <span class="title function_">IsShowKeyed</span><span class="params">()</span> <span class="type">const</span>; <span class="comment">// æ˜¯å¦æ˜¾ç¤ºæŠ åƒ</span></span><br><span class="line">    <span class="type">bool</span> <span class="title function_">IsVirtualCamMove</span><span class="params">()</span> <span class="type">const</span>; <span class="comment">// æ˜¯å¦è™šæ‹Ÿç›¸æœºè¿åŠ¨</span></span><br><span class="line">    <span class="type">bool</span> <span class="title function_">IsMixedRealityBlend</span><span class="params">()</span> <span class="type">const</span>; <span class="comment">// æ˜¯å¦è™šå®èåˆ</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¿é—®åº•å±‚ViewportClientï¼ˆç”¨äºå¤åˆ¶ç›¸æœº/å‚æ•°åˆ°å…¶å®ƒè§†å£ï¼‰</span></span><br><span class="line">    TSharedPtr&lt;FTcgXRViewportClient&gt; <span class="title function_">GetClient</span><span class="params">()</span> <span class="type">const</span> &#123; <span class="keyword">return</span> ViewportClient; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®‰å…¨è®¾ç½®ç›¸æœºå‚æ•°ï¼šè‹¥Clientå°šæœªå°±ç»ªï¼Œåˆ™ç¼“å­˜ç¨ååº”ç”¨</span></span><br><span class="line">    <span class="type">void</span> <span class="title function_">SetFOVParam</span><span class="params">(<span class="type">float</span> InFOV)</span>;</span><br><span class="line">    <span class="type">void</span> <span class="title function_">SetExposureParam</span><span class="params">(<span class="type">float</span> InExposure)</span>;</span><br><span class="line">    <span class="type">void</span> <span class="title function_">SetFocalLengthParam</span><span class="params">(<span class="type">float</span> InFocal)</span>;</span><br><span class="line">    <span class="type">void</span> <span class="title function_">SetApertureParam</span><span class="params">(<span class="type">float</span> InAperture)</span>;</span><br><span class="line">    <span class="type">void</span> <span class="title function_">SetFocusDistanceParam</span><span class="params">(<span class="type">float</span> InFocus)</span>;</span><br><span class="line"></span><br><span class="line">protected:</span><br><span class="line">    <span class="comment">// åˆ›å»ºè‡ªå®šä¹‰ViewportClient</span></span><br><span class="line">    virtual TSharedRef&lt;FEditorViewportClient&gt; <span class="title function_">MakeEditorViewportClient</span><span class="params">()</span> override;</span><br><span class="line">    <span class="comment">// ä¸æ˜¾ç¤ºé»˜è®¤å·¥å…·æ </span></span><br><span class="line">    virtual TSharedPtr&lt;SWidget&gt; <span class="title function_">MakeViewportToolbar</span><span class="params">()</span> override &#123; <span class="keyword">return</span> SNullWidget::NullWidget; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ•è·é”®ç›˜è¾“å…¥åˆ†å‘åˆ°æ¨¡å—ï¼ˆç”¨äºçƒ­é”®åˆ‡æ¢ç›¸æœºï¼‰</span></span><br><span class="line">    virtual FReply <span class="title function_">OnKeyDown</span><span class="params">(<span class="type">const</span> FGeometry&amp; MyGeometry, <span class="type">const</span> FKeyEvent&amp; InKeyEvent)</span> override;</span><br><span class="line"></span><br><span class="line">private:</span><br><span class="line">    <span class="comment">// åº”ç”¨æ‰€æœ‰ç¼“å­˜çš„ç›¸æœºå‚æ•°</span></span><br><span class="line">    <span class="type">void</span> <span class="title function_">ApplyCachedParams</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">private:</span><br><span class="line">    TSharedPtr&lt;FTcgXRViewportClient&gt; ViewportClient; <span class="comment">// è§†å£å®¢æˆ·ç«¯</span></span><br><span class="line">    TUniquePtr&lt;FPreviewScene&gt; PreviewScene; <span class="comment">// é¢„è§ˆåœºæ™¯</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç¼“å­˜ç›¸æœºå‚æ•°ï¼ˆåœ¨Clientæœªå°±ç»ªæ—¶ä¸´æ—¶ä¿å­˜ï¼‰</span></span><br><span class="line">    TOptional&lt;<span class="type">float</span>&gt; CachedFOV;</span><br><span class="line">    TOptional&lt;<span class="type">float</span>&gt; CachedExposure;</span><br><span class="line">    TOptional&lt;<span class="type">float</span>&gt; CachedFocalLength;</span><br><span class="line">    TOptional&lt;<span class="type">float</span>&gt; CachedAperture;</span><br><span class="line">    TOptional&lt;<span class="type">float</span>&gt; CachedFocusDistance;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="TcgXR-h"><a href="#TcgXR-h" class="headerlink" title="TcgXR.h"></a>TcgXR.h</h3><p><strong>æ–‡ä»¶è·¯å¾„</strong>: <code>Public\TcgXR.h</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Copyright Epic Games, Inc. All Rights Reserved.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Modules/ModuleManager.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FToolBarBuilder</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FMenuBuilder</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ACinemaCameraActor</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ACameraActor</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SWindow</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SVerticalBox</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FTcgXRModule</span> :</span> public IModuleInterface</span><br><span class="line">&#123;</span><br><span class="line">public:</span><br><span class="line"><span class="comment">/** IModuleInterface implementation */</span></span><br><span class="line">virtual <span class="type">void</span> <span class="title function_">StartupModule</span><span class="params">()</span> override;</span><br><span class="line">virtual <span class="type">void</span> <span class="title function_">ShutdownModule</span><span class="params">()</span> override;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** This function will be bound to Command. */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">PluginButtonClicked</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// çƒ­é”®ï¼šå¤„ç†æŒ‰é”®ï¼ˆç”±STcgXRViewportè°ƒç”¨ï¼‰ï¼Œè¿”å›æ˜¯å¦å·²å¤„ç†</span></span><br><span class="line"><span class="type">bool</span> <span class="title function_">HandleKeyDown</span><span class="params">(<span class="type">const</span> FKey&amp; Key)</span>;</span><br><span class="line"><span class="comment">// çƒ­é”®ï¼šç»‘å®šæŸä¸ªç›¸æœºåˆ°æŸä¸ªæŒ‰é”®</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">BindCameraHotkey</span><span class="params">(TWeakObjectPtr&lt;ACameraActor&gt; Camera, <span class="type">const</span> FKey&amp; Key)</span>;</span><br><span class="line"><span class="comment">// åˆ‡æ¢å…³å¡è§†å£åˆ°æŒ‡å®šç›¸æœº</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">SwitchToCamera</span><span class="params">(TWeakObjectPtr&lt;ACameraActor&gt; Camera)</span>;</span><br><span class="line"><span class="comment">// åˆ·æ–°ç›¸æœºåˆ—è¡¨å¹¶é‡å»ºUI</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">RefreshCameraList</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…³é—­æ‰€æœ‰å…¨å±çª—å£</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">CloseAllFullscreenWindows</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ˜¾ç¤ºå½“å‰æ§åˆ¶çš„ç›¸æœºåç§°</span></span><br><span class="line">FText <span class="title function_">GetCurrentControlledCameraText</span><span class="params">()</span> <span class="type">const</span>;</span><br><span class="line"><span class="comment">// è·å–ç›¸æœºå·²ç»‘å®šçš„æŒ‰é”®æ˜¾ç¤ºæ–‡æœ¬</span></span><br><span class="line">FText <span class="title function_">GetBoundKeyTextForCamera</span><span class="params">(TWeakObjectPtr&lt;ACameraActor&gt; Camera)</span> <span class="type">const</span>;</span><br><span class="line"></span><br><span class="line">private:</span><br><span class="line"><span class="type">void</span> <span class="title function_">RegisterMenus</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Spawn the XR viewport tab</span></span><br><span class="line">TSharedRef&lt;class SDockTab&gt; <span class="title function_">OnSpawnPluginTab</span><span class="params">(<span class="type">const</span> class FSpawnTabArgs&amp; Args)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é‡å»ºç›¸æœºçƒ­é”®ç»‘å®šUI</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">RebuildCameraHotkeyUI</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">private:</span><br><span class="line">TSharedPtr&lt;<span class="class"><span class="keyword">class</span> <span class="title">FUICommandList</span>&gt;</span> PluginCommands;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›¸æœºä¸çƒ­é”®æ˜ å°„</span></span><br><span class="line">TMap&lt;FKey, TWeakObjectPtr&lt;ACameraActor&gt;&gt; CameraHotkeyMap;</span><br><span class="line">TArray&lt;TWeakObjectPtr&lt;ACameraActor&gt;&gt; CachedCameras;</span><br><span class="line">TWeakPtr&lt;SVerticalBox&gt; CameraListPanel;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›‘å¬å¥æŸ„</span></span><br><span class="line">FDelegateHandle ActorAddedHandle;</span><br><span class="line">FDelegateHandle ActorDeletedHandle;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…¨å±çª—å£åˆ—è¡¨</span></span><br><span class="line">TArray&lt;TWeakPtr&lt;SWindow&gt;&gt; FullscreenWindows;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="TcgXRCommands-h"><a href="#TcgXRCommands-h" class="headerlink" title="TcgXRCommands.h"></a>TcgXRCommands.h</h3><p><strong>æ–‡ä»¶è·¯å¾„</strong>: <code>Public\TcgXRCommands.h</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Copyright Epic Games, Inc. All Rights Reserved.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Framework/Commands/Commands.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;TcgXRStyle.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FTcgXRCommands</span> :</span> public TCommands&lt;FTcgXRCommands&gt;</span><br><span class="line">&#123;</span><br><span class="line">public:</span><br><span class="line"></span><br><span class="line">FTcgXRCommands()</span><br><span class="line">: TCommands&lt;FTcgXRCommands&gt;(TEXT(<span class="string">&quot;TcgXR&quot;</span>), NSLOCTEXT(<span class="string">&quot;Contexts&quot;</span>, <span class="string">&quot;TcgXR&quot;</span>, <span class="string">&quot;TcgXR Plugin&quot;</span>), NAME_None, FTcgXRStyle::GetStyleSetName())</span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TCommands&lt;&gt; interface</span></span><br><span class="line">virtual <span class="type">void</span> <span class="title function_">RegisterCommands</span><span class="params">()</span> override;</span><br><span class="line"></span><br><span class="line">public:</span><br><span class="line">TSharedPtr&lt; FUICommandInfo &gt; PluginAction;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="TcgXRStyle-h"><a href="#TcgXRStyle-h" class="headerlink" title="TcgXRStyle.h"></a>TcgXRStyle.h</h3><p><strong>æ–‡ä»¶è·¯å¾„</strong>: <code>Public\TcgXRStyle.h</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Copyright Epic Games, Inc. All Rights Reserved.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Styling/SlateStyle.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FTcgXRStyle</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">public:</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">Initialize</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">Shutdown</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** reloads textures used by slate renderer */</span></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">ReloadTextures</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** @return The Slate style set for the Shooter game */</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> ISlateStyle&amp; <span class="title function_">Get</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> FName <span class="title function_">GetStyleSetName</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">private:</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> TSharedRef&lt; class FSlateStyleSet &gt; <span class="title function_">Create</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">private:</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> TSharedPtr&lt; <span class="class"><span class="keyword">class</span> <span class="title">FSlateStyleSet</span> &gt;</span> StyleInstance;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="TcgXRViewportClient-h"><a href="#TcgXRViewportClient-h" class="headerlink" title="TcgXRViewportClient.h"></a>TcgXRViewportClient.h</h3><p><strong>æ–‡ä»¶è·¯å¾„</strong>: <code>Public\TcgXRViewportClient.h</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;EditorViewportClient.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;PreviewScene.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;SEditorViewport.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Editor.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;SceneView.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// TcgXRè‡ªå®šä¹‰ViewportClientï¼Œè´Ÿè´£ç›¸æœºæ§åˆ¶ã€XRæ˜¾ç¤ºç­‰</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FTcgXRViewportClient</span> :</span> public FEditorViewportClient</span><br><span class="line">&#123;</span><br><span class="line">public:</span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•°ï¼Œåˆå§‹åŒ–è§†å£å‚æ•°</span></span><br><span class="line">    FTcgXRViewportClient(FPreviewScene* InPreviewScene, <span class="type">const</span> TSharedRef&lt;SEditorViewport&gt;&amp; InEditorViewport)</span><br><span class="line">        : FEditorViewportClient(nullptr, InPreviewScene, InEditorViewport)</span><br><span class="line">    &#123;</span><br><span class="line">        SetViewLocation(FVector(<span class="number">0</span>, <span class="number">-300</span>, <span class="number">200</span>));</span><br><span class="line">        SetViewRotation(FRotator(<span class="number">-10</span>, <span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line">        SetRealtime(<span class="literal">true</span>);</span><br><span class="line">        EngineShowFlags.SetGrid(<span class="literal">true</span>);</span><br><span class="line">        EngineShowFlags.EnableAdvancedFeatures();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¸²æŸ“ä¸»ç¼–è¾‘å™¨ä¸–ç•Œï¼Œä¿è¯è§†å£å†…å®¹ä¸ä¸»åœºæ™¯ä¸€è‡´</span></span><br><span class="line">    virtual UWorld* <span class="title function_">GetWorld</span><span class="params">()</span> <span class="type">const</span> override</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> (GEditor) ? GEditor-&gt;GetEditorWorldContext().World() : nullptr;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// XRç›¸å…³åˆ‡æ¢</span></span><br><span class="line">    <span class="type">void</span> <span class="title function_">SetShowKeyed</span><span class="params">(<span class="type">bool</span> bValue)</span></span><br><span class="line">    &#123;</span><br><span class="line">        bShowKeyed = bValue;</span><br><span class="line">        EngineShowFlags.PostProcessing = bShowKeyed; <span class="comment">// ç¤ºä¾‹ï¼šåˆ‡æ¢åå¤„ç†</span></span><br><span class="line">        Invalidate();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">void</span> <span class="title function_">SetVirtualCamMove</span><span class="params">(<span class="type">bool</span> bValue)</span></span><br><span class="line">    &#123;</span><br><span class="line">        bVirtualCamMove = bValue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">void</span> <span class="title function_">SetMixedRealityBlend</span><span class="params">(<span class="type">bool</span> bValue)</span></span><br><span class="line">    &#123;</span><br><span class="line">        bMixedRealityBlend = bValue;</span><br><span class="line">        Invalidate();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç›¸æœºå‚æ•°æ§åˆ¶</span></span><br><span class="line">    <span class="type">void</span> <span class="title function_">SetFOV</span><span class="params">(<span class="type">float</span> InFOV)</span></span><br><span class="line">    &#123;</span><br><span class="line">        ViewFOV = FMath::Clamp(InFOV, <span class="number">15.f</span>, <span class="number">170.f</span>);</span><br><span class="line">        Invalidate();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">float</span> <span class="title function_">GetFOV</span><span class="params">()</span> <span class="type">const</span> &#123; <span class="keyword">return</span> ViewFOV; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">void</span> <span class="title function_">SetExposure</span><span class="params">(<span class="type">float</span> InExposure)</span></span><br><span class="line">    &#123;</span><br><span class="line">        ManualExposureBias = FMath::Clamp(InExposure, <span class="number">-10.f</span>, <span class="number">10.f</span>);</span><br><span class="line">        bApplyExposureBias = <span class="literal">true</span>; <span class="comment">// å¯ç”¨æ›å…‰è¡¥å¿</span></span><br><span class="line">        Invalidate();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">float</span> <span class="title function_">GetExposure</span><span class="params">()</span> <span class="type">const</span> &#123; <span class="keyword">return</span> ManualExposureBias; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">void</span> <span class="title function_">SetFocalLength</span><span class="params">(<span class="type">float</span> InFocalLength)</span></span><br><span class="line">    &#123;</span><br><span class="line">        FocalLength = FMath::Max(<span class="number">1.f</span>, InFocalLength);</span><br><span class="line">        <span class="comment">// ä½¿ç”¨é»˜è®¤èƒ¶ç‰‡å®½åº¦36mmå°†ç„¦è·æ˜ å°„åˆ°FOV</span></span><br><span class="line">        <span class="type">const</span> <span class="type">float</span> SensorWidth = <span class="number">36.0f</span>; <span class="comment">// mm</span></span><br><span class="line">        <span class="type">const</span> <span class="type">float</span> HFOVRadians = <span class="number">2.f</span> * FMath::Atan((SensorWidth * <span class="number">0.5f</span>) / FocalLength);</span><br><span class="line">        SetFOV(FMath::RadiansToDegrees(HFOVRadians));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">float</span> <span class="title function_">GetFocalLength</span><span class="params">()</span> <span class="type">const</span> &#123; <span class="keyword">return</span> FocalLength; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">void</span> <span class="title function_">SetAperture</span><span class="params">(<span class="type">float</span> InAperture)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Aperture = FMath::Clamp(InAperture, <span class="number">0.7f</span>, <span class="number">32.f</span>);</span><br><span class="line">        bApplyDOF = <span class="literal">true</span>; <span class="comment">// å¯ç”¨æ™¯æ·±è¦†ç›–</span></span><br><span class="line">        Invalidate();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">float</span> <span class="title function_">GetAperture</span><span class="params">()</span> <span class="type">const</span> &#123; <span class="keyword">return</span> Aperture; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">void</span> <span class="title function_">SetFocusDistance</span><span class="params">(<span class="type">float</span> InDistance)</span></span><br><span class="line">    &#123;</span><br><span class="line">        FocusDistance = FMath::Max(<span class="number">1.f</span>, InDistance);</span><br><span class="line">        bApplyDOF = <span class="literal">true</span>;</span><br><span class="line">        Invalidate();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">float</span> <span class="title function_">GetFocusDistance</span><span class="params">()</span> <span class="type">const</span> &#123; <span class="keyword">return</span> FocusDistance; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä»å¤–éƒ¨è§†å£å¤åˆ¶ç›¸æœºå‚æ•°</span></span><br><span class="line">    <span class="type">void</span> <span class="title function_">SetCameraFrom</span><span class="params">(<span class="type">const</span> FVector&amp; InLoc, <span class="type">const</span> FRotator&amp; InRot, <span class="type">float</span> InFOV, <span class="type">float</span> InOrthoWidth, <span class="type">bool</span> bInIsOrtho)</span></span><br><span class="line">    &#123;</span><br><span class="line">        SetViewLocation(InLoc);</span><br><span class="line">        SetViewRotation(InRot);</span><br><span class="line">        <span class="keyword">if</span> (bInIsOrtho)</span><br><span class="line">        &#123;</span><br><span class="line">            SetViewportType(LVT_OrthoFreelook);</span><br><span class="line">            SetOrthoZoom(InOrthoWidth);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            SetViewportType(LVT_Perspective);</span><br><span class="line">            ViewFOV = InFOV;</span><br><span class="line">        &#125;</span><br><span class="line">        Invalidate();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    virtual <span class="type">void</span> <span class="title function_">Tick</span><span class="params">(<span class="type">float</span> DeltaSeconds)</span> override</span><br><span class="line">    &#123;</span><br><span class="line">        FEditorViewportClient::Tick(DeltaSeconds);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!bVirtualCamMove &amp;&amp; GEditor)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (FEditorViewportClient* VC : GEditor-&gt;GetAllViewportClients())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (VC &amp;&amp; VC-&gt;IsPerspective())</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="type">const</span> FVector Loc = VC-&gt;GetViewLocation();</span><br><span class="line">                    <span class="type">const</span> FRotator Rot = VC-&gt;GetViewRotation();</span><br><span class="line">                    <span class="type">const</span> <span class="type">bool</span> bIsOrtho = VC-&gt;IsOrtho();</span><br><span class="line">                    <span class="type">const</span> <span class="type">float</span> FOV = ViewFOV; <span class="comment">// ä½¿ç”¨å½“å‰FOV</span></span><br><span class="line">                    <span class="type">const</span> <span class="type">float</span> OrthoWidth = <span class="number">2048.f</span>;</span><br><span class="line">                    SetCameraFrom(Loc, Rot, FOV, OrthoWidth, bIsOrtho);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (bVirtualCamMove)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">const</span> <span class="type">float</span> Speed = <span class="number">15.f</span>;</span><br><span class="line">            FRotator R = GetViewRotation();</span><br><span class="line">            R.Yaw += Speed * DeltaSeconds;</span><br><span class="line">            SetViewRotation(R);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¦†ç›–åå¤„ç†å‚æ•°ï¼šä»…åœ¨éœ€è¦æ—¶è®¾ç½®æ›å…‰è¡¥å¿/æ™¯æ·±ï¼Œå°½é‡ä¿æŒä¸ç¼–è¾‘å™¨è§†å£ä¸€è‡´</span></span><br><span class="line">    virtual <span class="type">void</span> <span class="title function_">OverridePostProcessSettings</span><span class="params">(FSceneView&amp; View)</span> override</span><br><span class="line">    &#123;</span><br><span class="line">        FEditorViewportClient::OverridePostProcessSettings(View);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (bApplyExposureBias)</span><br><span class="line">        &#123;</span><br><span class="line">            View.FinalPostProcessSettings.bOverride_AutoExposureBias = <span class="literal">true</span>;</span><br><span class="line">            View.FinalPostProcessSettings.AutoExposureBias = ManualExposureBias;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (bApplyDOF)</span><br><span class="line">        &#123;</span><br><span class="line">            View.FinalPostProcessSettings.bOverride_DepthOfFieldFstop = <span class="literal">true</span>;</span><br><span class="line">            View.FinalPostProcessSettings.DepthOfFieldFstop = Aperture;</span><br><span class="line">            View.FinalPostProcessSettings.bOverride_DepthOfFieldFocalDistance = <span class="literal">true</span>;</span><br><span class="line">            View.FinalPostProcessSettings.DepthOfFieldFocalDistance = FocusDistance;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// XRçŠ¶æ€æŸ¥è¯¢</span></span><br><span class="line">    <span class="type">bool</span> <span class="title function_">IsShowKeyed</span><span class="params">()</span> <span class="type">const</span> &#123; <span class="keyword">return</span> bShowKeyed; &#125;</span><br><span class="line">    <span class="type">bool</span> <span class="title function_">IsVirtualCamMove</span><span class="params">()</span> <span class="type">const</span> &#123; <span class="keyword">return</span> bVirtualCamMove; &#125;</span><br><span class="line">    <span class="type">bool</span> <span class="title function_">IsMixedRealityBlend</span><span class="params">()</span> <span class="type">const</span> &#123; <span class="keyword">return</span> bMixedRealityBlend; &#125;</span><br><span class="line"></span><br><span class="line">private:</span><br><span class="line">    <span class="type">bool</span> bShowKeyed = <span class="literal">false</span>; <span class="comment">// æ˜¯å¦æ˜¾ç¤ºæŠ åƒ</span></span><br><span class="line">    <span class="type">bool</span> bVirtualCamMove = <span class="literal">false</span>; <span class="comment">// æ˜¯å¦è™šæ‹Ÿç›¸æœºè¿åŠ¨</span></span><br><span class="line">    <span class="type">bool</span> bMixedRealityBlend = <span class="literal">true</span>; <span class="comment">// æ˜¯å¦è™šå®èåˆ</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç›¸æœºå¯è°ƒå‚æ•°</span></span><br><span class="line">    <span class="type">float</span> ManualExposureBias = <span class="number">0.f</span>; <span class="comment">// æ›å…‰è¡¥å¿ï¼ˆlog2EVï¼‰</span></span><br><span class="line">    <span class="type">bool</span>  bApplyExposureBias = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">float</span> FocalLength = <span class="number">35.f</span>;   <span class="comment">// ç„¦è·ï¼ˆmmï¼‰</span></span><br><span class="line">    <span class="type">float</span> Aperture = <span class="number">2.8f</span>;      <span class="comment">// å…‰åœˆï¼ˆFï¼‰</span></span><br><span class="line">    <span class="type">float</span> FocusDistance = <span class="number">1000.f</span>; <span class="comment">// å¯¹ç„¦è·ç¦»</span></span><br><span class="line">    <span class="type">bool</span>  bApplyDOF = <span class="literal">false</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="TcgXR-Build-cs"><a href="#TcgXR-Build-cs" class="headerlink" title="TcgXR.Build.cs"></a>TcgXR.Build.cs</h3><p><strong>æ–‡ä»¶è·¯å¾„</strong>: <code>TcgXR.Build.cs</code></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Copyright Epic Games, Inc. All Rights Reserved.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> UnrealBuildTool;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TcgXR</span> : <span class="title">ModuleRules</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">TcgXR</span>(<span class="params">ReadOnlyTargetRules Target</span>) : <span class="title">base</span>(<span class="params">Target</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">PCHUsage = ModuleRules.PCHUsageMode.UseExplicitOrSharedPCHs;</span><br><span class="line"></span><br><span class="line">PublicIncludePaths.AddRange(</span><br><span class="line"><span class="keyword">new</span> <span class="built_in">string</span>[] &#123;</span><br><span class="line"><span class="comment">// ... add public include paths required here ...</span></span><br><span class="line">&#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PrivateIncludePaths.AddRange(</span><br><span class="line"><span class="keyword">new</span> <span class="built_in">string</span>[] &#123;</span><br><span class="line"><span class="comment">// ... add other private include paths required here ...</span></span><br><span class="line">&#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PublicDependencyModuleNames.AddRange(</span><br><span class="line"><span class="keyword">new</span> <span class="built_in">string</span>[]</span><br><span class="line">&#123;</span><br><span class="line"><span class="string">&quot;Core&quot;</span>,</span><br><span class="line"><span class="comment">// ... add other public dependencies that you statically link with here ...</span></span><br><span class="line">&#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PrivateDependencyModuleNames.AddRange(</span><br><span class="line"><span class="keyword">new</span> <span class="built_in">string</span>[]</span><br><span class="line">&#123;</span><br><span class="line"><span class="string">&quot;Projects&quot;</span>,</span><br><span class="line"><span class="string">&quot;InputCore&quot;</span>,</span><br><span class="line"><span class="string">&quot;EditorFramework&quot;</span>,</span><br><span class="line"><span class="string">&quot;UnrealEd&quot;</span>,</span><br><span class="line"><span class="string">&quot;ToolMenus&quot;</span>,</span><br><span class="line"><span class="string">&quot;CoreUObject&quot;</span>,</span><br><span class="line"><span class="string">&quot;Engine&quot;</span>,</span><br><span class="line"><span class="string">&quot;Slate&quot;</span>,</span><br><span class="line"><span class="string">&quot;SlateCore&quot;</span>,</span><br><span class="line"><span class="string">&quot;AppFramework&quot;</span>,</span><br><span class="line"><span class="string">&quot;LevelEditor&quot;</span>,</span><br><span class="line"><span class="string">&quot;CinematicCamera&quot;</span>, <span class="comment">// ä½¿ç”¨ç”µå½±ç›¸æœº</span></span><br><span class="line"><span class="comment">// ... add private dependencies that you statically link with here ...</span></span><br><span class="line">&#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DynamicallyLoadedModuleNames.AddRange(</span><br><span class="line"><span class="keyword">new</span> <span class="built_in">string</span>[]</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// ... add any modules that your module loads dynamically here ...</span></span><br><span class="line">&#125;</span><br><span class="line">);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ol><li><a href="https://www.bilibili.com/video/BV17NQVYBEBi/">æœ€åŸºç¡€æ¦‚è§ˆè§†é¢‘</a>:æˆ‘çœ‹ç€è¿™ä¸ªè§†é¢‘ä½œä¸ºæœ€åˆçš„å…¥é—¨</li><li><a href="https://www.youtube.com/watch?v=vI_b2OO4yZE">Aximmetry Eye Camera Tracking Device</a>ï¼šé‡Œé¢è¿˜æåŠäº†å¦‚ä½•è§£å†³TimeCodeçš„é—®é¢˜</li><li><a href="https://www.youtube.com/watch?v=dugtm2TlY44">Virtual Production demo with Aximmetry Eye mobile app</a>ï¼šè¿™é‡Œé¢æåŠäº†Iphoneæ•°æ®æµé€å›æ¥çš„æ–¹æ¡ˆ</li><li><a href="https://www.youtube.com/watch?v=tm_5o6eRcpM">Aximmetry Eye VIrtual Camera Tracker</a>ï¼šé‡Œé¢æœ‰æåŠæ ‡å®šçš„äº‹æƒ…ï¼Œä¹Ÿæœ‰æåŠï¼ˆå¯èƒ½ï¼‰ä½¿ç”¨WIFI6èƒ½å¤Ÿå®ç°æ— çº¿ä¼ è¾“ã€‚</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Aximmetry-ä½æˆæœ¬XRæ–¹æ¡ˆæŠ˜è…¾ç¬”è®°&quot;&gt;&lt;a href=&quot;#Aximmetry-ä½æˆæœ¬XRæ–¹æ¡ˆæŠ˜è…¾ç¬”è®°&quot; class=&quot;headerlink&quot; title=&quot;Aximmetry ä½æˆæœ¬XRæ–¹æ¡ˆæŠ˜è…¾ç¬”è®°&quot;&gt;&lt;/a&gt;Aximmetry ä½æˆæœ¬XRæ–¹æ¡ˆæŠ˜è…¾ç¬”è®°&lt;/</summary>
      
    
    
    
    
    <category term="XR" scheme="http://example.com/tags/XR/"/>
    
    <category term="Aximmetry" scheme="http://example.com/tags/Aximmetry/"/>
    
  </entry>
  
  <entry>
    <title>Shader Learning Notes</title>
    <link href="http://example.com/2025/08/01/Shader%20Learning%20Note/"/>
    <id>http://example.com/2025/08/01/Shader%20Learning%20Note/</id>
    <published>2025-08-01T04:34:56.000Z</published>
    <updated>2025-11-11T13:39:28.193Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Unreal-Shaderå­¦ä¹ "><a href="#Unreal-Shaderå­¦ä¹ " class="headerlink" title="Unreal Shaderå­¦ä¹ "></a>Unreal Shaderå­¦ä¹ </h1><h2 id="å®‰è£…åŠåŸºç¡€æ¦‚å¿µ"><a href="#å®‰è£…åŠåŸºç¡€æ¦‚å¿µ" class="headerlink" title="å®‰è£…åŠåŸºç¡€æ¦‚å¿µ"></a>å®‰è£…åŠåŸºç¡€æ¦‚å¿µ</h2><p><a href="https://juejin.cn/post/7164635658084941837">çŸ¥ä¹ ã€ŠShaderä»å…¥é—¨åˆ°æ”¾å¼ƒã€‹ åœ¨VSä¸­å¯ä»¥å®‰è£…ShaderToyæ¥è§‚æµ‹GLSL</a><br>ğŸ‘†è¿™ä¸ªæ–‡å­—æ•™ç¨‹ä¹Ÿæ˜¯å¾ˆä¸é”™çš„</p><p><a href="https://juejin.cn/post/7089771936271564807">Unreal 5.0 æè´¨ä¸­æ·»åŠ è‡ªå®šä¹‰ Shader ä»£ç </a>  åœ¨UEä¸­éœ€è¦è®¾ç½®Shderæ–‡ä»¶çš„ä½ç½®</p><p>&lt;img src&#x3D;â€<a href="https://s2.loli.net/2025/09/13/CxzRNf1Witu69IU.png">https://s2.loli.net/2025/09/13/CxzRNf1Witu69IU.png</a>â€œ alt&#x3D;â€Unreal ShaåŸæœ¬çš„3Dæµç¨‹åº”è¯¥æ˜¯ï¼šâ€åŸç”»å¸ˆç»˜åˆ¶åœºæ™¯å›¾ï¼ˆå°†3Dåœºæ™¯ç”»ä¸‹æ¥ï¼‰ -&gt; å»ºæ¨¡å¸ˆæ ¹æ®åŸç”»æ„å»ºåœºæ™¯æ¨¡å‹ï¼ˆäº§å‡º3Dæ¨¡å‹ï¼‰-&gt; ç¨‹åºæ¸²æŸ“ï¼ˆå°†3Dæ¨¡å‹å¯¼å…¥åˆ°å¼•æ“ä¸­ï¼Œæˆ–è€…å…¶ä»–3Dæ¸²æŸ“åº“ï¼‰ï¼Œç„¶åæ¸²æŸ“æˆç”»é¢â€ã€‚</p><img src="https://s2.loli.net/2025/09/13/bGh2JSUj4oK1WVI.png" alt="img" style="width: 30%;"><p>ä¸»è¦æ˜¯ä¸¤ç§ç€è‰²å™¨ï¼š</p><ol><li><p><strong>Fragment Shader</strong>ï¼ˆç‰‡å…ƒshaderï¼‰ï¼šè¾“å…¥æ’å€¼åçš„é¡¶ç‚¹æ•°æ®ï¼Œè¾“å‡ºæœ€ç»ˆåƒç´ é¢œè‰²ï¼ˆ<code>fragColor</code>ï¼‰ã€‚</p></li><li><p><strong>Vertex Shader</strong>ï¼ˆé¡¶ç‚¹Shaderï¼‰ï¼šè¾“å…¥å•ä¸ªé¡¶ç‚¹æ•°æ®ï¼ˆä½ç½®&#x2F;æ³•çº¿ç­‰ï¼‰ï¼Œè¾“å‡ºå¤„ç†åçš„é¡¶ç‚¹ä½ç½®ï¼ˆ<code>gl_Position</code>ï¼‰å’Œå…¶ä»–æ’å€¼æ•°æ®ã€‚</p></li><li><p>compute shader è®¡ç®—ç€è‰²å™¨</p></li><li><p>geometry shader å‡ ä½•ç€è‰²å™¨</p></li><li><p>â€¦.</p></li></ol><h1 id="HLSL"><a href="#HLSL" class="headerlink" title="HLSL"></a>HLSL</h1><h2 id="åŸºç¡€çš„è¯­æ³•"><a href="#åŸºç¡€çš„è¯­æ³•" class="headerlink" title="åŸºç¡€çš„è¯­æ³•"></a>åŸºç¡€çš„è¯­æ³•</h2><table><thead><tr><th>min max<br/></th><th>æœ€å¤§æœ€å°<br/></th></tr></thead><tbody><tr><td>abs<br/></td><td>ç»å¯¹å€¼<br/></td></tr><tr><td>fmod<br/></td><td>å–ä½™æ“ä½œ<br/></td></tr><tr><td>round<br/></td><td>å››èˆäº”å…¥<br/></td></tr><tr><td>pow<br/></td><td>æŒ‡æ•°<br/></td></tr><tr><td>sqrt rsqrt<br/></td><td>å¹³æ–¹æ ¹ å’Œ å€’æ•°å¹³æ–¹æ ¹<br/></td></tr><tr><td>degreesï¼ˆxï¼‰ redians<br/></td><td>å¼§åº¦è½¬è§’åº¦ è§’åº¦è½¬å¼§åº¦<br/></td></tr><tr><td>length<br/></td><td>å‘é‡åˆ°åŸç‚¹çš„è·ç¦»<br/></td></tr><tr><td>frac(sin(dot(uv, float2(12.9898, 78.233))) * 43758.5453);<br/></td><td>å™ªå£°ç®—æ³•<br/></td></tr><tr><td>sin cos tan<br/></td><td>ä¸‰è§’å‡½æ•°<br/></td></tr><tr><td>asin acos atan<br/></td><td>ä»–ä»¬çš„åå‡½æ•°<br/></td></tr><tr><td>sinh cosh tanh<br/></td><td>åŒæ›²çº¿å‡½æ•°<br/></td></tr><tr><td>ceil<br/></td><td>æ•°å€¼èŒƒå›´å‡½æ•°<br/></td></tr></tbody></table><img src="https://s2.loli.net/2025/09/13/Db5ArJdyQv7E9YG.png" alt="Unreal Shaderå­¦ä¹ -1" style="width: 30%;"><h2 id="UVåæ ‡ç³»è¯´æ˜"><a href="#UVåæ ‡ç³»è¯´æ˜" class="headerlink" title="UVåæ ‡ç³»è¯´æ˜:"></a><strong>UVåæ ‡ç³»è¯´æ˜:</strong></h2><ul><li>åŸç‚¹ <strong>(0,0)</strong> ä½äºå·¦ä¸‹è§’</li><li>(0,1) å·¦ä¸Šè§’ï¼Œ(1,1) å³ä¸Šè§’ï¼Œ(1,0) å³ä¸‹è§’</li></ul><h1 id="GLSL"><a href="#GLSL" class="headerlink" title="GLSL"></a>GLSL</h1><h2 id="åŸºç¡€è¯­æ³•"><a href="#åŸºç¡€è¯­æ³•" class="headerlink" title="åŸºç¡€è¯­æ³•"></a>åŸºç¡€è¯­æ³•</h2><h3 id="step"><a href="#step" class="headerlink" title="step"></a>step</h3><blockquote><p>å¦‚æœx å°äºæŸä¸ªå€¼ï¼Œåˆ™è¿”å› 0ï¼Œå¦‚æœå¤§äºç­‰äºè¿™ä¸ªå€¼ï¼Œåˆ™è¿”å›1ã€‚</p></blockquote><p>æ‰€ä»¥ä¸Šé¢çš„ä»£ç å¯ä»¥ç®€åŒ–æˆï¼š</p><figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// if(abs(uv.x) &lt;= 2. * fwidth(uv.x)) &#123;</span></span><br><span class="line"><span class="comment">//     color = vec3(0.0, 1.0, 0.0);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// ===&gt;</span></span><br><span class="line"></span><br><span class="line">color = <span class="built_in">step</span>(<span class="built_in">abs</span>(uv.x), <span class="number">2.0</span> * <span class="built_in">fwidth</span>(uv.x)) * <span class="type">vec3</span>(<span class="number">0.0</span>, <span class="number">1.0</span>, <span class="number">0.0</span>);</span><br></pre></td></tr></table></figure><h3 id="mix"><a href="#mix" class="headerlink" title="mix"></a>mix</h3><blockquote><p>è¯¥å‡½æ•°çš„å®é™…ä¸Šæ‰§è¡Œçš„å°±æ˜¯ä¸€ä¸ªç®€å•çš„ <em><strong>çº¿æ€§å·®å€¼</strong></em>ã€‚ ç®€å•çš„è¯´å°±æ˜¯ï¼šå½“a &#x3D; 1æ—¶ï¼Œè¿”å›çš„å€¼ä¸ºy, ä½†a &#x3D; 0æ—¶ï¼Œè¿”å›xçš„å€¼ï¼Œå¦‚æœè¿”å›çš„å€¼ä¸º0.5ï¼Œåˆ™è¿”å› <code>0.5x + 0.5y</code>çš„å€¼ï¼ŒåŒç†ï¼Œå¦‚æœa &#x3D; 0.2, è¿”å› <code>0.8 * a + 0.2 * y</code>ã€‚</p></blockquote><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªå‡½æ•°æ¥åšé¢œè‰²å åŠ ï¼Œé¢œè‰²å åŠ çš„å…¬å¼å¯ä»¥å†™ä¸ºï¼š<br>$$<br>Color&#x3D;Src.colorâˆ—(1âˆ’Dst.a)+Dst.colorâˆ—Dst.a<br>$$</p><h3 id="smoothstep"><a href="#smoothstep" class="headerlink" title="smoothstep"></a>smoothstep</h3><img src="https://s2.loli.net/2025/09/13/serIA7TCWUdJnBY.png" alt="ShaderSmoothstep" style="width: 30%;"><p>æˆ‘ä»¬å¯ä»¥ç›´è§‚çš„çœ‹å‡ºï¼šå½“x &lt; 0æ—¶ï¼Œè¿”å›0ï¼Œå½“ x &gt; 1æ—¶ï¼Œè¿”å›1ï¼Œå¦‚æœ x å¤„äº0~1ä¹‹é—´æ—¶ï¼Œåˆ™æœ‰ä¸€ä¸ªç±»ä¼¼äºçº¿æ€§æ’å€¼çš„è¿‡æ¸¡ï¼Œä½†æ˜¯è¯·æ³¨æ„ï¼Œè¿™é‡Œå¹¶ä¸æ˜¯çº¿æ€§æ’å€¼ï¼Œå› ä¸ºåœ¨æ¥è¿‘ä¸¤ç«¯çš„å€¼çš„æ—¶å€™ï¼Œè¯¥å‡½æ•°æœ‰ä¸€ä¸ªå¹³æ»‘çš„è¿‡æ¸¡ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸€ç‚¹æ¥å¯¹ <code>step</code> å‡½æ•°è¿›è¡Œæ›¿æ¢ä»¥è§£å†³é”¯é½¿çš„é—®é¢˜ã€‚</p><h3 id="floor"><a href="#floor" class="headerlink" title="floor"></a>floor</h3><p> ä½œç”¨æ˜¯<strong>å‘ä¸‹å–æ•´</strong>ï¼Œå®ƒä¼šè¿”å›ä¸å¤§äºè¾“å…¥å€¼çš„æœ€å¤§æ•´æ•°ã€‚ä¾‹å¦‚ï¼šå¯¹ <code>uv</code> å‘é‡çš„æ¯ä¸ªåˆ†é‡ï¼ˆxå’Œyï¼‰åˆ†åˆ«æ‰§è¡Œå‘ä¸‹å–æ•´</p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">floor</span>(<span class="number">3.7</span>)` â†’ `<span class="number">3.0</span></span><br><span class="line"><span class="built_in">floor</span>(<span class="number">-1.2</span>)` â†’ `<span class="number">-2.0</span></span><br></pre></td></tr></table></figure><h2 id="æ ¸å¿ƒæ­¥éª¤ï¼ˆæ¸²æŸ“ç®¡çº¿ï¼‰"><a href="#æ ¸å¿ƒæ­¥éª¤ï¼ˆæ¸²æŸ“ç®¡çº¿ï¼‰" class="headerlink" title="æ ¸å¿ƒæ­¥éª¤ï¼ˆæ¸²æŸ“ç®¡çº¿ï¼‰"></a>æ ¸å¿ƒæ­¥éª¤ï¼ˆæ¸²æŸ“ç®¡çº¿ï¼‰</h2><ol><li>é¡¶ç‚¹å˜æ¢çš„è¿‡ç¨‹ï¼ˆé¡¶ç‚¹ç€è‰²å™¨ï¼‰</li><li>å›¾å…ƒè£…é…ï¼ˆæŒ‰å“ªç§æ–¹å¼è£…é…å›¾å…ƒï¼Œè£…é…ä¸ºç‚¹ï¼Œçº¿è¿˜æ˜¯ä¸‰è§’å½¢ï¼‰</li><li>å…‰æ …åŒ–ï¼ˆå°†ä¸Šè¿°çš„å›¾å…ƒä»çŸ¢é‡å›¾å½¢è½¬æ¢ä¸ºåƒç´ ç»„æˆçš„å›¾å½¢ï¼‰</li><li>ç€è‰²ï¼ˆç‰‡æ®µç€è‰²å™¨ï¼‰</li><li>æµ‹è¯•ï¼ˆAlphaæµ‹è¯•ï¼Œæ·±åº¦æµ‹è¯•ï¼Œæ¨¡æ¿æµ‹è¯•ç­‰ï¼‰&amp; æ··åˆ</li></ol><img src="https://s2.loli.net/2025/09/13/oXpMmr2g5wUtbyP.png" alt="WXWorkCapture_17531696303010" style="width: 30%;"><h2 id="åæ ‡ç³»"><a href="#åæ ‡ç³»" class="headerlink" title="åæ ‡ç³»"></a>åæ ‡ç³»</h2><div style="display: flex; gap: 20px; align-items: flex-start;"><img src="https://s2.loli.net/2025/09/13/d1zabnP8quoMp3F.png" alt="image-20250722154307710" style="width: 30%;"><img src="https://s2.loli.net/2025/09/13/hxSrfLa5FeM7UnD.png" alt="image-20250722154418915" style="width: 30%;"></div><p>è¿™æ˜¯å·¦æ‰‹åæ ‡ç³» åä¹‹æ˜¯å³æ‰‹åæ ‡ç³»</p><p>OpenGLæ˜¯å³æ‰‹åæ ‡ç³»</p><h2 id="å®ç°ä»£ç "><a href="#å®ç°ä»£ç " class="headerlink" title="å®ç°ä»£ç "></a>å®ç°ä»£ç </h2><h3 id="1-æœ€åˆå§‹çš„å®ä¾‹ä»£ç -ï¼ˆå®ç°ä¸€ä¸ªåæ ‡è½´ï¼‰"><a href="#1-æœ€åˆå§‹çš„å®ä¾‹ä»£ç -ï¼ˆå®ç°ä¸€ä¸ªåæ ‡è½´ï¼‰" class="headerlink" title="1. æœ€åˆå§‹çš„å®ä¾‹ä»£ç   ï¼ˆå®ç°ä¸€ä¸ªåæ ‡è½´ï¼‰:"></a>1. æœ€åˆå§‹çš„å®ä¾‹ä»£ç   ï¼ˆå®ç°ä¸€ä¸ªåæ ‡è½´ï¼‰:</h3><figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å½’ä¸€åŒ–uvåæ ‡åˆ°[-1,1]èŒƒå›´ï¼Œä¿æŒå®½é«˜æ¯”</span></span><br><span class="line"><span class="type">vec2</span> fixUV(<span class="type">vec2</span> coord) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2.0</span> * (coord - <span class="number">0.5</span> * iResolution.xy) / <span class="built_in">min</span>(iResolution.x, iResolution.y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»˜åˆ¶ç½‘æ ¼çº¿</span></span><br><span class="line"><span class="type">bool</span> drawGrid(<span class="type">vec2</span> uv, <span class="type">float</span> scale) &#123;</span><br><span class="line">    <span class="comment">// fract(uv * scale)ï¼šå°†åæ ‡æŒ‰æ¯”ä¾‹ç¼©æ”¾åå–å°æ•°éƒ¨åˆ†ï¼Œå¾—åˆ°æ¯ä¸ªç½‘æ ¼å†…çš„ç›¸å¯¹åæ ‡</span></span><br><span class="line">    <span class="comment">// fwidth(f_uv.x)ï¼šè®¡ç®—ç‰‡æ®µç€è‰²å™¨ä¸­ç›¸é‚»åƒç´ çš„æ¢¯åº¦ï¼Œå³å½“å‰åƒç´ åˆ°ä¸‹ä¸€åƒç´ çš„å˜åŒ–ç‡</span></span><br><span class="line">    <span class="type">vec2</span> f_uv = <span class="built_in">fract</span>(uv * scale);</span><br><span class="line">    <span class="comment">// abs(f_uv.x) &lt; fwidth(f_uv.x)ï¼šå½“ç›¸å¯¹åæ ‡æ¥è¿‘ 0 æ—¶ï¼ˆå³ç½‘æ ¼çº¿ä½ç½®ï¼‰ï¼Œè¿”å› true</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">abs</span>(f_uv.x) &lt; <span class="built_in">fwidth</span>(f_uv.x) || <span class="built_in">abs</span>(f_uv.y) &lt; <span class="built_in">fwidth</span>(f_uv.y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»˜åˆ¶åæ ‡è½´</span></span><br><span class="line"><span class="type">vec3</span> drawAxis(<span class="type">vec2</span> uv) &#123;</span><br><span class="line">    <span class="type">vec3</span> color = <span class="type">vec3</span>(<span class="number">0.0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">abs</span>(uv.x) &lt; <span class="built_in">fwidth</span>(uv.x)) &#123;</span><br><span class="line">        color = <span class="type">vec3</span>(<span class="number">0.0</span>, <span class="number">1.0</span>, <span class="number">0.0</span>); <span class="comment">// xè½´ä¸ºç»¿è‰²</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">abs</span>(uv.y) &lt; <span class="built_in">fwidth</span>(uv.y)) &#123;</span><br><span class="line">        color = <span class="type">vec3</span>(<span class="number">1.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>); <span class="comment">// yè½´ä¸ºçº¢è‰²</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> color;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸»å‡½æ•°</span></span><br><span class="line"><span class="type">void</span> mainImage(<span class="keyword">out</span> <span class="type">vec4</span> fragColor, <span class="keyword">in</span> <span class="type">vec2</span> fragCoord) &#123;</span><br><span class="line">    <span class="comment">// å½’ä¸€åŒ–åæ ‡</span></span><br><span class="line">    <span class="type">vec2</span> uv = fixUV(fragCoord);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åŸºç¡€èƒŒæ™¯è‰²</span></span><br><span class="line">    <span class="type">vec3</span> color = <span class="type">vec3</span>(<span class="number">0.0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç»˜åˆ¶ç½‘æ ¼</span></span><br><span class="line">    <span class="keyword">if</span>(drawGrid(uv, <span class="number">3.0</span>)) &#123;</span><br><span class="line">        color = <span class="type">vec3</span>(<span class="number">1.0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç»˜åˆ¶åæ ‡è½´ï¼ˆä¼šè¦†ç›–ç½‘æ ¼çº¿ï¼‰</span></span><br><span class="line">    <span class="type">vec3</span> axisColor = drawAxis(uv);</span><br><span class="line">    <span class="keyword">if</span>(axisColor != <span class="type">vec3</span>(<span class="number">0.0</span>)) &#123;</span><br><span class="line">        color = axisColor;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    fragColor = <span class="type">vec4</span>(color, <span class="number">1.0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://www.shadertoy.com/view/Wf2fRw">https://www.shadertoy.com/view/Wf2fRw</a><br>è¿™ä¸ªshaderåˆ›å»ºäº†ä¸€ä¸ªåæ ‡ç³»ç»Ÿï¼ŒåŒ…å«ç½‘æ ¼çº¿å’Œå½©è‰²åæ ‡è½´ã€‚</p><h3 id="2-å®ç°å‡½æ•°çš„y-kxçš„ç»˜åˆ¶"><a href="#2-å®ç°å‡½æ•°çš„y-kxçš„ç»˜åˆ¶" class="headerlink" title="2. å®ç°å‡½æ•°çš„y&#x3D;kxçš„ç»˜åˆ¶"></a>2. å®ç°å‡½æ•°çš„y&#x3D;kxçš„ç»˜åˆ¶</h3><figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å½’ä¸€åŒ–uvåæ ‡åˆ°[-1,1]èŒƒå›´ï¼Œä¿æŒå®½é«˜æ¯”</span></span><br><span class="line"><span class="type">vec2</span> fixUV(<span class="type">vec2</span> coord) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2.0</span> * (coord - <span class="number">0.5</span> * iResolution.xy) / <span class="built_in">min</span>(iResolution.x, iResolution.y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»˜åˆ¶ç½‘æ ¼çº¿</span></span><br><span class="line"><span class="type">bool</span> drawGrid(<span class="type">vec2</span> uv, <span class="type">float</span> scale) &#123;</span><br><span class="line">    <span class="type">vec2</span> f_uv = <span class="built_in">fract</span>(uv * scale);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">abs</span>(f_uv.x) &lt; <span class="built_in">fwidth</span>(f_uv.x) || <span class="built_in">abs</span>(f_uv.y) &lt; <span class="built_in">fwidth</span>(f_uv.y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»˜åˆ¶åæ ‡è½´</span></span><br><span class="line"><span class="type">vec3</span> drawAxis(<span class="type">vec2</span> uv) &#123;</span><br><span class="line">    <span class="type">vec3</span> color = <span class="type">vec3</span>(<span class="number">0.0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">abs</span>(uv.x) &lt; <span class="built_in">fwidth</span>(uv.x)) &#123;</span><br><span class="line">        color = <span class="type">vec3</span>(<span class="number">0.0</span>, <span class="number">1.0</span>, <span class="number">0.0</span>); <span class="comment">// xè½´ä¸ºç»¿è‰²</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">abs</span>(uv.y) &lt; <span class="built_in">fwidth</span>(uv.y)) &#123;</span><br><span class="line">        color = <span class="type">vec3</span>(<span class="number">1.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>); <span class="comment">// yè½´ä¸ºçº¢è‰²</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> color;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¡ç®—ç‚¹åˆ°ç›´çº¿è·ç¦»çš„å‘é‡å®ç°</span></span><br><span class="line"><span class="comment">// è¿™ä¸ªå‡½æ•°è®¡ç®—ç‚¹påˆ°çº¿æ®µabçš„æœ€çŸ­è·ç¦»</span></span><br><span class="line"><span class="comment">// aã€bæ˜¯çº¿æ®µçš„ä¸¤ä¸ªç«¯ç‚¹</span></span><br><span class="line"><span class="type">float</span> distLine(<span class="type">vec2</span> p, <span class="type">vec2</span> a, <span class="type">vec2</span> b) &#123;</span><br><span class="line">    <span class="type">vec2</span> ab = b - a;</span><br><span class="line">    <span class="type">vec2</span> ap = p - a;</span><br><span class="line">    <span class="type">vec2</span> ad = <span class="built_in">dot</span>(ab, ap) / <span class="built_in">dot</span>(ab, ab) * ab;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">length</span>(ap - ad);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸»å‡½æ•°</span></span><br><span class="line"><span class="type">void</span> mainImage(<span class="keyword">out</span> <span class="type">vec4</span> fragColor, <span class="keyword">in</span> <span class="type">vec2</span> fragCoord) &#123;</span><br><span class="line">    <span class="comment">// æ—§çš„éƒ¨åˆ†</span></span><br><span class="line">    <span class="type">vec2</span> uv = fixUV(fragCoord);</span><br><span class="line">    <span class="type">vec3</span> color = <span class="type">vec3</span>(<span class="number">0.0</span>);</span><br><span class="line">    <span class="keyword">if</span>(drawGrid(uv, <span class="number">10.0</span>)) &#123;</span><br><span class="line">        color = <span class="type">vec3</span>(<span class="number">1.0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">vec3</span> axisColor = drawAxis(uv);</span><br><span class="line">    <span class="keyword">if</span>(axisColor != <span class="type">vec3</span>(<span class="number">0.0</span>)) &#123;</span><br><span class="line">        color = axisColor;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="type">float</span> d = distLine(uv, <span class="type">vec2</span>(<span class="number">0.0</span>), <span class="type">vec2</span>(<span class="number">1.0</span>));</span><br><span class="line">    color = <span class="built_in">mix</span>(color, <span class="type">vec3</span>(<span class="number">0.0</span>,<span class="number">0.0</span>,<span class="number">1.0</span>), <span class="built_in">smoothstep</span>(<span class="number">0.002</span>, <span class="number">0.001</span>, d));</span><br><span class="line">    fragColor = <span class="type">vec4</span>(color, <span class="number">1.0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://www.shadertoy.com/view/3c2fzw">https://www.shadertoy.com/view/3c2fzw</a></p><h3 id="3-å®ç°ä¸€æ®µå¤æ‚å‡½æ•°çš„ç»˜åˆ¶ï¼ˆåˆ†æ®µç»˜åˆ¶ï¼‰"><a href="#3-å®ç°ä¸€æ®µå¤æ‚å‡½æ•°çš„ç»˜åˆ¶ï¼ˆåˆ†æ®µç»˜åˆ¶ï¼‰" class="headerlink" title="3. å®ç°ä¸€æ®µå¤æ‚å‡½æ•°çš„ç»˜åˆ¶ï¼ˆåˆ†æ®µç»˜åˆ¶ï¼‰"></a>3. å®ç°ä¸€æ®µå¤æ‚å‡½æ•°çš„ç»˜åˆ¶ï¼ˆåˆ†æ®µç»˜åˆ¶ï¼‰</h3><figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#define PI 3.1415926</span></span><br><span class="line"><span class="meta">#define STEP 1.0</span></span><br><span class="line"></span><br><span class="line"><span class="type">vec2</span> fixUV(<span class="type">vec2</span> coord) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">3.0</span> * (<span class="number">2.</span> * (coord.xy - <span class="number">0.5</span> * iResolution.xy) / <span class="built_in">min</span>(iResolution.x, iResolution.y));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">vec3</span> grid(<span class="type">vec2</span> uv) &#123;</span><br><span class="line">    <span class="type">vec3</span> color = <span class="type">vec3</span>(<span class="number">0.95</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">vec2</span> cell = <span class="number">1.0</span> - <span class="number">2.0</span> * <span class="built_in">abs</span>(<span class="built_in">fract</span>(uv) - <span class="number">0.5</span>);</span><br><span class="line">    color = <span class="built_in">mix</span>(color, <span class="type">vec3</span>(<span class="number">0.7</span>), <span class="built_in">step</span>(cell.x, <span class="number">4.0</span> * <span class="built_in">fwidth</span>(uv.x)));</span><br><span class="line">    color = <span class="built_in">mix</span>(color, <span class="type">vec3</span>(<span class="number">0.7</span>), <span class="built_in">smoothstep</span>(<span class="number">4.0</span> * <span class="built_in">fwidth</span>(uv.y), <span class="number">3.9</span> * <span class="built_in">fwidth</span>(uv.y), cell.y));</span><br><span class="line">    color = <span class="built_in">mix</span>(color, <span class="type">vec3</span>(<span class="number">0.3</span>, <span class="number">0.7</span>, <span class="number">0.8</span>), <span class="built_in">smoothstep</span>(<span class="number">2.0</span> * <span class="built_in">fwidth</span>(uv.x), <span class="number">1.9</span> * <span class="built_in">fwidth</span>(uv.x), <span class="built_in">abs</span>(uv.x)));</span><br><span class="line">    color = <span class="built_in">mix</span>(color, <span class="type">vec3</span>(<span class="number">1.0</span>, <span class="number">0.5</span>, <span class="number">0.0</span>), <span class="built_in">smoothstep</span>(<span class="number">2.0</span> * <span class="built_in">fwidth</span>(uv.x), <span class="number">1.9</span> * <span class="built_in">fwidth</span>(uv.y), <span class="built_in">abs</span>(uv.y)));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> color;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> func(<span class="keyword">in</span> <span class="type">float</span> x) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sin</span>(x + <span class="built_in">sin</span>(x + <span class="built_in">sin</span>(x) * <span class="number">0.8</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> distLine(<span class="type">vec2</span> p, <span class="type">vec2</span> a, <span class="type">vec2</span> b) &#123;</span><br><span class="line">    <span class="type">vec2</span> ab = b - a;</span><br><span class="line">    <span class="type">vec2</span> ap = p - a;</span><br><span class="line">    <span class="type">vec2</span> ad = <span class="built_in">clamp</span>(<span class="built_in">dot</span>(ab, ap) / <span class="built_in">dot</span>(ab, ab), <span class="number">0.0</span>, <span class="number">1.0</span>) * ab;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">length</span>(ap - ad);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®ƒæ˜¯ä¸€ä¸ªæ•°å­¦è®¡ç®—å‡½æ•°ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªè¡¨ç¤º&quot;çº¿æ®µå½±å“å€¼&quot;çš„æµ®ç‚¹æ•°ã€‚</span></span><br><span class="line"><span class="comment">// è¿”å›çš„ float å€¼è¡¨ç¤ºå½“å‰åƒç´ (uv)ä¸çº¿æ®µçš„æ¥è¿‘ç¨‹åº¦</span></span><br><span class="line"><span class="comment">// å€¼èŒƒå›´åœ¨ 0.0 åˆ° 1.0 ä¹‹é—´ï¼š</span></span><br><span class="line"><span class="comment">// 0.0 è¡¨ç¤ºåƒç´ å®Œå…¨åœ¨çº¿æ®µä¹‹å¤–</span></span><br><span class="line"><span class="comment">// 1.0 è¡¨ç¤ºåƒç´ æ­£å¥½åœ¨çº¿æ®µä¸Š</span></span><br><span class="line"><span class="comment">// ä¸­é—´å€¼è¡¨ç¤ºåƒç´ åœ¨çº¿æ®µé™„è¿‘(æœ‰æŠ—é”¯é½¿æ•ˆæœ)</span></span><br><span class="line"><span class="type">float</span> segment(<span class="type">vec2</span> p, <span class="type">vec2</span> a, <span class="type">vec2</span> b, <span class="type">float</span> w) &#123;</span><br><span class="line">    <span class="type">float</span> f = <span class="number">0.0</span>;</span><br><span class="line">    <span class="type">vec2</span> ab = b - a;</span><br><span class="line">    <span class="type">vec2</span> ap = p - a;</span><br><span class="line">    <span class="type">float</span> proj = <span class="built_in">clamp</span>(<span class="built_in">dot</span>(ab, ap) / <span class="built_in">dot</span>(ab, ab), <span class="number">0.0</span>, <span class="number">1.0</span>);</span><br><span class="line">    <span class="type">float</span> d = <span class="built_in">length</span>(ap - proj * ab);</span><br><span class="line">    f = <span class="built_in">smoothstep</span>(w, w * <span class="number">0.2</span>, d);</span><br><span class="line">    <span class="keyword">return</span> f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> plotFunc(<span class="keyword">in</span> <span class="type">vec2</span> uv) &#123;</span><br><span class="line">    <span class="type">float</span> f = <span class="number">0.0</span>;</span><br><span class="line">    <span class="comment">// è¿™æ˜¯ä¸€ä¸ªä» 0 åˆ°å±å¹•å®½åº¦(iResolution.x)çš„å¾ªç¯</span></span><br><span class="line">    <span class="comment">// STEP æ˜¯æ­¥é•¿(å·²å®šä¹‰ä¸º 1.0)ï¼Œæ§åˆ¶é‡‡æ ·ç‚¹çš„å¯†åº¦</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">float</span> x = <span class="number">0.0</span>; x &lt;= iResolution.x; x += STEP) &#123;</span><br><span class="line">        <span class="comment">// ä¸Šä¸€ä¸ªç‚¹çš„åæ ‡</span></span><br><span class="line">        <span class="type">float</span> fx = fixUV(<span class="type">vec2</span>(x, <span class="number">0.0</span>)).x;</span><br><span class="line">        <span class="comment">// ä¸‹ä¸€ä¸ªç‚¹çš„åæ ‡</span></span><br><span class="line">        <span class="type">float</span> nfx = fixUV(<span class="type">vec2</span>(x + STEP, <span class="number">0.0</span>)).x;</span><br><span class="line">        f += segment(uv, <span class="type">vec2</span>(fx, func(fx)), <span class="type">vec2</span>(nfx, func(nfx)), <span class="number">0.006</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> mainImage(<span class="keyword">out</span> <span class="type">vec4</span> fragColor, <span class="keyword">in</span> <span class="type">vec2</span> fragCoord) &#123;</span><br><span class="line">    <span class="comment">// old</span></span><br><span class="line">    <span class="type">vec2</span> uv = fixUV(fragCoord.xy);</span><br><span class="line">    <span class="type">vec3</span> color = grid(uv);</span><br><span class="line"></span><br><span class="line">    <span class="type">float</span> f = plotFunc(uv);</span><br><span class="line">    color = <span class="built_in">mix</span>(color, <span class="type">vec3</span>(<span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>), f);</span><br><span class="line">    fragColor = <span class="type">vec4</span>(color, <span class="number">1.0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://www.shadertoy.com/view/Wc2fzw">https://www.shadertoy.com/view/Wc2fzw</a></p><h3 id="4-å®ç°ä¸€ä¸ªï¼ˆé™æ€ï¼‰æ˜ŸèŠ’æ•ˆæœ"><a href="#4-å®ç°ä¸€ä¸ªï¼ˆé™æ€ï¼‰æ˜ŸèŠ’æ•ˆæœ" class="headerlink" title="4. å®ç°ä¸€ä¸ªï¼ˆé™æ€ï¼‰æ˜ŸèŠ’æ•ˆæœ"></a>4. å®ç°ä¸€ä¸ªï¼ˆé™æ€ï¼‰æ˜ŸèŠ’æ•ˆæœ</h3><figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#define PI 3.1415926</span></span><br><span class="line"><span class="meta">#define STEP 1.0</span></span><br><span class="line"></span><br><span class="line"><span class="type">vec2</span> fixUV(<span class="type">vec2</span> coord) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">4.0</span> * (<span class="number">2.</span> * (coord.xy - <span class="number">0.5</span> * iResolution.xy) / <span class="built_in">min</span>(iResolution.x, iResolution.y));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">vec3</span> grid(<span class="type">vec2</span> uv) &#123;</span><br><span class="line">    <span class="comment">// åæ ‡å¤–å…¶ä»–é¢œè‰²ç»˜åˆ¶æ”¹å˜</span></span><br><span class="line">    <span class="type">vec3</span> color = <span class="type">vec3</span>(<span class="number">0.0</span>);</span><br><span class="line">    color.rg = <span class="built_in">fract</span>(uv);</span><br><span class="line"></span><br><span class="line">    <span class="type">vec2</span> cell = <span class="number">1.0</span> - <span class="number">2.0</span> * <span class="built_in">abs</span>(<span class="built_in">fract</span>(uv) - <span class="number">0.5</span>);</span><br><span class="line">    <span class="comment">// ç½‘æ ¼çºµå‘</span></span><br><span class="line">    color = <span class="built_in">mix</span>(color, <span class="type">vec3</span>(<span class="number">0.7</span>), <span class="built_in">step</span>(cell.x, <span class="number">4.0</span> * <span class="built_in">fwidth</span>(uv.x)));</span><br><span class="line">    <span class="comment">// ç½‘æ ¼æ¨ªå‘</span></span><br><span class="line">    color = <span class="built_in">mix</span>(color, <span class="type">vec3</span>(<span class="number">0.7</span>), <span class="built_in">smoothstep</span>(<span class="number">4.0</span> * <span class="built_in">fwidth</span>(uv.y), <span class="number">3.9</span> * <span class="built_in">fwidth</span>(uv.y), cell.y));</span><br><span class="line">    <span class="comment">// çºµå‘åæ ‡è½´</span></span><br><span class="line">    color = <span class="built_in">mix</span>(color, <span class="type">vec3</span>(<span class="number">0.3</span>, <span class="number">0.7</span>, <span class="number">0.8</span>), <span class="built_in">smoothstep</span>(<span class="number">2.0</span> * <span class="built_in">fwidth</span>(uv.x), <span class="number">1.9</span> * <span class="built_in">fwidth</span>(uv.x), <span class="built_in">abs</span>(uv.x)));</span><br><span class="line">    <span class="comment">// æ¨ªå‘åæ ‡è½´</span></span><br><span class="line">    color = <span class="built_in">mix</span>(color, <span class="type">vec3</span>(<span class="number">1.0</span>, <span class="number">0.5</span>, <span class="number">0.0</span>), <span class="built_in">smoothstep</span>(<span class="number">2.0</span> * <span class="built_in">fwidth</span>(uv.x), <span class="number">1.9</span> * <span class="built_in">fwidth</span>(uv.y), <span class="built_in">abs</span>(uv.y)));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> color;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> func(<span class="keyword">in</span> <span class="type">float</span> x) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sin</span>(x + <span class="built_in">sin</span>(x + <span class="built_in">sin</span>(x) * <span class="number">0.8</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> distLine(<span class="type">vec2</span> p, <span class="type">vec2</span> a, <span class="type">vec2</span> b) &#123;</span><br><span class="line">    <span class="type">vec2</span> ab = b - a;</span><br><span class="line">    <span class="type">vec2</span> ap = p - a;</span><br><span class="line">    <span class="type">vec2</span> ad = <span class="built_in">clamp</span>(<span class="built_in">dot</span>(ab, ap) / <span class="built_in">dot</span>(ab, ab), <span class="number">0.0</span>, <span class="number">1.0</span>) * ab;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">length</span>(ap - ad);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> Line(<span class="type">vec2</span> p, <span class="type">vec2</span> a, <span class="type">vec2</span> b) &#123;</span><br><span class="line">    <span class="type">float</span> d = distLine(p, a, b);</span><br><span class="line">    <span class="type">float</span> m = <span class="built_in">smoothstep</span>(<span class="number">0.02</span>, <span class="number">0.01</span>, d);</span><br><span class="line">    <span class="keyword">return</span> m;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> segment(<span class="type">vec2</span> p, <span class="type">vec2</span> a, <span class="type">vec2</span> b, <span class="type">float</span> w) &#123;</span><br><span class="line">    <span class="type">float</span> f = <span class="number">0.0</span>;</span><br><span class="line">    <span class="type">vec2</span> ab = b - a;</span><br><span class="line">    <span class="type">vec2</span> ap = p - a;</span><br><span class="line">    <span class="type">float</span> proj = <span class="built_in">clamp</span>(<span class="built_in">dot</span>(ab, ap) / <span class="built_in">dot</span>(ab, ab), <span class="number">0.0</span>, <span class="number">1.0</span>);</span><br><span class="line">    <span class="type">float</span> d = <span class="built_in">length</span>(ap - proj * ab);</span><br><span class="line">    f = <span class="built_in">smoothstep</span>(w, w * <span class="number">0.2</span>, d);</span><br><span class="line">    <span class="keyword">return</span> f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> mainImage(<span class="keyword">out</span> <span class="type">vec4</span> fragColor, <span class="keyword">in</span> <span class="type">vec2</span> fragCoord) &#123;</span><br><span class="line">    <span class="type">vec2</span> uv = fixUV(fragCoord.xy);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¿®æ”¹äº†ç»˜åˆ¶åæ ‡çš„å‡½æ•°</span></span><br><span class="line">    <span class="type">vec3</span> Basecolor = grid(uv);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°åæ ‡ä½ç½®ä¸­å¿ƒç‚¹å¼„åˆ°æ–¹å—çš„ä¸­å¿ƒ</span></span><br><span class="line">    <span class="type">vec2</span> st = <span class="built_in">fract</span>(uv) - <span class="number">0.5</span>;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»º3x3ç‚¹é˜µ</span></span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="type">vec2</span> p[<span class="number">9</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">float</span> y = <span class="number">-1.0</span>; y &lt;= <span class="number">1.0</span>; y++) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">float</span> x = <span class="number">-1.0</span>; x &lt;= <span class="number">1.0</span>; x++) &#123;</span><br><span class="line">            <span class="type">vec2</span> offs = <span class="type">vec2</span>(x, y);</span><br><span class="line">            p[i++] = offs;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿çº¿ç»˜åˆ¶ (ä½¿ç”¨è“è‰²)</span></span><br><span class="line">    <span class="type">float</span> m2 = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">9</span>; i++) &#123;</span><br><span class="line">        m2 += Line(st, p[i], p[<span class="number">4</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    Basecolor = <span class="built_in">mix</span>(Basecolor, <span class="type">vec3</span>(<span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">1.0</span>), m2); <span class="comment">// ç»˜åˆ¶è¿çº¿</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç»˜åˆ¶æ¯ä¸ªåŒºåŸŸä¸­é—´çš„ç‚¹ (ä½¿ç”¨çº¢è‰²)</span></span><br><span class="line">    <span class="type">float</span> d = <span class="built_in">length</span>(st);</span><br><span class="line">    <span class="type">float</span> m1 = <span class="built_in">smoothstep</span>(<span class="number">0.1</span>, <span class="number">0.09</span>, d);</span><br><span class="line">    Basecolor = <span class="built_in">mix</span>(Basecolor, <span class="type">vec3</span>(<span class="number">1.0</span>), m1); <span class="comment">// ç»˜åˆ¶ç‚¹</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    fragColor = <span class="type">vec4</span>(Basecolor, <span class="number">1.0</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="https://s2.loli.net/2025/09/13/6obpL7qJrvcfXka.png" alt="shadertoy4" style="width: 30%;"><h3 id="5-éšæœºæ•°ç”ŸæˆåŠæ³•"><a href="#5-éšæœºæ•°ç”ŸæˆåŠæ³•" class="headerlink" title="5. éšæœºæ•°ç”ŸæˆåŠæ³•"></a>5. éšæœºæ•°ç”ŸæˆåŠæ³•</h3><figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">vec2</span> N22(<span class="type">vec2</span> p) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä»»æ„çš„å¤§æ•°å­— ä½†è¿˜æ˜¯æœ‰ä¸€äº›è¦æ±‚ï¼š</span></span><br><span class="line">    <span class="comment">// ä½ å¯ä»¥æ›¿æ¢ä¸ºå…¶ä»–å¤§æ•°ï¼ˆå¦‚ vec2(123.45, 678.90)ï¼‰</span></span><br><span class="line">    <span class="comment">// ä½†éœ€è¦é¿å…ï¼š</span></span><br><span class="line">    <span class="comment">// è¿‡äºç®€å•çš„æ•°å­—ï¼ˆå¦‚ 100.0, 200.0ï¼‰</span></span><br><span class="line">    <span class="comment">// äº’ä¸ºå€æ•°çš„æ•°å­—ï¼ˆå¦‚ 50.0, 100.0ï¼‰</span></span><br><span class="line">    <span class="comment">// ä¸åç»­é­”æ³•æ•°å­—ï¼ˆ123.34ç­‰ï¼‰æœ‰ç®€å•æ•°å­¦å…³ç³»çš„æ•°å­—</span></span><br><span class="line">    p += <span class="type">vec2</span>(<span class="number">434.67</span>, <span class="number">534.23</span>);  </span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†2Dåæ ‡æ‰©å±•ä¸º3Då‘é‡ p.xyxï¼ˆå¦‚è¾“å…¥(x,y)å˜ä¸º(x,y,x)ï¼‰</span></span><br><span class="line">    <span class="comment">// ä¹˜ä»¥ç²¾å¿ƒé€‰æ‹©çš„&quot;é­”æ³•æ•°å­—&quot;å‘é‡ï¼ˆè¿™äº›è´¨æ•°å¢åŠ æ··ä¹±åº¦ï¼‰</span></span><br><span class="line">    <span class="comment">// fract() å–å°æ•°éƒ¨åˆ†ï¼Œç¡®ä¿æ•°å€¼åœ¨[0,1)èŒƒå›´å†…</span></span><br><span class="line">    <span class="type">vec3</span> a = <span class="built_in">fract</span>(p.xyx * <span class="type">vec3</span>(<span class="number">123.34</span>, <span class="number">234.34</span>, <span class="number">345.65</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¡ç®—å‘é‡ç‚¹ç§¯å¹¶å åŠ åˆ°è‡ªèº«ï¼ˆdot(a,a)è®¡ç®—è‡ªç›¸å…³ï¼‰</span></span><br><span class="line">    <span class="comment">// æ·»åŠ 34.45åç§»é¿å…å¯¹ç§°æ€§</span></span><br><span class="line">    <span class="comment">// è¿™æ­¥å¤§å¹…å¢åŠ è¾“å‡ºçš„éšæœºæ€§</span></span><br><span class="line">    a += <span class="built_in">dot</span>(a, a + <span class="number">34.45</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">fract</span>(<span class="type">vec2</span>(a.x * a.y, a.y * a.z));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">vec2</span> fixUV(<span class="type">vec2</span> coord) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">3.0</span> * (<span class="number">2.</span> * (coord.xy - <span class="number">0.5</span> * iResolution.xy) / <span class="built_in">min</span>(iResolution.x, iResolution.y));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> mainImage(<span class="keyword">out</span> <span class="type">vec4</span> fragColor, <span class="keyword">in</span> <span class="type">vec2</span> fragCoord) &#123;</span><br><span class="line">    <span class="type">vec2</span> uv = fixUV(fragCoord.xy);</span><br><span class="line"></span><br><span class="line">    <span class="type">vec2</span> n = N22(uv);</span><br><span class="line">    fragColor = <span class="type">vec4</span>(n, <span class="number">0.0</span>, <span class="number">1.0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="https://s2.loli.net/2025/09/13/s9ievPKCbrxIj3n.png" alt="shadertoy5" style="width: 30%;"><h3 id="6-æ˜Ÿæ˜Ÿè¿çº¿æ•ˆæœ"><a href="#6-æ˜Ÿæ˜Ÿè¿çº¿æ•ˆæœ" class="headerlink" title="6. æ˜Ÿæ˜Ÿè¿çº¿æ•ˆæœ"></a>6. æ˜Ÿæ˜Ÿè¿çº¿æ•ˆæœ</h3><figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#define PI 3.1415926</span></span><br><span class="line"><span class="meta">#define STEP 1.0</span></span><br><span class="line"></span><br><span class="line"><span class="type">vec2</span> fixUV(<span class="type">vec2</span> coord) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">5.0</span> * (<span class="number">2.</span> * (coord.xy - <span class="number">0.5</span> * iResolution.xy) / <span class="built_in">min</span>(iResolution.x, iResolution.y));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> distLine(<span class="type">vec2</span> p, <span class="type">vec2</span> a, <span class="type">vec2</span> b) &#123;</span><br><span class="line">    <span class="type">vec2</span> ab = b - a;</span><br><span class="line">    <span class="type">vec2</span> ap = p - a;</span><br><span class="line">    <span class="type">vec2</span> ad = <span class="built_in">clamp</span>(<span class="built_in">dot</span>(ab, ap) / <span class="built_in">dot</span>(ab, ab), <span class="number">0.0</span>, <span class="number">1.0</span>) * ab;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">length</span>(ap - ad);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> Line(<span class="type">vec2</span> p, <span class="type">vec2</span> a, <span class="type">vec2</span> b) &#123;</span><br><span class="line">    <span class="type">float</span> d = distLine(p, a, b);  <span class="comment">// è®¡ç®—ç‚¹påˆ°çº¿æ®µabçš„è·ç¦»</span></span><br><span class="line">    <span class="type">float</span> m = <span class="built_in">smoothstep</span>(<span class="number">0.02</span>, <span class="number">0.01</span>, d); <span class="comment">// ç¬¬ä¸€æ¬¡æ¸å˜ï¼šç”Ÿæˆçº¿å®½</span></span><br><span class="line">    <span class="type">float</span> d2 = <span class="built_in">length</span>(a - b);     <span class="comment">// è®¡ç®—çº¿æ®µabçš„é•¿åº¦</span></span><br><span class="line">    m *= <span class="built_in">smoothstep</span>(<span class="number">1.2</span>, <span class="number">1.1</span>, d2);<span class="comment">// ç¬¬äºŒæ¬¡æ¸å˜ï¼šæ§åˆ¶çº¿æ®µæ˜¾éš</span></span><br><span class="line">    <span class="keyword">return</span> m;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">vec2</span> N22(<span class="type">vec2</span> p) &#123;</span><br><span class="line">    p += <span class="type">vec2</span>(<span class="number">434.67</span>, <span class="number">534.23</span>);</span><br><span class="line">    <span class="type">vec3</span> a = <span class="built_in">fract</span>(p.xyx * <span class="type">vec3</span>(<span class="number">123.34</span>, <span class="number">234.34</span>, <span class="number">345.65</span>));</span><br><span class="line">    a += <span class="built_in">dot</span>(a, a + <span class="number">34.45</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">fract</span>(<span class="type">vec2</span>(a.x * a.y, a.y * a.z));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">vec3</span> N23_to_3(<span class="type">vec2</span> p) &#123;</span><br><span class="line">    <span class="comment">// First layer hash</span></span><br><span class="line">    <span class="type">vec3</span> a = <span class="built_in">fract</span>(p.xyx * <span class="type">vec3</span>(<span class="number">123.34</span>, <span class="number">234.34</span>, <span class="number">345.65</span>));</span><br><span class="line">    a += <span class="built_in">dot</span>(a, a.yxz + <span class="number">34.45</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Second layer hash (using rotated coordinates)</span></span><br><span class="line">    <span class="type">vec3</span> b = <span class="built_in">fract</span>(p.yxy * <span class="type">vec3</span>(<span class="number">456.78</span>, <span class="number">567.89</span>, <span class="number">678.91</span>)); </span><br><span class="line">    b += <span class="built_in">dot</span>(b, b.zxy + <span class="number">45.67</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Combine layers</span></span><br><span class="line">    <span class="type">vec3</span> r = <span class="built_in">fract</span>(<span class="type">vec3</span>(</span><br><span class="line">        a.x * b.y,</span><br><span class="line">        a.y * b.z,</span><br><span class="line">        a.z * b.x</span><br><span class="line">    ));</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Final mixing</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">fract</span>(r * <span class="number">0.5</span> + <span class="number">0.5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">vec2</span> GetPos(<span class="type">vec2</span> id, <span class="type">vec2</span> offs) &#123;</span><br><span class="line">    <span class="comment">// æ ¹æ®æ ¼å­çš„ idå’Œoffs äº§ç”Ÿä¸€ä¸ªéšæœºæ•°ï¼Œ</span></span><br><span class="line">    <span class="comment">// ä¹˜ä¸ŠiTimeä½¿å…¶æ ¹æ®æ—¶é—´å‘ç”Ÿå˜åŒ–</span></span><br><span class="line">    <span class="type">vec2</span> n = N22(id + offs) * iTime * <span class="number">6.11</span>; <span class="comment">// 6.11æ˜¯ä¸€ä¸ªè°ƒèŠ‚é€Ÿåº¦çš„æ•°å€¼</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sin</span>(n) * <span class="number">0.4</span> + offs;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> mainImage(<span class="keyword">out</span> <span class="type">vec4</span> fragColor, <span class="keyword">in</span> <span class="type">vec2</span> fragCoord) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="type">vec2</span> uv = fixUV(fragCoord.xy);</span><br><span class="line">    <span class="comment">// ä¿®æ”¹äº†ç»˜åˆ¶åæ ‡çš„å‡½æ•°</span></span><br><span class="line">    <span class="type">vec3</span> Basecolor = <span class="type">vec3</span>(<span class="number">0.0</span>);</span><br><span class="line">    <span class="comment">// å°åæ ‡ä½ç½®ä¸­å¿ƒç‚¹å¼„åˆ°æ–¹å—çš„ä¸­å¿ƒ</span></span><br><span class="line">    <span class="type">vec2</span> st = <span class="built_in">fract</span>(uv) - <span class="number">0.5</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è·å–åˆ°æ ¼å­çš„ä¸­å¿ƒè½´ç‚¹</span></span><br><span class="line">    <span class="type">vec2</span> id = <span class="built_in">floor</span>(uv);</span><br><span class="line">    <span class="type">vec3</span> idcolor = N23_to_3(id);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»º3x3ç‚¹é˜µ</span></span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="type">vec2</span> p[<span class="number">9</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">float</span> y = <span class="number">-1.0</span>; y &lt;= <span class="number">1.0</span>; y++) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">float</span> x = <span class="number">-1.0</span>; x &lt;= <span class="number">1.0</span>; x++) &#123;</span><br><span class="line">            <span class="type">vec2</span> offs = <span class="type">vec2</span>(x, y);</span><br><span class="line">            p[i++] = GetPos(id, offs);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿çº¿ç»˜åˆ¶ (ä½¿ç”¨è“è‰²)</span></span><br><span class="line">    <span class="type">float</span> m2 = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">9</span>; i++) &#123;</span><br><span class="line">        m2 += Line(st, p[i], p[<span class="number">4</span>]);</span><br><span class="line"></span><br><span class="line">     </span><br><span class="line">        <span class="comment">// ç”»æ˜Ÿæ˜Ÿ ä¸­é—´é—ªçƒéƒ¨åˆ†</span></span><br><span class="line">        <span class="type">float</span> d = <span class="built_in">length</span>(st - p[i]);</span><br><span class="line">        <span class="type">float</span> spark = <span class="number">1.0</span> / (d * d * <span class="number">200.0</span>) * (<span class="built_in">sin</span>(iTime * <span class="number">13.0</span> + p[i].x * <span class="number">17.0</span>) * <span class="number">0.4</span> + <span class="number">0.6</span>);</span><br><span class="line">        m2 += spark;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¿™ä¸€éƒ¨åˆ†ä¼šæ–­å¼€ é‡æ–°è¿æ¥</span></span><br><span class="line">        m2 += Line(st, p[<span class="number">1</span>], p[<span class="number">3</span>]);</span><br><span class="line">        m2 += Line(st, p[<span class="number">1</span>], p[<span class="number">5</span>]);</span><br><span class="line">        m2 += Line(st, p[<span class="number">7</span>], p[<span class="number">3</span>]);</span><br><span class="line">        m2 += Line(st, p[<span class="number">7</span>], p[<span class="number">5</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Basecolor = <span class="built_in">mix</span>(Basecolor, idcolor, m2); <span class="comment">// ç»˜åˆ¶è¿çº¿</span></span><br><span class="line">    </span><br><span class="line">    fragColor = <span class="type">vec4</span>(Basecolor, <span class="number">1.0</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="https://s2.loli.net/2025/09/13/VbQwM4mTfhA92B3.png" alt="shadertoy6" style="width: 30%;"><h3 id="7-æ˜Ÿæ˜Ÿæ¨è¿›ï¼ˆåšä¸»çš„ç‰ˆæœ¬ï¼‰"><a href="#7-æ˜Ÿæ˜Ÿæ¨è¿›ï¼ˆåšä¸»çš„ç‰ˆæœ¬ï¼‰" class="headerlink" title="7. æ˜Ÿæ˜Ÿæ¨è¿›ï¼ˆåšä¸»çš„ç‰ˆæœ¬ï¼‰"></a>7. æ˜Ÿæ˜Ÿæ¨è¿›ï¼ˆåšä¸»çš„ç‰ˆæœ¬ï¼‰</h3><figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">vec2</span> N22(<span class="type">vec2</span> p) &#123;</span><br><span class="line">    p += <span class="type">vec2</span>(<span class="number">434.67</span>, <span class="number">534.23</span>);</span><br><span class="line">    <span class="type">vec3</span> a = <span class="built_in">fract</span>(p.xyx * <span class="type">vec3</span>(<span class="number">123.34</span>, <span class="number">234.34</span>, <span class="number">345.65</span>));</span><br><span class="line">    a += <span class="built_in">dot</span>(a, a + <span class="number">34.45</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">fract</span>(<span class="type">vec2</span>(a.x * a.y, a.y * a.z));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> DistLine(<span class="type">vec2</span> p, <span class="type">vec2</span> a, <span class="type">vec2</span> b) &#123;</span><br><span class="line">    <span class="type">vec2</span> pa = p - a;</span><br><span class="line">    <span class="type">vec2</span> ba = b - a;</span><br><span class="line">    <span class="type">float</span> t = <span class="built_in">clamp</span>(<span class="built_in">dot</span>(pa, ba) / <span class="built_in">dot</span>(ba, ba), <span class="number">0.0</span>, <span class="number">1.0</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">length</span>(pa - ba * t);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">vec2</span> GetPos(<span class="type">vec2</span> id, <span class="type">vec2</span> offs) &#123;</span><br><span class="line">    <span class="type">vec2</span> n = N22(id + offs) * iTime;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sin</span>(n) * <span class="number">0.4</span> + offs;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> Line(<span class="type">vec2</span> p, <span class="type">vec2</span> a, <span class="type">vec2</span> b) &#123;</span><br><span class="line">    <span class="type">float</span> d = DistLine(p, a, b);</span><br><span class="line">    <span class="type">float</span> m = <span class="built_in">smoothstep</span>(<span class="number">0.02</span>, <span class="number">0.01</span>, d);</span><br><span class="line">    <span class="type">float</span> d2 = <span class="built_in">length</span>(a - b);</span><br><span class="line">    m *= <span class="built_in">smoothstep</span>(<span class="number">1.2</span>, <span class="number">0.8</span>, d2) + <span class="built_in">smoothstep</span>(<span class="number">0.05</span>, <span class="number">0.03</span>, <span class="built_in">abs</span>(d2 - <span class="number">0.75</span>));</span><br><span class="line">    <span class="keyword">return</span> m;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> Layer(<span class="type">vec2</span> uv) &#123;</span><br><span class="line">    <span class="type">vec2</span> st = <span class="built_in">fract</span>(uv) - <span class="number">0.5</span>;</span><br><span class="line">    <span class="type">vec2</span> id = <span class="built_in">floor</span>(uv);</span><br><span class="line">    <span class="type">float</span> m = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="type">vec2</span> p[<span class="number">9</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">float</span> y = <span class="number">-1.0</span>; y &lt;= <span class="number">1.0</span>; y++) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">float</span> x = <span class="number">-1.0</span>; x &lt;= <span class="number">1.0</span>; x++) &#123;</span><br><span class="line">            <span class="type">vec2</span> offs = <span class="type">vec2</span>(x, y);</span><br><span class="line">            p[i++] = GetPos(id, offs);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">float</span> t = iTime;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">9</span>; i++) &#123;</span><br><span class="line">        m += Line(st, p[i], p[<span class="number">4</span>]);</span><br><span class="line">        <span class="comment">// vec2 j = (st - p[i]) * 20.0;</span></span><br><span class="line">        <span class="type">float</span> d = <span class="built_in">length</span>(st - p[i]);</span><br><span class="line">        <span class="type">float</span> spark = <span class="number">1.0</span> / (d * d * <span class="number">200.0</span>) * (<span class="built_in">sin</span>(t * <span class="number">13.0</span> + p[i].x * <span class="number">17.0</span>) * <span class="number">0.4</span> + <span class="number">0.6</span>);</span><br><span class="line">        m += spark;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    m += Line(st, p[<span class="number">1</span>], p[<span class="number">3</span>]);</span><br><span class="line">    m += Line(st, p[<span class="number">1</span>], p[<span class="number">5</span>]);</span><br><span class="line">    m += Line(st, p[<span class="number">7</span>], p[<span class="number">3</span>]);</span><br><span class="line">    m += Line(st, p[<span class="number">7</span>], p[<span class="number">5</span>]);</span><br><span class="line">    <span class="keyword">return</span> m;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> mainImage(<span class="keyword">out</span> <span class="type">vec4</span> fragColor, <span class="keyword">in</span> <span class="type">vec2</span> fragCoord) &#123;</span><br><span class="line">    <span class="type">vec2</span> uv = (fragCoord.xy - <span class="number">.5</span> * iResolution.xy) / iResolution.y;</span><br><span class="line">    <span class="type">vec3</span> col = <span class="type">vec3</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">float</span> m = <span class="number">0.0</span>;</span><br><span class="line">    <span class="type">float</span> t = iTime * <span class="number">0.1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">float</span> i = <span class="number">0.0</span>; i &lt;= <span class="number">1.0</span>; i += <span class="number">1.</span> / <span class="number">4.</span>) &#123;</span><br><span class="line">        <span class="type">float</span> depth = <span class="built_in">fract</span>(i + t);</span><br><span class="line">        <span class="type">float</span> size = <span class="built_in">mix</span>(<span class="number">15.0</span>, <span class="number">0.5</span>, depth);</span><br><span class="line">        <span class="type">float</span> fade = <span class="built_in">smoothstep</span>(<span class="number">0.0</span>, <span class="number">0.2</span>, depth) * <span class="built_in">smoothstep</span>(<span class="number">0.9</span>, <span class="number">0.8</span>, depth);</span><br><span class="line">        m += Layer(uv * size + i * <span class="number">20.0</span>) * fade;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    t *= <span class="number">5.0</span>;</span><br><span class="line">    <span class="type">float</span> gradinet = uv.y;</span><br><span class="line">    <span class="type">vec3</span> baseCol = <span class="type">vec3</span>(<span class="number">0.323</span>, <span class="number">0.456</span>, <span class="number">0.567</span>);</span><br><span class="line">    col = m * baseCol * (<span class="built_in">sin</span>(t) * <span class="number">0.4</span> + <span class="number">0.8</span>);</span><br><span class="line">    col -= baseCol * gradinet;</span><br><span class="line">    fragColor = <span class="type">vec4</span>(col, <span class="number">1.0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="https://s2.loli.net/2025/09/13/IsbLwT7aziglYm4.png" alt="shadertoy7" style="width: 30%;"><h3 id="8-ä¸€ä¸ªæœ€ç®€å•çš„3Dç‚¹"><a href="#8-ä¸€ä¸ªæœ€ç®€å•çš„3Dç‚¹" class="headerlink" title="8.ä¸€ä¸ªæœ€ç®€å•çš„3Dç‚¹"></a>8.ä¸€ä¸ªæœ€ç®€å•çš„3Dç‚¹</h3><p>åŸæœ¬çš„3Dæµç¨‹åº”è¯¥æ˜¯ï¼šâ€œåŸç”»å¸ˆç»˜åˆ¶åœºæ™¯å›¾ï¼ˆå°†3Dåœºæ™¯ç”»ä¸‹æ¥ï¼‰ -&gt; å»ºæ¨¡å¸ˆæ ¹æ®åŸç”»æ„å»ºåœºæ™¯æ¨¡å‹ï¼ˆäº§å‡º3Dæ¨¡å‹ï¼‰-&gt; ç¨‹åºæ¸²æŸ“ï¼ˆå°†3Dæ¨¡å‹å¯¼å…¥åˆ°å¼•æ“ä¸­ï¼Œæˆ–è€…å…¶ä»–3Dæ¸²æŸ“åº“ï¼‰ï¼Œç„¶åæ¸²æŸ“æˆç”»é¢â€ã€‚</p><img src="https://s2.loli.net/2025/09/13/bGh2JSUj4oK1WVI.png" alt="img" style="width: 30%;"><p>æˆ‘ä»¬ç®€è¦å›é¡¾ä¸€ä¸‹ï¼š</p><ol><li>é¡¶ç‚¹å˜æ¢çš„è¿‡ç¨‹ï¼ˆé¡¶ç‚¹ç€è‰²å™¨ï¼‰</li><li>å›¾å…ƒè£…é…ï¼ˆæŒ‰å“ªç§æ–¹å¼è£…é…å›¾å…ƒï¼Œè£…é…ä¸ºç‚¹ï¼Œçº¿è¿˜æ˜¯ä¸‰è§’å½¢ï¼‰</li><li>å…‰æ …åŒ–ï¼ˆå°†ä¸Šè¿°çš„å›¾å…ƒä»çŸ¢é‡å›¾å½¢è½¬æ¢ä¸ºåƒç´ ç»„æˆçš„å›¾å½¢ï¼‰</li><li>ç€è‰²ï¼ˆç‰‡æ®µç€è‰²å™¨ï¼‰</li><li>æµ‹è¯•ï¼ˆAlphaæµ‹è¯•ï¼Œæ·±åº¦æµ‹è¯•ï¼Œæ¨¡æ¿æµ‹è¯•ç­‰ï¼‰&amp; æ··åˆ</li></ol><p>é€šè¿‡ä¸Šè¿°æ–¹å¼æ¸²æŸ“çš„3Dæ¨¡å‹çš„æ–¹å¼æˆ‘ä»¬é€šå¸¸ç§°ä¸º<strong>å…‰æ …åŒ–çš„æ–¹æ³•</strong></p><p>è€Œåœ¨æˆ‘ä»¬çš„shadertoyä¸­ï¼Œæˆ‘ä»¬æ˜¯ç›´æ¥åœ¨ç‰‡æ®µç€è‰²å™¨ä¸­è¿›è¡Œç¼–ç¨‹ï¼Œæˆ‘ä»¬åªæœ‰ä¸Šè¿°çš„ç¬¬å››ä¸ç¬¬äº”æ­¥çš„è¿‡ç¨‹ã€‚å…¶å®ç›¸å½“äºæˆ‘ä»¬ç°åœ¨å˜æˆäº†åŸç”»å¸ˆï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä¸€å¼ çº¸ä¸Šåšç”»ï¼Œè€Œä¸”ç”»çš„æ˜¯3Dåœºæ™¯ã€‚å¥½åœ¨æˆ‘ä»¬è¿˜æœ‰å¦ä¸€ç§æ„å»º3Dåœºæ™¯çš„æ–¹å¼ï¼Œå°±æ˜¯<strong>å…‰çº¿è¿½è¸ªæˆ–å…‰çº¿æ­¥è¿›</strong>ã€‚</p><img src="https://s2.loli.net/2025/09/13/1GixOetfmgXlwNq.jpg" alt="img" style="width: 30%;"><p><a href="https://juejin.cn/post/7362059823662432306">https://juejin.cn/post/7362059823662432306</a></p><figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç‚¹påˆ°ç›´çº¿roåˆ°rdçš„è·ç¦»</span></span><br><span class="line"><span class="type">float</span> DistLine(<span class="type">vec3</span> ro, <span class="type">vec3</span> rd, <span class="type">vec3</span> p) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">length</span>(<span class="built_in">cross</span>(p - ro, rd) / <span class="built_in">length</span>(rd));      <span class="comment">// ä½¿ç”¨å‘é‡å‰ç§¯å…¬å¼è®¡ç®—ç‚¹åˆ°ç›´çº¿çš„è·ç¦»ï¼š(p-ro)ä¸rdçš„å‰ç§¯é•¿åº¦é™¤ä»¥rdçš„é•¿åº¦</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> mainImage(<span class="keyword">out</span> <span class="type">vec4</span> fragColor, <span class="keyword">in</span> <span class="type">vec2</span> fragCoord) &#123;</span><br><span class="line">    <span class="type">vec2</span> uv = fragCoord.xy / iResolution.xy;<span class="comment">// å°†åƒç´ åæ ‡å½’ä¸€åŒ–åˆ°[0,1]èŒƒå›´</span></span><br><span class="line">    uv -= <span class="number">0.5</span>;<span class="comment">// å°†åæ ‡åŸç‚¹ç§»åˆ°å±å¹•ä¸­å¿ƒ(èŒƒå›´å˜ä¸º[-0.5,0.5])</span></span><br><span class="line">    uv.x *= iResolution.x / iResolution.y;<span class="comment">// ä¿®æ­£å®½é«˜æ¯”ï¼Œé˜²æ­¢å›¾åƒå˜å½¢</span></span><br><span class="line"></span><br><span class="line">    <span class="type">vec3</span> ro = <span class="type">vec3</span>(<span class="number">0.</span>, <span class="number">0.</span>, <span class="number">-1.</span>);<span class="comment">// å®šä¹‰æ‘„åƒæœºï¼ˆè§‚å¯Ÿç‚¹ï¼‰ä½ç½®(ray origin)åœ¨z=-1å¤„</span></span><br><span class="line">    <span class="type">vec3</span> rd = <span class="type">vec3</span>(uv.x, uv.y, <span class="number">0.0</span>) - ro;<span class="comment">// è®¡ç®—ä»æ‘„åƒæœºåˆ°å½“å‰åƒç´ çš„å°„çº¿æ–¹å‘(ray direction)</span></span><br><span class="line"></span><br><span class="line">    <span class="type">float</span> t = iGlobalTime; <span class="comment">//å®šä¹‰ä¸€ä¸ªå˜é‡ï¼Œæ–¹ä¾¿è®©çƒåŠ¨èµ·æ¥</span></span><br><span class="line">    <span class="type">vec3</span> p = <span class="type">vec3</span>(<span class="built_in">sin</span>(t), <span class="number">0.</span>, <span class="number">3.0</span>); <span class="comment">// å®šä¹‰çƒçš„ä½ç½®</span></span><br><span class="line">    <span class="type">float</span> r = <span class="number">0.01</span>; <span class="comment">// å®šä¹‰çƒçš„åŠå¾„</span></span><br><span class="line"></span><br><span class="line">    <span class="type">float</span> d = DistLine(ro, rd, p); <span class="comment">// è®¡ç®—çƒå¿ƒä¸è§‚å¯Ÿå°„çº¿ä¹‹é—´çš„è·ç¦»</span></span><br><span class="line">    d = <span class="built_in">smoothstep</span>(r + <span class="number">0.01</span>, r, d); <span class="comment">// è‹¥è·ç¦»å°äºåŠå¾„ï¼Œd åˆ™ç­‰äº1ã€‚</span></span><br><span class="line">    fragColor = <span class="type">vec4</span>(d, d, d, <span class="number">1.0</span>); <span class="comment">// å°†çƒç€è‰²ä¸ºç™½è‰²</span></span><br><span class="line">&#125;   </span><br></pre></td></tr></table></figure><img src="https://s2.loli.net/2025/09/13/6ZnjRWTHq9Go4lp.png" alt="shadertoy9" style="width: 30%;"><h3 id="100-ä¸€ä¸ªæµ·Shaderï¼ˆä¼˜åŒ–ç‰ˆæœ¬ï¼‰"><a href="#100-ä¸€ä¸ªæµ·Shaderï¼ˆä¼˜åŒ–ç‰ˆæœ¬ï¼‰" class="headerlink" title="100.ä¸€ä¸ªæµ·Shaderï¼ˆä¼˜åŒ–ç‰ˆæœ¬ï¼‰"></a>100.ä¸€ä¸ªæµ·Shaderï¼ˆä¼˜åŒ–ç‰ˆæœ¬ï¼‰</h3><figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * &quot;Seascape&quot; by Alexander Alekseev aka TDM - 2014</span></span><br><span class="line"><span class="comment"> * License Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License.</span></span><br><span class="line"><span class="comment"> * Contact: tdmaav@gmail.com</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="type">int</span> NUM_STEPS = <span class="number">32</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="type">float</span> PI = <span class="number">3.141592</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="type">float</span> EPSILON= <span class="number">1e-3</span>;</span><br><span class="line"><span class="meta">#define EPSILON_NRM (0.1 / iResolution.x)</span></span><br><span class="line"><span class="comment">//#define AA</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// sea</span></span><br><span class="line"><span class="keyword">const</span> <span class="type">int</span> ITER_GEOMETRY = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="type">int</span> ITER_FRAGMENT = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="type">float</span> SEA_HEIGHT = <span class="number">0.6</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="type">float</span> SEA_CHOPPY = <span class="number">4.0</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="type">float</span> SEA_SPEED = <span class="number">0.8</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="type">float</span> SEA_FREQ = <span class="number">0.16</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="type">vec3</span> SEA_BASE = <span class="type">vec3</span>(<span class="number">0.0</span>,<span class="number">0.09</span>,<span class="number">0.18</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="type">vec3</span> SEA_WATER_COLOR = <span class="type">vec3</span>(<span class="number">0.8</span>,<span class="number">0.9</span>,<span class="number">0.6</span>)*<span class="number">0.6</span>;</span><br><span class="line"><span class="meta">#define SEA_TIME (1.0 + iTime * SEA_SPEED)</span></span><br><span class="line"><span class="keyword">const</span> <span class="type">mat2</span> octave_m = <span class="type">mat2</span>(<span class="number">1.6</span>,<span class="number">1.2</span>,<span class="number">-1.2</span>,<span class="number">1.6</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// math</span></span><br><span class="line"><span class="type">mat3</span> fromEuler(<span class="type">vec3</span> ang) &#123;</span><br><span class="line"><span class="type">vec2</span> a1 = <span class="type">vec2</span>(<span class="built_in">sin</span>(ang.x),<span class="built_in">cos</span>(ang.x));</span><br><span class="line">    <span class="type">vec2</span> a2 = <span class="type">vec2</span>(<span class="built_in">sin</span>(ang.y),<span class="built_in">cos</span>(ang.y));</span><br><span class="line">    <span class="type">vec2</span> a3 = <span class="type">vec2</span>(<span class="built_in">sin</span>(ang.z),<span class="built_in">cos</span>(ang.z));</span><br><span class="line">    <span class="type">mat3</span> m;</span><br><span class="line">    m[<span class="number">0</span>] = <span class="type">vec3</span>(a1.y*a3.y+a1.x*a2.x*a3.x,a1.y*a2.x*a3.x+a3.y*a1.x,-a2.y*a3.x);</span><br><span class="line">m[<span class="number">1</span>] = <span class="type">vec3</span>(-a2.y*a1.x,a1.y*a2.y,a2.x);</span><br><span class="line">m[<span class="number">2</span>] = <span class="type">vec3</span>(a3.y*a1.x*a2.x+a1.y*a3.x,a1.x*a3.x-a1.y*a3.y*a2.x,a2.y*a3.y);</span><br><span class="line"><span class="keyword">return</span> m;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">float</span> hash( <span class="type">vec2</span> p ) &#123;</span><br><span class="line"><span class="type">float</span> h = <span class="built_in">dot</span>(p,<span class="type">vec2</span>(<span class="number">127.1</span>,<span class="number">311.7</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">fract</span>(<span class="built_in">sin</span>(h)*<span class="number">43758.5453123</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">float</span> noise( <span class="keyword">in</span> <span class="type">vec2</span> p ) &#123;</span><br><span class="line">    <span class="type">vec2</span> i = <span class="built_in">floor</span>( p );</span><br><span class="line">    <span class="type">vec2</span> f = <span class="built_in">fract</span>( p );</span><br><span class="line">    <span class="comment">// Add distance-based smoothing</span></span><br><span class="line">    <span class="type">float</span> dist = <span class="built_in">length</span>(p);</span><br><span class="line">    <span class="type">float</span> smoothFactor = <span class="built_in">smoothstep</span>(<span class="number">0.0</span>, <span class="number">5.0</span>, dist);</span><br><span class="line">    <span class="type">vec2</span> u = <span class="built_in">mix</span>(f, f*f*(<span class="number">3.0</span><span class="number">-2.0</span>*f), smoothFactor);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1.0</span>+<span class="number">2.0</span>*<span class="built_in">mix</span>( <span class="built_in">mix</span>( hash( i + <span class="type">vec2</span>(<span class="number">0.0</span>,<span class="number">0.0</span>) ), </span><br><span class="line">                     hash( i + <span class="type">vec2</span>(<span class="number">1.0</span>,<span class="number">0.0</span>) ), u.x),</span><br><span class="line">                <span class="built_in">mix</span>( hash( i + <span class="type">vec2</span>(<span class="number">0.0</span>,<span class="number">1.0</span>) ), </span><br><span class="line">                     hash( i + <span class="type">vec2</span>(<span class="number">1.0</span>,<span class="number">1.0</span>) ), u.x), u.y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// lighting</span></span><br><span class="line"><span class="type">float</span> diffuse(<span class="type">vec3</span> n,<span class="type">vec3</span> l,<span class="type">float</span> p) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(<span class="built_in">dot</span>(n,l) * <span class="number">0.4</span> + <span class="number">0.6</span>,p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">float</span> specular(<span class="type">vec3</span> n,<span class="type">vec3</span> l,<span class="type">vec3</span> e,<span class="type">float</span> s) &#123;    </span><br><span class="line">    <span class="type">float</span> nrm = (s + <span class="number">8.0</span>) / (PI * <span class="number">8.0</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(<span class="built_in">max</span>(<span class="built_in">dot</span>(<span class="built_in">reflect</span>(e,n),l),<span class="number">0.0</span>),s) * nrm;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// sky</span></span><br><span class="line"><span class="type">vec3</span> getSkyColor(<span class="type">vec3</span> e) &#123;</span><br><span class="line">    e.y = (<span class="built_in">max</span>(e.y,<span class="number">0.0</span>)*<span class="number">0.8</span>+<span class="number">0.2</span>)*<span class="number">0.8</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">vec3</span>(<span class="built_in">pow</span>(<span class="number">1.0</span>-e.y,<span class="number">2.0</span>), <span class="number">1.0</span>-e.y, <span class="number">0.6</span>+(<span class="number">1.0</span>-e.y)*<span class="number">0.4</span>) * <span class="number">1.1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// sea</span></span><br><span class="line"><span class="type">float</span> sea_octave(<span class="type">vec2</span> uv, <span class="type">float</span> choppy) &#123;</span><br><span class="line">    uv += noise(uv);        </span><br><span class="line">    <span class="type">vec2</span> wv = <span class="number">1.0</span>-<span class="built_in">abs</span>(<span class="built_in">sin</span>(uv));</span><br><span class="line">    <span class="type">vec2</span> swv = <span class="built_in">abs</span>(<span class="built_in">cos</span>(uv));    </span><br><span class="line">    wv = <span class="built_in">mix</span>(wv,swv,wv);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(<span class="number">1.0</span>-<span class="built_in">pow</span>(wv.x * wv.y,<span class="number">0.65</span>),choppy);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> map(<span class="type">vec3</span> p) &#123;</span><br><span class="line">    <span class="type">float</span> freq = SEA_FREQ;</span><br><span class="line">    <span class="type">float</span> amp = SEA_HEIGHT;</span><br><span class="line">    <span class="type">float</span> choppy = SEA_CHOPPY;</span><br><span class="line">    <span class="type">vec2</span> uv = p.xz; uv.x *= <span class="number">0.75</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="type">float</span> d, h = <span class="number">0.0</span>;    </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; ITER_GEOMETRY; i++) &#123;        </span><br><span class="line">    d = sea_octave((uv+SEA_TIME)*freq,choppy);</span><br><span class="line">    d += sea_octave((uv-SEA_TIME)*freq,choppy);</span><br><span class="line">        h += d * amp;        </span><br><span class="line">    uv *= octave_m; freq *= <span class="number">1.9</span>; amp *= <span class="number">0.22</span>;</span><br><span class="line">        choppy = <span class="built_in">mix</span>(choppy,<span class="number">1.0</span>,<span class="number">0.2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p.y - h;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> map_detailed(<span class="type">vec3</span> p) &#123;</span><br><span class="line">    <span class="type">float</span> freq = SEA_FREQ;</span><br><span class="line">    <span class="type">float</span> amp = SEA_HEIGHT;</span><br><span class="line">    <span class="type">float</span> choppy = SEA_CHOPPY;</span><br><span class="line">    <span class="type">vec2</span> uv = p.xz; uv.x *= <span class="number">0.75</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="type">float</span> d, h = <span class="number">0.0</span>;    </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; ITER_FRAGMENT; i++) &#123;        </span><br><span class="line">    d = sea_octave((uv+SEA_TIME)*freq,choppy);</span><br><span class="line">    d += sea_octave((uv-SEA_TIME)*freq,choppy);</span><br><span class="line">        h += d * amp;        </span><br><span class="line">    uv *= octave_m; freq *= <span class="number">1.9</span>; amp *= <span class="number">0.22</span>;</span><br><span class="line">        choppy = <span class="built_in">mix</span>(choppy,<span class="number">1.0</span>,<span class="number">0.2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p.y - h;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">vec3</span> getSeaColor(<span class="type">vec3</span> p, <span class="type">vec3</span> n, <span class="type">vec3</span> l, <span class="type">vec3</span> eye, <span class="type">vec3</span> dist) &#123;  </span><br><span class="line">    <span class="type">float</span> fresnel = <span class="built_in">clamp</span>(<span class="number">1.0</span> - <span class="built_in">dot</span>(n, -eye), <span class="number">0.0</span>, <span class="number">1.0</span>);</span><br><span class="line">    fresnel = <span class="built_in">min</span>(fresnel * fresnel * fresnel, <span class="number">0.5</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="type">vec3</span> reflected = getSkyColor(<span class="built_in">reflect</span>(eye, n));    </span><br><span class="line">    <span class="type">vec3</span> refracted = SEA_BASE + diffuse(n, l, <span class="number">80.0</span>) * SEA_WATER_COLOR * <span class="number">0.12</span>; </span><br><span class="line">    </span><br><span class="line">    <span class="type">vec3</span> color = <span class="built_in">mix</span>(refracted, reflected, fresnel);</span><br><span class="line">    </span><br><span class="line">    <span class="type">float</span> atten = <span class="built_in">max</span>(<span class="number">1.0</span> - <span class="built_in">dot</span>(dist, dist) * <span class="number">0.001</span>, <span class="number">0.0</span>);</span><br><span class="line">    color += SEA_WATER_COLOR * (p.y - SEA_HEIGHT) * <span class="number">0.18</span> * atten;</span><br><span class="line">    </span><br><span class="line">    color += specular(n, l, eye, <span class="number">60.0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> color;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// tracing</span></span><br><span class="line"><span class="type">vec3</span> getNormal(<span class="type">vec3</span> p, <span class="type">float</span> eps) &#123;</span><br><span class="line">        <span class="comment">// Distance-based eps adjustment</span></span><br><span class="line">    <span class="type">float</span> dist = <span class="built_in">length</span>(p);</span><br><span class="line">    eps = <span class="built_in">mix</span>(eps*<span class="number">0.5</span>, eps*<span class="number">2.0</span>, <span class="built_in">smoothstep</span>(<span class="number">0.0</span>, <span class="number">10.0</span>, dist));</span><br><span class="line">    </span><br><span class="line">    <span class="type">vec3</span> n;</span><br><span class="line">    n.y = map_detailed(p);    </span><br><span class="line">    n.x = map_detailed(<span class="type">vec3</span>(p.x+eps,p.y,p.z)) - n.y;</span><br><span class="line">    n.z = map_detailed(<span class="type">vec3</span>(p.x,p.y,p.z+eps)) - n.y;</span><br><span class="line">    n.y = eps;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Smooth normal</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">normalize</span>(<span class="built_in">mix</span>(n, <span class="type">vec3</span>(<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>), <span class="number">0.1</span> * <span class="built_in">smoothstep</span>(<span class="number">0.0</span>, <span class="number">5.0</span>, dist)));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> heightMapTracing(<span class="type">vec3</span> ori, <span class="type">vec3</span> dir, <span class="keyword">out</span> <span class="type">vec3</span> p) &#123;  </span><br><span class="line">    <span class="type">float</span> tm = <span class="number">0.0</span>;</span><br><span class="line">    <span class="type">float</span> tx = <span class="number">1000.0</span>;    </span><br><span class="line">    <span class="type">float</span> hx = map(ori + dir * tx);</span><br><span class="line">    <span class="keyword">if</span>(hx &gt; <span class="number">0.0</span>) &#123;</span><br><span class="line">        p = ori + dir * tx;</span><br><span class="line">        <span class="keyword">return</span> tx;   </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">float</span> hm = map(ori);    </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; NUM_STEPS; i++) &#123;</span><br><span class="line">        <span class="type">float</span> tmid = <span class="built_in">mix</span>(tm, tx, hm / (hm - hx));</span><br><span class="line">        p = ori + dir * tmid;</span><br><span class="line">        <span class="type">float</span> hmid = map(p);        </span><br><span class="line">        <span class="keyword">if</span>(hmid &lt; <span class="number">0.0</span>) &#123;</span><br><span class="line">            tx = tmid;</span><br><span class="line">            hx = hmid;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            tm = tmid;</span><br><span class="line">            hm = hmid;</span><br><span class="line">        &#125;        </span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">abs</span>(hmid) &lt; EPSILON) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">mix</span>(tm, tx, hm / (hm - hx));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">vec3</span> getPixel(<span class="keyword">in</span> <span class="type">vec2</span> coord, <span class="type">float</span> time) &#123;    </span><br><span class="line">    <span class="type">vec2</span> uv = coord / iResolution.xy;</span><br><span class="line">    uv = uv * <span class="number">2.0</span> - <span class="number">1.0</span>;</span><br><span class="line">    uv.x *= iResolution.x / iResolution.y;    </span><br><span class="line">        </span><br><span class="line">    <span class="comment">// ray</span></span><br><span class="line">    <span class="type">vec3</span> ang = <span class="type">vec3</span>(<span class="built_in">sin</span>(time*<span class="number">3.0</span>)*<span class="number">0.1</span>,<span class="built_in">sin</span>(time)*<span class="number">0.2</span>+<span class="number">0.3</span>,time);    </span><br><span class="line">    <span class="type">vec3</span> ori = <span class="type">vec3</span>(<span class="number">0.0</span>,<span class="number">3.5</span>,time*<span class="number">5.0</span>);</span><br><span class="line">    <span class="type">vec3</span> dir = <span class="built_in">normalize</span>(<span class="type">vec3</span>(uv.xy,<span class="number">-2.0</span>)); dir.z += <span class="built_in">length</span>(uv) * <span class="number">0.14</span>;</span><br><span class="line">    dir = <span class="built_in">normalize</span>(dir) * fromEuler(ang);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// tracing</span></span><br><span class="line">    <span class="type">vec3</span> p;</span><br><span class="line">    heightMapTracing(ori,dir,p);</span><br><span class="line">    <span class="type">vec3</span> dist = p - ori;</span><br><span class="line">    <span class="type">vec3</span> n = getNormal(p, <span class="built_in">dot</span>(dist,dist) * EPSILON_NRM);</span><br><span class="line">    <span class="type">vec3</span> light = <span class="built_in">normalize</span>(<span class="type">vec3</span>(<span class="number">0.0</span>,<span class="number">1.0</span>,<span class="number">0.8</span>)); </span><br><span class="line">             </span><br><span class="line">    <span class="comment">// color</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">mix</span>(</span><br><span class="line">        getSkyColor(dir),</span><br><span class="line">        getSeaColor(p,n,light,dir,dist),</span><br><span class="line">    <span class="built_in">pow</span>(<span class="built_in">smoothstep</span>(<span class="number">0.0</span>,<span class="number">-0.02</span>,dir.y),<span class="number">0.2</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// main</span></span><br><span class="line"><span class="type">void</span> mainImage( <span class="keyword">out</span> <span class="type">vec4</span> fragColor, <span class="keyword">in</span> <span class="type">vec2</span> fragCoord ) &#123;</span><br><span class="line">    <span class="type">float</span> time = iTime * <span class="number">0.3</span> + iMouse.x*<span class="number">0.01</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#ifdef AA</span></span><br><span class="line">    <span class="type">vec3</span> color = <span class="type">vec3</span>(<span class="number">0.0</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">-1</span>; i &lt;= <span class="number">1</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">-1</span>; j &lt;= <span class="number">1</span>; j++) &#123;</span><br><span class="line">        <span class="type">vec2</span> uv = fragCoord+<span class="type">vec2</span>(i,j)/<span class="number">3.0</span>;</span><br><span class="line">    color += getPixel(uv, time);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    color /= <span class="number">9.0</span>;</span><br><span class="line"><span class="meta">#else</span></span><br><span class="line">    <span class="type">vec3</span> color = getPixel(fragCoord, time);</span><br><span class="line"><span class="meta">#endif</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// post</span></span><br><span class="line">fragColor = <span class="type">vec4</span>(<span class="built_in">pow</span>(color,<span class="type">vec3</span>(<span class="number">0.65</span>)), <span class="number">1.0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="https://s2.loli.net/2025/09/13/vlTKo196wnDypC2.png" alt="shadertoy100" style="width: 30%;"><h1 id="ShaderToy"><a href="#ShaderToy" class="headerlink" title="ShaderToy"></a>ShaderToy</h1><h2 id="å¸¸ç”¨çš„å…¨å±€å˜é‡"><a href="#å¸¸ç”¨çš„å…¨å±€å˜é‡" class="headerlink" title="å¸¸ç”¨çš„å…¨å±€å˜é‡"></a>å¸¸ç”¨çš„å…¨å±€å˜é‡</h2><img src="https://s2.loli.net/2025/09/13/8dSoxBrp2OcWekl.png" alt="UnrealShaderå­¦ä¹ -2" style="width: 30%;"><h1 id="âš ï¸è­¦å‘Š"><a href="#âš ï¸è­¦å‘Š" class="headerlink" title="* âš ï¸è­¦å‘Š"></a>* âš ï¸è­¦å‘Š</h1><ol><li>å°½å¯èƒ½ä¸è¦åœ¨Shaderä¸­å†™ If é€»è¾‘ä»£ç ï¼Œå› ä¸ºä¸èƒ½<a href="https://juejin.cn/post/7069209226568007688">å……åˆ†å‘æŒ¥SIMDçš„æ€§èƒ½</a></li></ol><h1 id="å…¶ä»–ä¸“æœ‰åè¯è§£é‡Š"><a href="#å…¶ä»–ä¸“æœ‰åè¯è§£é‡Š" class="headerlink" title="* å…¶ä»–ä¸“æœ‰åè¯è§£é‡Š"></a>* å…¶ä»–ä¸“æœ‰åè¯è§£é‡Š</h1><ol><li><strong>é½æ¬¡åæ ‡</strong>ï¼šç”¨ n + 1 ç»´å‘é‡æ¥è¡¨ç¤º n ç»´å‘é‡ã€‚æ¯”å¦‚åœ¨ 2D ä¸­ï¼Œç‚¹ (x, y) ç”¨ (x, y, w) è¡¨ç¤ºï¼Œw é€šå¸¸ä¸º 1ï¼Œè‹¥ w &#x3D; 0 åˆ™è¡¨ç¤ºæ— ç©·è¿œç‚¹ï¼›åœ¨ 3D é‡Œï¼Œç‚¹ (x, y, z) è¡¨ç¤ºä¸º (x, y, z, w) ã€‚å®ƒèƒ½ç®€åŒ–å›¾å½¢å­¦è®¡ç®—ï¼Œè¿˜å¯è¡¨ç¤ºæ— ç©·è¿œç‚¹ ã€‚</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Unreal-Shaderå­¦ä¹ &quot;&gt;&lt;a href=&quot;#Unreal-Shaderå­¦ä¹ &quot; class=&quot;headerlink&quot; title=&quot;Unreal Shaderå­¦ä¹ &quot;&gt;&lt;/a&gt;Unreal Shaderå­¦ä¹ &lt;/h1&gt;&lt;h2 id=&quot;å®‰è£…åŠåŸºç¡€æ¦‚å¿µ&quot;&gt;&lt;a h</summary>
      
    
    
    
    
    <category term="Shader" scheme="http://example.com/tags/Shader/"/>
    
    <category term="GLSL" scheme="http://example.com/tags/GLSL/"/>
    
    <category term="HLSL" scheme="http://example.com/tags/HLSL/"/>
    
    <category term="Unreal Engine" scheme="http://example.com/tags/Unreal-Engine/"/>
    
    <category term="Graphics Programming" scheme="http://example.com/tags/Graphics-Programming/"/>
    
    <category term="Computer Graphics" scheme="http://example.com/tags/Computer-Graphics/"/>
    
    <category term="Game Development Shader 001" scheme="http://example.com/tags/Game-Development-Shader-001/"/>
    
  </entry>
  
</feed>
